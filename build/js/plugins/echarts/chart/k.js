define("echarts/chart/k",["require","./base","../util/shape/Candle","../component/axis","../component/grid","../component/dataZoom","../config","../util/ecData","zrender/tool/util","../chart"],function(e){function t(e,t,n,a,o){i.call(this,e,t,n,a,o),this.refresh(a)}var i=e("./base"),n=e("../util/shape/Candle");e("../component/axis"),e("../component/grid"),e("../component/dataZoom");var a=e("../config");a.k={zlevel:0,z:2,clickable:!0,hoverable:!0,legendHoverLink:!1,xAxisIndex:0,yAxisIndex:0,itemStyle:{normal:{color:"#fff",color0:"#00aa11",lineStyle:{width:1,color:"#ff3200",color0:"#00aa11"}},emphasis:{}}};var o=e("../util/ecData"),s=e("zrender/tool/util");return t.prototype={type:a.CHART_TYPE_K,_buildShape:function(){var e=this.series;this.selectedMap={};for(var t,i={top:[],bottom:[]},n=0,o=e.length;o>n;n++)e[n].type===a.CHART_TYPE_K&&(e[n]=this.reformOption(e[n]),this.legendHoverLink=e[n].legendHoverLink||this.legendHoverLink,t=this.component.xAxis.getAxis(e[n].xAxisIndex),t.type===a.COMPONENT_TYPE_AXIS_CATEGORY&&i[t.getPosition()].push(n));for(var s in i)i[s].length>0&&this._buildSinglePosition(s,i[s]);this.addShapeList()},_buildSinglePosition:function(e,t){var i=this._mapData(t),n=i.locationMap,a=i.maxDataLength;if(0!==a&&0!==n.length){this._buildHorizontal(t,a,n);for(var o=0,s=t.length;s>o;o++)this.buildMark(t[o])}},_mapData:function(e){for(var t,i,n=this.series,a=this.component.legend,o=[],s=0,r=0,l=e.length;l>r;r++)t=n[e[r]],i=t.name,this.selectedMap[i]=a?a.isSelected(i):!0,this.selectedMap[i]&&o.push(e[r]),s=Math.max(s,t.data.length);return{locationMap:o,maxDataLength:s}},_buildHorizontal:function(e,t,i){for(var n,a,o,s,r,l,h,d,m,c,p=this.series,u={},V=0,U=i.length;U>V;V++){n=i[V],a=p[n],o=a.xAxisIndex||0,s=this.component.xAxis.getAxis(o),h=a.barWidth||Math.floor(s.getGap()/2),c=a.barMaxWidth,c&&h>c&&(h=c),r=a.yAxisIndex||0,l=this.component.yAxis.getAxis(r),u[n]=[];for(var g=0,y=t;y>g&&null!=s.getNameByIndex(g);g++)d=a.data[g],m=this.getDataFromOption(d,"-"),"-"!==m&&4==m.length&&u[n].push([s.getCoordByIndex(g),h,l.getCoord(m[0]),l.getCoord(m[1]),l.getCoord(m[2]),l.getCoord(m[3]),g,s.getNameByIndex(g)])}this._buildKLine(e,u)},_buildKLine:function(e,t){for(var i,n,o,s,r,l,h,d,m,c,p,u,V,U,g,y,f,b=this.series,_=0,x=e.length;x>_;_++)if(f=e[_],p=b[f],U=t[f],this._isLarge(U)&&(U=this._getLargePointList(U)),p.type===a.CHART_TYPE_K&&null!=U){u=p,i=this.query(u,"itemStyle.normal.lineStyle.width"),n=this.query(u,"itemStyle.normal.lineStyle.color"),o=this.query(u,"itemStyle.normal.lineStyle.color0"),s=this.query(u,"itemStyle.normal.color"),r=this.query(u,"itemStyle.normal.color0"),l=this.query(u,"itemStyle.emphasis.lineStyle.width"),h=this.query(u,"itemStyle.emphasis.lineStyle.color"),d=this.query(u,"itemStyle.emphasis.lineStyle.color0"),m=this.query(u,"itemStyle.emphasis.color"),c=this.query(u,"itemStyle.emphasis.color0");for(var k=0,L=U.length;L>k;k++)g=U[k],V=p.data[g[6]],u=V,y=g[3]<g[2],this.shapeList.push(this._getCandle(f,g[6],g[7],g[0],g[1],g[2],g[3],g[4],g[5],y?this.query(u,"itemStyle.normal.color")||s:this.query(u,"itemStyle.normal.color0")||r,this.query(u,"itemStyle.normal.lineStyle.width")||i,y?this.query(u,"itemStyle.normal.lineStyle.color")||n:this.query(u,"itemStyle.normal.lineStyle.color0")||o,y?this.query(u,"itemStyle.emphasis.color")||m||s:this.query(u,"itemStyle.emphasis.color0")||c||r,this.query(u,"itemStyle.emphasis.lineStyle.width")||l||i,y?this.query(u,"itemStyle.emphasis.lineStyle.color")||h||n:this.query(u,"itemStyle.emphasis.lineStyle.color0")||d||o))}},_isLarge:function(e){return e[0][1]<.5},_getLargePointList:function(e){for(var t=this.component.grid.getWidth(),i=e.length,n=[],a=0;t>a;a++)n[a]=e[Math.floor(i/t*a)];return n},_getCandle:function(e,t,i,a,s,r,l,h,d,m,c,p,u,V,U){var g=this.series,y={zlevel:this.getZlevelBase(),z:this.getZBase(),clickable:this.deepQuery([g[e].data[t],g[e]],"clickable"),hoverable:this.deepQuery([g[e].data[t],g[e]],"hoverable"),style:{x:a,y:[r,l,h,d],width:s,color:m,strokeColor:p,lineWidth:c,brushType:"both"},highlightStyle:{color:u,strokeColor:U,lineWidth:V},_seriesIndex:e};return o.pack(y,g[e],e,g[e].data[t],t,i),y=new n(y)},getMarkCoord:function(e,t){var i=this.series[e],n=this.component.xAxis.getAxis(i.xAxisIndex),a=this.component.yAxis.getAxis(i.yAxisIndex);return["string"!=typeof t.xAxis&&n.getCoordByIndex?n.getCoordByIndex(t.xAxis||0):n.getCoord(t.xAxis||0),"string"!=typeof t.yAxis&&a.getCoordByIndex?a.getCoordByIndex(t.yAxis||0):a.getCoord(t.yAxis||0)]},refresh:function(e){e&&(this.option=e,this.series=e.series),this.backupShapeList(),this._buildShape()},addDataAnimation:function(e){for(var t=this.series,i={},n=0,a=e.length;a>n;n++)i[e[n][0]]=e[n];for(var s,r,l,h,d,m,n=0,a=this.shapeList.length;a>n;n++)if(d=this.shapeList[n]._seriesIndex,i[d]&&!i[d][3]&&"candle"===this.shapeList[n].type){if(m=o.get(this.shapeList[n],"dataIndex"),h=t[d],i[d][2]&&m===h.data.length-1){this.zr.delShape(this.shapeList[n].id);continue}if(!i[d][2]&&0===m){this.zr.delShape(this.shapeList[n].id);continue}r=this.component.xAxis.getAxis(h.xAxisIndex||0).getGap(),s=i[d][2]?r:-r,l=0,this.zr.animate(this.shapeList[n].id,"").when(this.query(this.option,"animationDurationUpdate"),{position:[s,l]}).start()}}},s.inherits(t,i),e("../chart").define("k",t),t});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiIiwic291cmNlcyI6WyJwbHVnaW5zL2VjaGFydHMvY2hhcnQvay5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJkZWZpbmUoXCJlY2hhcnRzL2NoYXJ0L2tcIixbXCJyZXF1aXJlXCIsXCIuL2Jhc2VcIixcIi4uL3V0aWwvc2hhcGUvQ2FuZGxlXCIsXCIuLi9jb21wb25lbnQvYXhpc1wiLFwiLi4vY29tcG9uZW50L2dyaWRcIixcIi4uL2NvbXBvbmVudC9kYXRhWm9vbVwiLFwiLi4vY29uZmlnXCIsXCIuLi91dGlsL2VjRGF0YVwiLFwienJlbmRlci90b29sL3V0aWxcIixcIi4uL2NoYXJ0XCJdLGZ1bmN0aW9uKGUpe2Z1bmN0aW9uIHQoZSx0LG4sYSxvKXtpLmNhbGwodGhpcyxlLHQsbixhLG8pLHRoaXMucmVmcmVzaChhKX12YXIgaT1lKFwiLi9iYXNlXCIpLG49ZShcIi4uL3V0aWwvc2hhcGUvQ2FuZGxlXCIpO2UoXCIuLi9jb21wb25lbnQvYXhpc1wiKSxlKFwiLi4vY29tcG9uZW50L2dyaWRcIiksZShcIi4uL2NvbXBvbmVudC9kYXRhWm9vbVwiKTt2YXIgYT1lKFwiLi4vY29uZmlnXCIpO2Euaz17emxldmVsOjAsejoyLGNsaWNrYWJsZTohMCxob3ZlcmFibGU6ITAsbGVnZW5kSG92ZXJMaW5rOiExLHhBeGlzSW5kZXg6MCx5QXhpc0luZGV4OjAsaXRlbVN0eWxlOntub3JtYWw6e2NvbG9yOlwiI2ZmZlwiLGNvbG9yMDpcIiMwMGFhMTFcIixsaW5lU3R5bGU6e3dpZHRoOjEsY29sb3I6XCIjZmYzMjAwXCIsY29sb3IwOlwiIzAwYWExMVwifX0sZW1waGFzaXM6e319fTt2YXIgbz1lKFwiLi4vdXRpbC9lY0RhdGFcIikscz1lKFwienJlbmRlci90b29sL3V0aWxcIik7cmV0dXJuIHQucHJvdG90eXBlPXt0eXBlOmEuQ0hBUlRfVFlQRV9LLF9idWlsZFNoYXBlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5zZXJpZXM7dGhpcy5zZWxlY3RlZE1hcD17fTtmb3IodmFyIHQsaT17dG9wOltdLGJvdHRvbTpbXX0sbj0wLG89ZS5sZW5ndGg7bz5uO24rKyllW25dLnR5cGU9PT1hLkNIQVJUX1RZUEVfSyYmKGVbbl09dGhpcy5yZWZvcm1PcHRpb24oZVtuXSksdGhpcy5sZWdlbmRIb3Zlckxpbms9ZVtuXS5sZWdlbmRIb3Zlckxpbmt8fHRoaXMubGVnZW5kSG92ZXJMaW5rLHQ9dGhpcy5jb21wb25lbnQueEF4aXMuZ2V0QXhpcyhlW25dLnhBeGlzSW5kZXgpLHQudHlwZT09PWEuQ09NUE9ORU5UX1RZUEVfQVhJU19DQVRFR09SWSYmaVt0LmdldFBvc2l0aW9uKCldLnB1c2gobikpO2Zvcih2YXIgcyBpbiBpKWlbc10ubGVuZ3RoPjAmJnRoaXMuX2J1aWxkU2luZ2xlUG9zaXRpb24ocyxpW3NdKTt0aGlzLmFkZFNoYXBlTGlzdCgpfSxfYnVpbGRTaW5nbGVQb3NpdGlvbjpmdW5jdGlvbihlLHQpe3ZhciBpPXRoaXMuX21hcERhdGEodCksbj1pLmxvY2F0aW9uTWFwLGE9aS5tYXhEYXRhTGVuZ3RoO2lmKDAhPT1hJiYwIT09bi5sZW5ndGgpe3RoaXMuX2J1aWxkSG9yaXpvbnRhbCh0LGEsbik7Zm9yKHZhciBvPTAscz10Lmxlbmd0aDtzPm87bysrKXRoaXMuYnVpbGRNYXJrKHRbb10pfX0sX21hcERhdGE6ZnVuY3Rpb24oZSl7Zm9yKHZhciB0LGksbj10aGlzLnNlcmllcyxhPXRoaXMuY29tcG9uZW50LmxlZ2VuZCxvPVtdLHM9MCxyPTAsbD1lLmxlbmd0aDtsPnI7cisrKXQ9bltlW3JdXSxpPXQubmFtZSx0aGlzLnNlbGVjdGVkTWFwW2ldPWE/YS5pc1NlbGVjdGVkKGkpOiEwLHRoaXMuc2VsZWN0ZWRNYXBbaV0mJm8ucHVzaChlW3JdKSxzPU1hdGgubWF4KHMsdC5kYXRhLmxlbmd0aCk7cmV0dXJue2xvY2F0aW9uTWFwOm8sbWF4RGF0YUxlbmd0aDpzfX0sX2J1aWxkSG9yaXpvbnRhbDpmdW5jdGlvbihlLHQsaSl7Zm9yKHZhciBuLGEsbyxzLHIsbCxoLGQsbSxjLHA9dGhpcy5zZXJpZXMsdT17fSxWPTAsVT1pLmxlbmd0aDtVPlY7VisrKXtuPWlbVl0sYT1wW25dLG89YS54QXhpc0luZGV4fHwwLHM9dGhpcy5jb21wb25lbnQueEF4aXMuZ2V0QXhpcyhvKSxoPWEuYmFyV2lkdGh8fE1hdGguZmxvb3Iocy5nZXRHYXAoKS8yKSxjPWEuYmFyTWF4V2lkdGgsYyYmaD5jJiYoaD1jKSxyPWEueUF4aXNJbmRleHx8MCxsPXRoaXMuY29tcG9uZW50LnlBeGlzLmdldEF4aXMociksdVtuXT1bXTtmb3IodmFyIGc9MCx5PXQ7eT5nJiZudWxsIT1zLmdldE5hbWVCeUluZGV4KGcpO2crKylkPWEuZGF0YVtnXSxtPXRoaXMuZ2V0RGF0YUZyb21PcHRpb24oZCxcIi1cIiksXCItXCIhPT1tJiY0PT1tLmxlbmd0aCYmdVtuXS5wdXNoKFtzLmdldENvb3JkQnlJbmRleChnKSxoLGwuZ2V0Q29vcmQobVswXSksbC5nZXRDb29yZChtWzFdKSxsLmdldENvb3JkKG1bMl0pLGwuZ2V0Q29vcmQobVszXSksZyxzLmdldE5hbWVCeUluZGV4KGcpXSl9dGhpcy5fYnVpbGRLTGluZShlLHUpfSxfYnVpbGRLTGluZTpmdW5jdGlvbihlLHQpe2Zvcih2YXIgaSxuLG8scyxyLGwsaCxkLG0sYyxwLHUsVixVLGcseSxmLGI9dGhpcy5zZXJpZXMsXz0wLHg9ZS5sZW5ndGg7eD5fO18rKylpZihmPWVbX10scD1iW2ZdLFU9dFtmXSx0aGlzLl9pc0xhcmdlKFUpJiYoVT10aGlzLl9nZXRMYXJnZVBvaW50TGlzdChVKSkscC50eXBlPT09YS5DSEFSVF9UWVBFX0smJm51bGwhPVUpe3U9cCxpPXRoaXMucXVlcnkodSxcIml0ZW1TdHlsZS5ub3JtYWwubGluZVN0eWxlLndpZHRoXCIpLG49dGhpcy5xdWVyeSh1LFwiaXRlbVN0eWxlLm5vcm1hbC5saW5lU3R5bGUuY29sb3JcIiksbz10aGlzLnF1ZXJ5KHUsXCJpdGVtU3R5bGUubm9ybWFsLmxpbmVTdHlsZS5jb2xvcjBcIikscz10aGlzLnF1ZXJ5KHUsXCJpdGVtU3R5bGUubm9ybWFsLmNvbG9yXCIpLHI9dGhpcy5xdWVyeSh1LFwiaXRlbVN0eWxlLm5vcm1hbC5jb2xvcjBcIiksbD10aGlzLnF1ZXJ5KHUsXCJpdGVtU3R5bGUuZW1waGFzaXMubGluZVN0eWxlLndpZHRoXCIpLGg9dGhpcy5xdWVyeSh1LFwiaXRlbVN0eWxlLmVtcGhhc2lzLmxpbmVTdHlsZS5jb2xvclwiKSxkPXRoaXMucXVlcnkodSxcIml0ZW1TdHlsZS5lbXBoYXNpcy5saW5lU3R5bGUuY29sb3IwXCIpLG09dGhpcy5xdWVyeSh1LFwiaXRlbVN0eWxlLmVtcGhhc2lzLmNvbG9yXCIpLGM9dGhpcy5xdWVyeSh1LFwiaXRlbVN0eWxlLmVtcGhhc2lzLmNvbG9yMFwiKTtmb3IodmFyIGs9MCxMPVUubGVuZ3RoO0w+aztrKyspZz1VW2tdLFY9cC5kYXRhW2dbNl1dLHU9Vix5PWdbM108Z1syXSx0aGlzLnNoYXBlTGlzdC5wdXNoKHRoaXMuX2dldENhbmRsZShmLGdbNl0sZ1s3XSxnWzBdLGdbMV0sZ1syXSxnWzNdLGdbNF0sZ1s1XSx5P3RoaXMucXVlcnkodSxcIml0ZW1TdHlsZS5ub3JtYWwuY29sb3JcIil8fHM6dGhpcy5xdWVyeSh1LFwiaXRlbVN0eWxlLm5vcm1hbC5jb2xvcjBcIil8fHIsdGhpcy5xdWVyeSh1LFwiaXRlbVN0eWxlLm5vcm1hbC5saW5lU3R5bGUud2lkdGhcIil8fGkseT90aGlzLnF1ZXJ5KHUsXCJpdGVtU3R5bGUubm9ybWFsLmxpbmVTdHlsZS5jb2xvclwiKXx8bjp0aGlzLnF1ZXJ5KHUsXCJpdGVtU3R5bGUubm9ybWFsLmxpbmVTdHlsZS5jb2xvcjBcIil8fG8seT90aGlzLnF1ZXJ5KHUsXCJpdGVtU3R5bGUuZW1waGFzaXMuY29sb3JcIil8fG18fHM6dGhpcy5xdWVyeSh1LFwiaXRlbVN0eWxlLmVtcGhhc2lzLmNvbG9yMFwiKXx8Y3x8cix0aGlzLnF1ZXJ5KHUsXCJpdGVtU3R5bGUuZW1waGFzaXMubGluZVN0eWxlLndpZHRoXCIpfHxsfHxpLHk/dGhpcy5xdWVyeSh1LFwiaXRlbVN0eWxlLmVtcGhhc2lzLmxpbmVTdHlsZS5jb2xvclwiKXx8aHx8bjp0aGlzLnF1ZXJ5KHUsXCJpdGVtU3R5bGUuZW1waGFzaXMubGluZVN0eWxlLmNvbG9yMFwiKXx8ZHx8bykpfX0sX2lzTGFyZ2U6ZnVuY3Rpb24oZSl7cmV0dXJuIGVbMF1bMV08LjV9LF9nZXRMYXJnZVBvaW50TGlzdDpmdW5jdGlvbihlKXtmb3IodmFyIHQ9dGhpcy5jb21wb25lbnQuZ3JpZC5nZXRXaWR0aCgpLGk9ZS5sZW5ndGgsbj1bXSxhPTA7dD5hO2ErKyluW2FdPWVbTWF0aC5mbG9vcihpL3QqYSldO3JldHVybiBufSxfZ2V0Q2FuZGxlOmZ1bmN0aW9uKGUsdCxpLGEscyxyLGwsaCxkLG0sYyxwLHUsVixVKXt2YXIgZz10aGlzLnNlcmllcyx5PXt6bGV2ZWw6dGhpcy5nZXRabGV2ZWxCYXNlKCksejp0aGlzLmdldFpCYXNlKCksY2xpY2thYmxlOnRoaXMuZGVlcFF1ZXJ5KFtnW2VdLmRhdGFbdF0sZ1tlXV0sXCJjbGlja2FibGVcIiksaG92ZXJhYmxlOnRoaXMuZGVlcFF1ZXJ5KFtnW2VdLmRhdGFbdF0sZ1tlXV0sXCJob3ZlcmFibGVcIiksc3R5bGU6e3g6YSx5OltyLGwsaCxkXSx3aWR0aDpzLGNvbG9yOm0sc3Ryb2tlQ29sb3I6cCxsaW5lV2lkdGg6YyxicnVzaFR5cGU6XCJib3RoXCJ9LGhpZ2hsaWdodFN0eWxlOntjb2xvcjp1LHN0cm9rZUNvbG9yOlUsbGluZVdpZHRoOlZ9LF9zZXJpZXNJbmRleDplfTtyZXR1cm4gby5wYWNrKHksZ1tlXSxlLGdbZV0uZGF0YVt0XSx0LGkpLHk9bmV3IG4oeSl9LGdldE1hcmtDb29yZDpmdW5jdGlvbihlLHQpe3ZhciBpPXRoaXMuc2VyaWVzW2VdLG49dGhpcy5jb21wb25lbnQueEF4aXMuZ2V0QXhpcyhpLnhBeGlzSW5kZXgpLGE9dGhpcy5jb21wb25lbnQueUF4aXMuZ2V0QXhpcyhpLnlBeGlzSW5kZXgpO3JldHVybltcInN0cmluZ1wiIT10eXBlb2YgdC54QXhpcyYmbi5nZXRDb29yZEJ5SW5kZXg/bi5nZXRDb29yZEJ5SW5kZXgodC54QXhpc3x8MCk6bi5nZXRDb29yZCh0LnhBeGlzfHwwKSxcInN0cmluZ1wiIT10eXBlb2YgdC55QXhpcyYmYS5nZXRDb29yZEJ5SW5kZXg/YS5nZXRDb29yZEJ5SW5kZXgodC55QXhpc3x8MCk6YS5nZXRDb29yZCh0LnlBeGlzfHwwKV19LHJlZnJlc2g6ZnVuY3Rpb24oZSl7ZSYmKHRoaXMub3B0aW9uPWUsdGhpcy5zZXJpZXM9ZS5zZXJpZXMpLHRoaXMuYmFja3VwU2hhcGVMaXN0KCksdGhpcy5fYnVpbGRTaGFwZSgpfSxhZGREYXRhQW5pbWF0aW9uOmZ1bmN0aW9uKGUpe2Zvcih2YXIgdD10aGlzLnNlcmllcyxpPXt9LG49MCxhPWUubGVuZ3RoO2E+bjtuKyspaVtlW25dWzBdXT1lW25dO2Zvcih2YXIgcyxyLGwsaCxkLG0sbj0wLGE9dGhpcy5zaGFwZUxpc3QubGVuZ3RoO2E+bjtuKyspaWYoZD10aGlzLnNoYXBlTGlzdFtuXS5fc2VyaWVzSW5kZXgsaVtkXSYmIWlbZF1bM10mJlwiY2FuZGxlXCI9PT10aGlzLnNoYXBlTGlzdFtuXS50eXBlKXtpZihtPW8uZ2V0KHRoaXMuc2hhcGVMaXN0W25dLFwiZGF0YUluZGV4XCIpLGg9dFtkXSxpW2RdWzJdJiZtPT09aC5kYXRhLmxlbmd0aC0xKXt0aGlzLnpyLmRlbFNoYXBlKHRoaXMuc2hhcGVMaXN0W25dLmlkKTtjb250aW51ZX1pZighaVtkXVsyXSYmMD09PW0pe3RoaXMuenIuZGVsU2hhcGUodGhpcy5zaGFwZUxpc3Rbbl0uaWQpO2NvbnRpbnVlfXI9dGhpcy5jb21wb25lbnQueEF4aXMuZ2V0QXhpcyhoLnhBeGlzSW5kZXh8fDApLmdldEdhcCgpLHM9aVtkXVsyXT9yOi1yLGw9MCx0aGlzLnpyLmFuaW1hdGUodGhpcy5zaGFwZUxpc3Rbbl0uaWQsXCJcIikud2hlbih0aGlzLnF1ZXJ5KHRoaXMub3B0aW9uLFwiYW5pbWF0aW9uRHVyYXRpb25VcGRhdGVcIikse3Bvc2l0aW9uOltzLGxdfSkuc3RhcnQoKX19fSxzLmluaGVyaXRzKHQsaSksZShcIi4uL2NoYXJ0XCIpLmRlZmluZShcImtcIix0KSx0fSk7Il0sImZpbGUiOiJwbHVnaW5zL2VjaGFydHMvY2hhcnQvay5qcyJ9
