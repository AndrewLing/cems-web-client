/* WebUploader 0.1.2 */!function(a,b){var c,d={},e=function(a,b){var c,d,e;if("string"==typeof a)return h(a);for(c=[],d=a.length,e=0;d>e;e++)c.push(h(a[e]));return b.apply(null,c)},f=function(a,b,c){2===arguments.length&&(c=b,b=null),e(b||[],function(){g(a,c,arguments)})},g=function(a,b,c){var f,g={exports:b};"function"==typeof b&&(c.length||(c=[e,g.exports,g]),f=b.apply(null,c),void 0!==f&&(g.exports=f)),d[a]=g.exports},h=function(b){var c=d[b]||a[b];if(!c)throw new Error("`"+b+"` is undefined");return c},i=function(a){var b,c,e,f,g,h;h=function(a){return a&&a.charAt(0).toUpperCase()+a.substr(1)};for(b in d)if(c=a,d.hasOwnProperty(b)){for(e=b.split("/"),g=h(e.pop());f=h(e.shift());)c[f]=c[f]||{},c=c[f];c[g]=d[b]}},j=b(a,f,e);i(j),"object"==typeof module&&"object"==typeof module.exports?module.exports=j:"function"==typeof define&&define.amd?define([],j):(c=a.WebUploader,a.WebUploader=j,a.WebUploader.noConflict=function(){a.WebUploader=c})}(this,function(a,b,c){return b("dollar-third",[],function(){return a.jQuery||a.Zepto}),b("dollar",["dollar-third"],function(a){return a}),b("promise-third",["dollar"],function(a){return{Deferred:a.Deferred,when:a.when,isPromise:function(a){return a&&"function"==typeof a.then}}}),b("promise",["promise-third"],function(a){return a}),b("base",["dollar","promise"],function(b,c){function d(a){return function(){return h.apply(a,arguments)}}function e(a,b){return function(){return a.apply(b,arguments)}}function f(a){var b;return Object.create?Object.create(a):(b=function(){},b.prototype=a,new b)}var g=function(){},h=Function.call;return{version:"0.1.2",$:b,Deferred:c.Deferred,isPromise:c.isPromise,when:c.when,browser:function(a){var b={},c=a.match(/WebKit\/([\d.]+)/),d=a.match(/Chrome\/([\d.]+)/)||a.match(/CriOS\/([\d.]+)/),e=a.match(/MSIE\s([\d\.]+)/)||a.match(/(?:trident)(?:.*rv:([\w.]+))?/i),f=a.match(/Firefox\/([\d.]+)/),g=a.match(/Safari\/([\d.]+)/),h=a.match(/OPR\/([\d.]+)/);return c&&(b.webkit=parseFloat(c[1])),d&&(b.chrome=parseFloat(d[1])),e&&(b.ie=parseFloat(e[1])),f&&(b.firefox=parseFloat(f[1])),g&&(b.safari=parseFloat(g[1])),h&&(b.opera=parseFloat(h[1])),b}(navigator.userAgent),os:function(a){var b={},c=a.match(/(?:Android);?[\s\/]+([\d.]+)?/),d=a.match(/(?:iPad|iPod|iPhone).*OS\s([\d_]+)/);return c&&(b.android=parseFloat(c[1])),d&&(b.ios=parseFloat(d[1].replace(/_/g,"."))),b}(navigator.userAgent),inherits:function(a,c,d){var e;return"function"==typeof c?(e=c,c=null):e=c&&c.hasOwnProperty("constructor")?c.constructor:function(){return a.apply(this,arguments)},b.extend(!0,e,a,d||{}),e.__super__=a.prototype,e.prototype=f(a.prototype),c&&b.extend(!0,e.prototype,c),e},noop:g,bindFn:e,log:function(){return a.console?e(console.log,console):g}(),nextTick:function(){return function(a){setTimeout(a,1)}}(),slice:d([].slice),guid:function(){var a=0;return function(b){for(var c=(+new Date).toString(32),d=0;5>d;d++)c+=Math.floor(65535*Math.random()).toString(32);return(b||"wu_")+c+(a++).toString(32)}}(),formatSize:function(a,b,c){var d;for(c=c||["B","K","M","G","TB"];(d=c.shift())&&a>1024;)a/=1024;return("B"===d?a:a.toFixed(b||2))+d}}}),b("mediator",["base"],function(a){function b(a,b,c,d){return f.grep(a,function(a){return!(!a||b&&a.e!==b||c&&a.cb!==c&&a.cb._cb!==c||d&&a.ctx!==d)})}function c(a,b,c){f.each((a||"").split(h),function(a,d){c(d,b)})}function d(a,b){for(var c,d=!1,e=-1,f=a.length;++e<f;)if(c=a[e],c.cb.apply(c.ctx2,b)===!1){d=!0;break}return!d}var e,f=a.$,g=[].slice,h=/\s+/;return e={on:function(a,b,d){var e,f=this;return b?(e=this._events||(this._events=[]),c(a,b,function(a,b){var c={e:a};c.cb=b,c.ctx=d,c.ctx2=d||f,c.id=e.length,e.push(c)}),this):this},once:function(a,b,d){var e=this;return b?(c(a,b,function(a,b){var c=function(){return e.off(a,c),b.apply(d||e,arguments)};c._cb=b,e.on(a,c,d)}),e):e},off:function(a,d,e){var g=this._events;return g?a||d||e?(c(a,d,function(a,c){f.each(b(g,a,c,e),function(){delete g[this.id]})}),this):(this._events=[],this):this},trigger:function(a){var c,e,f;return this._events&&a?(c=g.call(arguments,1),e=b(this._events,a),f=b(this._events,"all"),d(e,c)&&d(f,arguments)):this}},f.extend({installTo:function(a){return f.extend(a,e)}},e)}),b("uploader",["base","mediator"],function(a,b){function c(a){this.options=d.extend(!0,{},c.options,a),this._init(this.options)}var d=a.$;return c.options={},b.installTo(c.prototype),d.each({upload:"start-upload",stop:"stop-upload",getFile:"get-file",getFiles:"get-files",addFile:"add-file",addFiles:"add-file",sort:"sort-files",removeFile:"remove-file",skipFile:"skip-file",retry:"retry",isInProgress:"is-in-progress",makeThumb:"make-thumb",getDimension:"get-dimension",addButton:"add-btn",getRuntimeType:"get-runtime-type",refresh:"refresh",disable:"disable",enable:"enable",reset:"reset"},function(a,b){c.prototype[a]=function(){return this.request(b,arguments)}}),d.extend(c.prototype,{state:"pending",_init:function(a){var b=this;b.request("init",a,function(){b.state="ready",b.trigger("ready")})},option:function(a,b){var c=this.options;return arguments.length>1?void(d.isPlainObject(b)&&d.isPlainObject(c[a])?d.extend(c[a],b):c[a]=b):a?c[a]:c},getStats:function(){var a=this.request("get-stats");return{successNum:a.numOfSuccess,cancelNum:a.numOfCancel,invalidNum:a.numOfInvalid,uploadFailNum:a.numOfUploadFailed,queueNum:a.numOfQueue}},trigger:function(a){var c=[].slice.call(arguments,1),e=this.options,f="on"+a.substring(0,1).toUpperCase()+a.substring(1);return b.trigger.apply(this,arguments)===!1||d.isFunction(e[f])&&e[f].apply(this,c)===!1||d.isFunction(this[f])&&this[f].apply(this,c)===!1||b.trigger.apply(b,[this,a].concat(c))===!1?!1:!0},request:a.noop}),a.create=c.create=function(a){return new c(a)},a.Uploader=c,c}),b("runtime/runtime",["base","mediator"],function(a,b){function c(b){this.options=d.extend({container:document.body},b),this.uid=a.guid("rt_")}var d=a.$,e={},f=function(a){for(var b in a)if(a.hasOwnProperty(b))return b;return null};return d.extend(c.prototype,{getContainer:function(){var a,b,c=this.options;return this._container?this._container:(a=d(c.container||document.body),b=d(document.createElement("div")),b.attr("id","rt_"+this.uid),b.css({position:"absolute",top:"0px",left:"0px",width:"1px",height:"1px",overflow:"hidden"}),a.append(b),a.addClass("webuploader-container"),this._container=b,b)},init:a.noop,exec:a.noop,destroy:function(){this._container&&this._container.parentNode.removeChild(this.__container),this.off()}}),c.orders="html5,flash",c.addRuntime=function(a,b){e[a]=b},c.hasRuntime=function(a){return!!(a?e[a]:f(e))},c.create=function(a,b){var g,h;if(b=b||c.orders,d.each(b.split(/\s*,\s*/g),function(){return e[this]?(g=this,!1):void 0}),g=g||f(e),!g)throw new Error("Runtime Error");return h=new e[g](a)},b.installTo(c.prototype),c}),b("runtime/client",["base","mediator","runtime/runtime"],function(a,b,c){function d(b,d){var f,g=a.Deferred();this.uid=a.guid("client_"),this.runtimeReady=function(a){return g.done(a)},this.connectRuntime=function(b,h){if(f)throw new Error("already connected!");return g.done(h),"string"==typeof b&&e.get(b)&&(f=e.get(b)),f=f||e.get(null,d),f?(a.$.extend(f.options,b),f.__promise.then(g.resolve),f.__client++):(f=c.create(b,b.runtimeOrder),f.__promise=g.promise(),f.once("ready",g.resolve),f.init(),e.add(f),f.__client=1),d&&(f.__standalone=d),f},this.getRuntime=function(){return f},this.disconnectRuntime=function(){f&&(f.__client--,f.__client<=0&&(e.remove(f),delete f.__promise,f.destroy()),f=null)},this.exec=function(){if(f){var c=a.slice(arguments);return b&&c.unshift(b),f.exec.apply(this,c)}},this.getRuid=function(){return f&&f.uid},this.destroy=function(a){return function(){a&&a.apply(this,arguments),this.trigger("destroy"),this.off(),this.exec("destroy"),this.disconnectRuntime()}}(this.destroy)}var e;return e=function(){var a={};return{add:function(b){a[b.uid]=b},get:function(b,c){var d;if(b)return a[b];for(d in a)if(!c||!a[d].__standalone)return a[d];return null},remove:function(b){delete a[b.uid]}}}(),b.installTo(d.prototype),d}),b("lib/dnd",["base","mediator","runtime/client"],function(a,b,c){function d(a){a=this.options=e.extend({},d.options,a),a.container=e(a.container),a.container.length&&c.call(this,"DragAndDrop")}var e=a.$;return d.options={accept:null,disableGlobalDnd:!1},a.inherits(c,{constructor:d,init:function(){var a=this;a.connectRuntime(a.options,function(){a.exec("init"),a.trigger("ready")})},destroy:function(){this.disconnectRuntime()}}),b.installTo(d.prototype),d}),b("widgets/widget",["base","uploader"],function(a,b){function c(a){if(!a)return!1;var b=a.length,c=e.type(a);return 1===a.nodeType&&b?!0:"array"===c||"function"!==c&&"string"!==c&&(0===b||"number"==typeof b&&b>0&&b-1 in a)}function d(a){this.owner=a,this.options=a.options}var e=a.$,f=b.prototype._init,g={},h=[];return e.extend(d.prototype,{init:a.noop,invoke:function(a,b){var c=this.responseMap;return c&&a in c&&c[a]in this&&e.isFunction(this[c[a]])?this[c[a]].apply(this,b):g},request:function(){return this.owner.request.apply(this.owner,arguments)}}),e.extend(b.prototype,{_init:function(){var a=this,b=a._widgets=[];return e.each(h,function(c,d){b.push(new d(a))}),f.apply(a,arguments)},request:function(b,d,e){var f,h,i,j,k=0,l=this._widgets,m=l.length,n=[],o=[];for(d=c(d)?d:[d];m>k;k++)f=l[k],h=f.invoke(b,d),h!==g&&(a.isPromise(h)?o.push(h):n.push(h));return e||o.length?(i=a.when.apply(a,o),j=i.pipe?"pipe":"then",i[j](function(){var b=a.Deferred(),c=arguments;return setTimeout(function(){b.resolve.apply(b,c)},1),b.promise()})[j](e||a.noop)):n[0]}}),b.register=d.register=function(b,c){var f,g={init:"init"};return 1===arguments.length?(c=b,c.responseMap=g):c.responseMap=e.extend(g,b),f=a.inherits(d,c),h.push(f),f},d}),b("widgets/filednd",["base","uploader","lib/dnd","widgets/widget"],function(a,b,c){var d=a.$;return b.options.dnd="",b.register({init:function(b){if(b.dnd&&"html5"===this.request("predict-runtime-type")){var e,f=this,g=a.Deferred(),h=d.extend({},{disableGlobalDnd:b.disableGlobalDnd,container:b.dnd,accept:b.accept});return e=new c(h),e.once("ready",g.resolve),e.on("drop",function(a){f.request("add-file",[a])}),e.on("accept",function(a){return f.owner.trigger("dndAccept",a)}),e.init(),g.promise()}}})}),b("lib/filepaste",["base","mediator","runtime/client"],function(a,b,c){function d(a){a=this.options=e.extend({},a),a.container=e(a.container||document.body),c.call(this,"FilePaste")}var e=a.$;return a.inherits(c,{constructor:d,init:function(){var a=this;a.connectRuntime(a.options,function(){a.exec("init"),a.trigger("ready")})},destroy:function(){this.exec("destroy"),this.disconnectRuntime(),this.off()}}),b.installTo(d.prototype),d}),b("widgets/filepaste",["base","uploader","lib/filepaste","widgets/widget"],function(a,b,c){var d=a.$;return b.register({init:function(b){if(b.paste&&"html5"===this.request("predict-runtime-type")){var e,f=this,g=a.Deferred(),h=d.extend({},{container:b.paste,accept:b.accept});return e=new c(h),e.once("ready",g.resolve),e.on("paste",function(a){f.owner.request("add-file",[a])}),e.init(),g.promise()}}})}),b("lib/blob",["base","runtime/client"],function(a,b){function c(a,c){var d=this;d.source=c,d.ruid=a,b.call(d,"Blob"),this.uid=c.uid||this.uid,this.type=c.type||"",this.size=c.size||0,a&&d.connectRuntime(a)}return a.inherits(b,{constructor:c,slice:function(a,b){return this.exec("slice",a,b)},getSource:function(){return this.source}}),c}),b("lib/file",["base","lib/blob"],function(a,b){function c(a,c){var f;b.apply(this,arguments),this.name=c.name||"untitled"+d++,f=e.exec(c.name)?RegExp.$1.toLowerCase():"",!f&&this.type&&(f=/\/(jpg|jpeg|png|gif|bmp)$/i.exec(this.type)?RegExp.$1.toLowerCase():"",this.name+="."+f),!this.type&&~"jpg,jpeg,png,gif,bmp".indexOf(f)&&(this.type="image/"+("jpg"===f?"jpeg":f)),this.ext=f,this.lastModifiedDate=c.lastModifiedDate||(new Date).toLocaleString()}var d=1,e=/\.([^.]+)$/;return a.inherits(b,c)}),b("lib/filepicker",["base","runtime/client","lib/file"],function(b,c,d){function e(a){if(a=this.options=f.extend({},e.options,a),a.container=f(a.id),!a.container.length)throw new Error("按钮指定错误");a.innerHTML=a.innerHTML||a.label||a.container.html()||"",a.button=f(a.button||document.createElement("div")),a.button.html(a.innerHTML),a.container.html(a.button),c.call(this,"FilePicker",!0)}var f=b.$;return e.options={button:null,container:null,label:null,innerHTML:null,multiple:!0,accept:null,name:"file"},b.inherits(c,{constructor:e,init:function(){var b=this,c=b.options,e=c.button;e.addClass("webuploader-pick"),b.on("all",function(a){var g;switch(a){case"mouseenter":e.addClass("webuploader-pick-hover");break;case"mouseleave":e.removeClass("webuploader-pick-hover");break;case"change":g=b.exec("getFiles"),b.trigger("select",f.map(g,function(a){return a=new d(b.getRuid(),a),a._refer=c.container,a}),c.container)}}),b.connectRuntime(c,function(){b.refresh(),b.exec("init",c),b.trigger("ready")}),f(a).on("resize",function(){b.refresh()})},refresh:function(){var a=this.getRuntime().getContainer(),b=this.options.button,c=b.outerWidth?b.outerWidth():b.width(),d=b.outerHeight?b.outerHeight():b.height(),e=b.offset();c&&d&&a.css({bottom:"auto",right:"auto",width:c+"px",height:d+"px"}).offset(e)},enable:function(){var a=this.options.button;a.removeClass("webuploader-pick-disable"),this.refresh()},disable:function(){var a=this.options.button;this.getRuntime().getContainer().css({top:"-99999px"}),a.addClass("webuploader-pick-disable")},destroy:function(){this.runtime&&(this.exec("destroy"),this.disconnectRuntime())}}),e}),b("widgets/filepicker",["base","uploader","lib/filepicker","widgets/widget"],function(a,b,c){var d=a.$;return d.extend(b.options,{pick:null,accept:null}),b.register({"add-btn":"addButton",refresh:"refresh",disable:"disable",enable:"enable"},{init:function(a){return this.pickers=[],a.pick&&this.addButton(a.pick)},refresh:function(){d.each(this.pickers,function(){this.refresh()})},addButton:function(b){var e,f,g,h=this,i=h.options,j=i.accept;if(b)return g=a.Deferred(),d.isPlainObject(b)||(b={id:b}),e=d.extend({},b,{accept:d.isPlainObject(j)?[j]:j,swf:i.swf,runtimeOrder:i.runtimeOrder}),f=new c(e),f.once("ready",g.resolve),f.on("select",function(a){h.owner.request("add-file",[a])}),f.init(),this.pickers.push(f),g.promise()},disable:function(){d.each(this.pickers,function(){this.disable()})},enable:function(){d.each(this.pickers,function(){this.enable()})}})}),b("lib/image",["base","runtime/client","lib/blob"],function(a,b,c){function d(a){this.options=e.extend({},d.options,a),b.call(this,"Image"),this.on("load",function(){this._info=this.exec("info"),this._meta=this.exec("meta")})}var e=a.$;return d.options={quality:90,crop:!1,preserveHeaders:!0,allowMagnify:!0},a.inherits(b,{constructor:d,info:function(a){return a?(this._info=a,this):this._info},meta:function(a){return a?(this._meta=a,this):this._meta},loadFromBlob:function(a){var b=this,c=a.getRuid();this.connectRuntime(c,function(){b.exec("init",b.options),b.exec("loadFromBlob",a)})},resize:function(){var b=a.slice(arguments);return this.exec.apply(this,["resize"].concat(b))},getAsDataUrl:function(a){return this.exec("getAsDataUrl",a)},getAsBlob:function(a){var b=this.exec("getAsBlob",a);return new c(this.getRuid(),b)}}),d}),b("widgets/image",["base","uploader","lib/image","widgets/widget"],function(a,b,c){var d,e=a.$;return d=function(a){var b=0,c=[],d=function(){for(var d;c.length&&a>b;)d=c.shift(),b+=d[0],d[1]()};return function(a,e,f){c.push([e,f]),a.once("destroy",function(){b-=e,setTimeout(d,1)}),setTimeout(d,1)}}(5242880),e.extend(b.options,{thumb:{width:110,height:110,quality:70,allowMagnify:!0,crop:!0,preserveHeaders:!1,type:"image/jpeg"},compress:{width:1600,height:1600,quality:90,allowMagnify:!1,crop:!1,preserveHeaders:!0}}),b.register({"make-thumb":"makeThumb","before-send-file":"compressImage"},{makeThumb:function(a,b,f,g){var h,i;return a=this.request("get-file",a),a.type.match(/^image/)?(h=e.extend({},this.options.thumb),e.isPlainObject(f)&&(h=e.extend(h,f),f=null),f=f||h.width,g=g||h.height,i=new c(h),i.once("load",function(){a._info=a._info||i.info(),a._meta=a._meta||i.meta(),i.resize(f,g)}),i.once("complete",function(){b(!1,i.getAsDataUrl(h.type)),i.destroy()}),i.once("error",function(){b(!0),i.destroy()}),void d(i,a.source.size,function(){a._info&&i.info(a._info),a._meta&&i.meta(a._meta),i.loadFromBlob(a.source)})):void b(!0)},compressImage:function(b){var d,f,g=this.options.compress||this.options.resize,h=g&&g.compressSize||307200;return b=this.request("get-file",b),!g||!~"image/jpeg,image/jpg".indexOf(b.type)||b.size<h||b._compressed?void 0:(g=e.extend({},g),f=a.Deferred(),d=new c(g),f.always(function(){d.destroy(),d=null}),d.once("error",f.reject),d.once("load",function(){b._info=b._info||d.info(),b._meta=b._meta||d.meta(),d.resize(g.width,g.height)}),d.once("complete",function(){var a,c;try{a=d.getAsBlob(g.type),c=b.size,a.size<c&&(b.source=a,b.size=a.size,b.trigger("resize",a.size,c)),b._compressed=!0,f.resolve()}catch(e){f.resolve()}}),b._info&&d.info(b._info),b._meta&&d.meta(b._meta),d.loadFromBlob(b.source),f.promise())}})}),b("file",["base","mediator"],function(a,b){function c(){return f+g++}function d(a){this.name=a.name||"Untitled",this.size=a.size||0,this.type=a.type||"application",this.lastModifiedDate=a.lastModifiedDate||1*new Date,this.id=c(),this.ext=h.exec(this.name)?RegExp.$1:"",this.statusText="",i[this.id]=d.Status.INITED,this.source=a,this.loaded=0,this.on("error",function(a){this.setStatus(d.Status.ERROR,a)})}var e=a.$,f="WU_FILE_",g=0,h=/\.([^.]+)$/,i={};return e.extend(d.prototype,{setStatus:function(a,b){var c=i[this.id];"undefined"!=typeof b&&(this.statusText=b),a!==c&&(i[this.id]=a,this.trigger("statuschange",a,c))},getStatus:function(){return i[this.id]},getSource:function(){return this.source},destory:function(){delete i[this.id]}}),b.installTo(d.prototype),d.Status={INITED:"inited",QUEUED:"queued",PROGRESS:"progress",ERROR:"error",COMPLETE:"complete",CANCELLED:"cancelled",INTERRUPT:"interrupt",INVALID:"invalid"},d}),b("queue",["base","mediator","file"],function(a,b,c){function d(){this.stats={numOfQueue:0,numOfSuccess:0,numOfCancel:0,numOfProgress:0,numOfUploadFailed:0,numOfInvalid:0},this._queue=[],this._map={}}var e=a.$,f=c.Status;return e.extend(d.prototype,{append:function(a){return this._queue.push(a),this._fileAdded(a),this},prepend:function(a){return this._queue.unshift(a),this._fileAdded(a),this},getFile:function(a){return"string"!=typeof a?a:this._map[a]},fetch:function(a){var b,c,d=this._queue.length;for(a=a||f.QUEUED,b=0;d>b;b++)if(c=this._queue[b],a===c.getStatus())return c;return null},sort:function(a){"function"==typeof a&&this._queue.sort(a)},getFiles:function(){for(var a,b=[].slice.call(arguments,0),c=[],d=0,f=this._queue.length;f>d;d++)a=this._queue[d],(!b.length||~e.inArray(a.getStatus(),b))&&c.push(a);return c},_fileAdded:function(a){var b=this,c=this._map[a.id];c||(this._map[a.id]=a,a.on("statuschange",function(a,c){b._onFileStatusChange(a,c)})),a.setStatus(f.QUEUED)},_onFileStatusChange:function(a,b){var c=this.stats;switch(b){case f.PROGRESS:c.numOfProgress--;break;case f.QUEUED:c.numOfQueue--;break;case f.ERROR:c.numOfUploadFailed--;break;case f.INVALID:c.numOfInvalid--}switch(a){case f.QUEUED:c.numOfQueue++;break;case f.PROGRESS:c.numOfProgress++;break;case f.ERROR:c.numOfUploadFailed++;break;case f.COMPLETE:c.numOfSuccess++;break;case f.CANCELLED:c.numOfCancel++;break;case f.INVALID:c.numOfInvalid++}}}),b.installTo(d.prototype),d}),b("widgets/queue",["base","uploader","queue","file","lib/file","runtime/client","widgets/widget"],function(a,b,c,d,e,f){var g=a.$,h=/\.\w+$/,i=d.Status;return b.register({"sort-files":"sortFiles","add-file":"addFiles","get-file":"getFile","fetch-file":"fetchFile","get-stats":"getStats","get-files":"getFiles","remove-file":"removeFile",retry:"retry",reset:"reset","accept-file":"acceptFile"},{init:function(b){var d,e,h,i,j,k,l,m=this;if(g.isPlainObject(b.accept)&&(b.accept=[b.accept]),b.accept){for(j=[],h=0,e=b.accept.length;e>h;h++)i=b.accept[h].extensions,i&&j.push(i);j.length&&(k="\\."+j.join(",").replace(/,/g,"$|\\.").replace(/\*/g,".*")+"$"),m.accept=new RegExp(k,"i")}return m.queue=new c,m.stats=m.queue.stats,"html5"===this.request("predict-runtime-type")?(d=a.Deferred(),l=new f("Placeholder"),l.connectRuntime({runtimeOrder:"html5"},function(){m._ruid=l.getRuid(),d.resolve()}),d.promise()):void 0},_wrapFile:function(a){if(!(a instanceof d)){if(!(a instanceof e)){if(!this._ruid)throw new Error("Can't add external files.");a=new e(this._ruid,a)}a=new d(a)}return a},acceptFile:function(a){var b=!a||a.size<6||this.accept&&h.exec(a.name)&&!this.accept.test(a.name);return!b},_addFile:function(a){var b=this;return a=b._wrapFile(a),b.owner.trigger("beforeFileQueued",a)?b.acceptFile(a)?(b.queue.append(a),b.owner.trigger("fileQueued",a),a):void b.owner.trigger("error","Q_TYPE_DENIED",a):void 0},getFile:function(a){return this.queue.getFile(a)},addFiles:function(a){var b=this;a.length||(a=[a]),a=g.map(a,function(a){return b._addFile(a)}),b.owner.trigger("filesQueued",a),b.options.auto&&b.request("start-upload")},getStats:function(){return this.stats},removeFile:function(a){var b=this;a=a.id?a:b.queue.getFile(a),a.setStatus(i.CANCELLED),b.owner.trigger("fileDequeued",a)},getFiles:function(){return this.queue.getFiles.apply(this.queue,arguments)},fetchFile:function(){return this.queue.fetch.apply(this.queue,arguments)},retry:function(a,b){var c,d,e,f=this;if(a)return a=a.id?a:f.queue.getFile(a),a.setStatus(i.QUEUED),void(b||f.request("start-upload"));for(c=f.queue.getFiles(i.ERROR),d=0,e=c.length;e>d;d++)a=c[d],a.setStatus(i.QUEUED);f.request("start-upload")},sortFiles:function(){return this.queue.sort.apply(this.queue,arguments)},reset:function(){this.queue=new c,this.stats=this.queue.stats}})}),b("widgets/runtime",["uploader","runtime/runtime","widgets/widget"],function(a,b){return a.support=function(){return b.hasRuntime.apply(b,arguments)},a.register({"predict-runtime-type":"predictRuntmeType"},{init:function(){if(!this.predictRuntmeType())throw Error("Runtime Error")},predictRuntmeType:function(){var a,c,d=this.options.runtimeOrder||b.orders,e=this.type;if(!e)for(d=d.split(/\s*,\s*/g),a=0,c=d.length;c>a;a++)if(b.hasRuntime(d[a])){this.type=e=d[a];break}return e}})}),b("lib/transport",["base","runtime/client","mediator"],function(a,b,c){function d(a){var c=this;a=c.options=e.extend(!0,{},d.options,a||{}),b.call(this,"Transport"),this._blob=null,this._formData=a.formData||{},this._headers=a.headers||{},this.on("progress",this._timeout),this.on("load error",function(){c.trigger("progress",1),clearTimeout(c._timer)})}var e=a.$;return d.options={server:"",method:"POST",withCredentials:!1,fileVal:"file",timeout:12e4,formData:{},headers:{},sendAsBinary:!1},e.extend(d.prototype,{appendBlob:function(a,b,c){var d=this,e=d.options;d.getRuid()&&d.disconnectRuntime(),d.connectRuntime(b.ruid,function(){d.exec("init")}),d._blob=b,e.fileVal=a||e.fileVal,e.filename=c||e.filename},append:function(a,b){"object"==typeof a?e.extend(this._formData,a):this._formData[a]=b},setRequestHeader:function(a,b){"object"==typeof a?e.extend(this._headers,a):this._headers[a]=b},send:function(a){this.exec("send",a),this._timeout()},abort:function(){return clearTimeout(this._timer),this.exec("abort")},destroy:function(){this.trigger("destroy"),this.off(),this.exec("destroy"),this.disconnectRuntime()},getResponse:function(){return this.exec("getResponse")},getResponseAsJson:function(){return this.exec("getResponseAsJson")},getStatus:function(){return this.exec("getStatus")},_timeout:function(){var a=this,b=a.options.timeout;b&&(clearTimeout(a._timer),a._timer=setTimeout(function(){a.abort(),a.trigger("error","timeout")},b))}}),c.installTo(d.prototype),d}),b("widgets/upload",["base","uploader","file","lib/transport","widgets/widget"],function(a,b,c,d){function e(a,b){for(var c,d=[],e=a.source,f=e.size,g=b?Math.ceil(f/b):1,h=0,i=0;g>i;)c=Math.min(b,f-h),d.push({file:a,start:h,end:b?h+c:f,total:f,chunks:g,chunk:i++}),h+=c;return a.blocks=d.concat(),a.remaning=d.length,{file:a,has:function(){return!!d.length},fetch:function(){return d.shift()}}}var f=a.$,g=a.isPromise,h=c.Status;f.extend(b.options,{prepareNextFile:!1,chunked:!1,chunkSize:5242880,chunkRetry:2,threads:3,formData:null}),b.register({"start-upload":"start","stop-upload":"stop","skip-file":"skipFile","is-in-progress":"isInProgress"},{init:function(){var b=this.owner;this.runing=!1,this.pool=[],this.pending=[],this.remaning=0,this.__tick=a.bindFn(this._tick,this),b.on("uploadComplete",function(a){a.blocks&&f.each(a.blocks,function(a,b){b.transport&&(b.transport.abort(),b.transport.destroy()),delete b.transport}),delete a.blocks,delete a.remaning})},start:function(){var b=this;f.each(b.request("get-files",h.INVALID),function(){b.request("remove-file",this)}),b.runing||(b.runing=!0,f.each(b.pool,function(a,c){var d=c.file;d.getStatus()===h.INTERRUPT&&(d.setStatus(h.PROGRESS),b._trigged=!1,c.transport&&c.transport.send())}),b._trigged=!1,b.owner.trigger("startUpload"),a.nextTick(b.__tick))},stop:function(a){var b=this;b.runing!==!1&&(b.runing=!1,a&&f.each(b.pool,function(a,b){b.transport&&b.transport.abort(),b.file.setStatus(h.INTERRUPT)}),b.owner.trigger("stopUpload"))},isInProgress:function(){return!!this.runing},getStats:function(){return this.request("get-stats")},skipFile:function(a,b){a=this.request("get-file",a),a.setStatus(b||h.COMPLETE),a.skipped=!0,a.blocks&&f.each(a.blocks,function(a,b){var c=b.transport;c&&(c.abort(),c.destroy(),delete b.transport)}),this.owner.trigger("uploadSkip",a)},_tick:function(){var b,c,d=this,e=d.options;return d._promise?d._promise.always(d.__tick):void(d.pool.length<e.threads&&(c=d._nextBlock())?(d._trigged=!1,b=function(b){d._promise=null,b&&b.file&&d._startSend(b),a.nextTick(d.__tick)},d._promise=g(c)?c.always(b):b(c)):d.remaning||d.getStats().numOfQueue||(d.runing=!1,d._trigged||a.nextTick(function(){d.owner.trigger("uploadFinished")}),d._trigged=!0))},_nextBlock:function(){var a,b,c=this,d=c._act,f=c.options;return d&&d.has()&&d.file.getStatus()===h.PROGRESS?(f.prepareNextFile&&!c.pending.length&&c._prepareNextFile(),d.fetch()):c.runing?(!c.pending.length&&c.getStats().numOfQueue&&c._prepareNextFile(),a=c.pending.shift(),b=function(a){return a?(d=e(a,f.chunked?f.chunkSize:0),c._act=d,d.fetch()):null},g(a)?a[a.pipe?"pipe":"then"](b):b(a)):void 0},_prepareNextFile:function(){var a,b=this,c=b.request("fetch-file"),d=b.pending;c&&(a=b.request("before-send-file",c,function(){return c.getStatus()===h.QUEUED?(b.owner.trigger("uploadStart",c),c.setStatus(h.PROGRESS),c):b._finishFile(c)}),a.done(function(){var b=f.inArray(a,d);~b&&d.splice(b,1,c)}),a.fail(function(a){c.setStatus(h.ERROR,a),b.owner.trigger("uploadError",c,a),b.owner.trigger("uploadComplete",c)}),d.push(a))},_popBlock:function(a){var b=f.inArray(a,this.pool);this.pool.splice(b,1),a.file.remaning--,this.remaning--},_startSend:function(b){var c,d=this,e=b.file;d.pool.push(b),d.remaning++,b.blob=1===b.chunks?e.source:e.source.slice(b.start,b.end),c=d.request("before-send",b,function(){e.getStatus()===h.PROGRESS?d._doSend(b):(d._popBlock(b),a.nextTick(d.__tick))}),c.fail(function(){1===e.remaning?d._finishFile(e).always(function(){b.percentage=1,d._popBlock(b),d.owner.trigger("uploadComplete",e),a.nextTick(d.__tick)}):(b.percentage=1,d._popBlock(b),a.nextTick(d.__tick))})},_doSend:function(b){var c,e,g=this,i=g.owner,j=g.options,k=b.file,l=new d(j),m=f.extend({},j.formData),n=f.extend({},j.headers);b.transport=l,l.on("destroy",function(){delete b.transport,g._popBlock(b),a.nextTick(g.__tick)}),l.on("progress",function(a){var c=0,d=0;c=b.percentage=a,b.chunks>1&&(f.each(k.blocks,function(a,b){d+=(b.percentage||0)*(b.end-b.start)}),c=d/k.size),i.trigger("uploadProgress",k,c||0)}),c=function(a){var c;return e=l.getResponseAsJson()||{},e._raw=l.getResponse(),c=function(b){a=b},i.trigger("uploadAccept",b,e,c)||(a=a||"server"),a},l.on("error",function(a,d){b.retried=b.retried||0,b.chunks>1&&~"http,abort".indexOf(a)&&b.retried<j.chunkRetry?(b.retried++,l.send()):(d||"server"!==a||(a=c(a)),k.setStatus(h.ERROR,a),i.trigger("uploadError",k,a),i.trigger("uploadComplete",k))}),l.on("load",function(){var a;return(a=c())?void l.trigger("error",a,!0):void(1===k.remaning?g._finishFile(k,e):l.destroy())}),m=f.extend(m,{id:k.id,name:k.name,type:k.type,lastModifiedDate:k.lastModifiedDate,size:k.size}),b.chunks>1&&f.extend(m,{chunks:b.chunks,chunk:b.chunk}),i.trigger("uploadBeforeSend",b,m,n),l.appendBlob(j.fileVal,b.blob,k.name),l.append(m),l.setRequestHeader(n),l.send()},_finishFile:function(a,b,c){var d=this.owner;return d.request("after-send-file",arguments,function(){a.setStatus(h.COMPLETE),d.trigger("uploadSuccess",a,b,c)}).fail(function(b){a.getStatus()===h.PROGRESS&&a.setStatus(h.ERROR,b),d.trigger("uploadError",a,b)}).always(function(){d.trigger("uploadComplete",a)})}})}),b("widgets/validator",["base","uploader","file","widgets/widget"],function(a,b,c){var d,e=a.$,f={};return d={addValidator:function(a,b){f[a]=b},removeValidator:function(a){delete f[a]}},b.register({init:function(){var a=this;e.each(f,function(){this.call(a.owner)})}}),d.addValidator("fileNumLimit",function(){var a=this,b=a.options,c=0,d=b.fileNumLimit>>0,e=!0;d&&(a.on("beforeFileQueued",function(a){return c>=d&&e&&(e=!1,this.trigger("error","Q_EXCEED_NUM_LIMIT",d,a),setTimeout(function(){e=!0},1)),c>=d?!1:!0}),a.on("fileQueued",function(){c++}),a.on("fileDequeued",function(){c--}),a.on("uploadFinished",function(){c=0}))}),d.addValidator("fileSizeLimit",function(){var a=this,b=a.options,c=0,d=b.fileSizeLimit>>0,e=!0;d&&(a.on("beforeFileQueued",function(a){var b=c+a.size>d;return b&&e&&(e=!1,this.trigger("error","Q_EXCEED_SIZE_LIMIT",d,a),setTimeout(function(){e=!0},1)),b?!1:!0}),a.on("fileQueued",function(a){c+=a.size}),a.on("fileDequeued",function(a){c-=a.size}),a.on("uploadFinished",function(){c=0}))}),d.addValidator("fileSingleSizeLimit",function(){var a=this,b=a.options,d=b.fileSingleSizeLimit;d&&a.on("beforeFileQueued",function(a){return a.size>d?(a.setStatus(c.Status.INVALID,"exceed_size"),this.trigger("error","F_EXCEED_SIZE",a),!1):void 0})}),d.addValidator("duplicate",function(){function a(a){for(var b,c=0,d=0,e=a.length;e>d;d++)b=a.charCodeAt(d),c=b+(c<<6)+(c<<16)-c;return c}var b=this,c=b.options,d={};c.duplicate||(b.on("beforeFileQueued",function(b){var c=b.__hash||(b.__hash=a(b.name+b.size+b.lastModifiedDate));return d[c]?(this.trigger("error","F_DUPLICATE",b),!1):void 0}),b.on("fileQueued",function(a){var b=a.__hash;b&&(d[b]=!0)}),b.on("fileDequeued",function(a){var b=a.__hash;b&&delete d[b]}))}),d}),b("runtime/compbase",[],function(){function a(a,b){this.owner=a,this.options=a.options,this.getRuntime=function(){return b},this.getRuid=function(){return b.uid},this.trigger=function(){return a.trigger.apply(a,arguments)}}return a}),b("runtime/html5/runtime",["base","runtime/runtime","runtime/compbase"],function(b,c,d){function e(){var a={},d=this,e=this.destory;c.apply(d,arguments),d.type=f,d.exec=function(c,e){var f,h=this,i=h.uid,j=b.slice(arguments,2);return g[c]&&(f=a[i]=a[i]||new g[c](h,d),f[e])?f[e].apply(f,j):void 0},d.destory=function(){return e&&e.apply(this,arguments)}}var f="html5",g={};return b.inherits(c,{constructor:e,init:function(){var a=this;setTimeout(function(){a.trigger("ready")},1)}}),e.register=function(a,c){var e=g[a]=b.inherits(d,c);return e},a.Blob&&a.FileReader&&a.DataView&&c.addRuntime(f,e),e}),b("runtime/html5/blob",["runtime/html5/runtime","lib/blob"],function(a,b){return a.register("Blob",{slice:function(a,c){var d=this.owner.source,e=d.slice||d.webkitSlice||d.mozSlice;return d=e.call(d,a,c),new b(this.getRuid(),d)}})}),b("runtime/html5/dnd",["base","runtime/html5/runtime","lib/file"],function(a,b,c){var d=a.$,e="webuploader-dnd-";return b.register("DragAndDrop",{init:function(){var b=this.elem=this.options.container;this.dragEnterHandler=a.bindFn(this._dragEnterHandler,this),this.dragOverHandler=a.bindFn(this._dragOverHandler,this),this.dragLeaveHandler=a.bindFn(this._dragLeaveHandler,this),this.dropHandler=a.bindFn(this._dropHandler,this),this.dndOver=!1,b.on("dragenter",this.dragEnterHandler),b.on("dragover",this.dragOverHandler),b.on("dragleave",this.dragLeaveHandler),b.on("drop",this.dropHandler),this.options.disableGlobalDnd&&(d(document).on("dragover",this.dragOverHandler),d(document).on("drop",this.dropHandler))
},_dragEnterHandler:function(a){var b,c=this,d=c._denied||!1;return a=a.originalEvent||a,c.dndOver||(c.dndOver=!0,b=a.dataTransfer.items,b&&b.length&&(c._denied=d=!c.trigger("accept",b)),c.elem.addClass(e+"over"),c.elem[d?"addClass":"removeClass"](e+"denied")),a.dataTransfer.dropEffect=d?"none":"copy",!1},_dragOverHandler:function(a){var b=this.elem.parent().get(0);return b&&!d.contains(b,a.currentTarget)?!1:(clearTimeout(this._leaveTimer),this._dragEnterHandler.call(this,a),!1)},_dragLeaveHandler:function(){var a,b=this;return a=function(){b.dndOver=!1,b.elem.removeClass(e+"over "+e+"denied")},clearTimeout(b._leaveTimer),b._leaveTimer=setTimeout(a,100),!1},_dropHandler:function(a){var b=this,f=b.getRuid(),g=b.elem.parent().get(0);return g&&!d.contains(g,a.currentTarget)?!1:(b._getTansferFiles(a,function(a){b.trigger("drop",d.map(a,function(a){return new c(f,a)}))}),b.dndOver=!1,b.elem.removeClass(e+"over"),!1)},_getTansferFiles:function(b,c){var d,e,f,g,h,i,j,k,l=[],m=[];for(b=b.originalEvent||b,f=b.dataTransfer,d=f.items,e=f.files,k=!(!d||!d[0].webkitGetAsEntry),i=0,j=e.length;j>i;i++)g=e[i],h=d&&d[i],k&&h.webkitGetAsEntry().isDirectory?m.push(this._traverseDirectoryTree(h.webkitGetAsEntry(),l)):l.push(g);a.when.apply(a,m).done(function(){l.length&&c(l)})},_traverseDirectoryTree:function(b,c){var d=a.Deferred(),e=this;return b.isFile?b.file(function(a){c.push(a),d.resolve()}):b.isDirectory&&b.createReader().readEntries(function(b){var f,g=b.length,h=[],i=[];for(f=0;g>f;f++)h.push(e._traverseDirectoryTree(b[f],i));a.when.apply(a,h).then(function(){c.push.apply(c,i),d.resolve()},d.reject)}),d.promise()},destroy:function(){var a=this.elem;a.off("dragenter",this.dragEnterHandler),a.off("dragover",this.dragEnterHandler),a.off("dragleave",this.dragLeaveHandler),a.off("drop",this.dropHandler),this.options.disableGlobalDnd&&(d(document).off("dragover",this.dragOverHandler),d(document).off("drop",this.dropHandler))}})}),b("runtime/html5/filepaste",["base","runtime/html5/runtime","lib/file"],function(a,b,c){return b.register("FilePaste",{init:function(){var b,c,d,e,f=this.options,g=this.elem=f.container,h=".*";if(f.accept){for(b=[],c=0,d=f.accept.length;d>c;c++)e=f.accept[c].mimeTypes,e&&b.push(e);b.length&&(h=b.join(","),h=h.replace(/,/g,"|").replace(/\*/g,".*"))}this.accept=h=new RegExp(h,"i"),this.hander=a.bindFn(this._pasteHander,this),g.on("paste",this.hander)},_pasteHander:function(a){var b,d,e,f,g,h=[],i=this.getRuid();for(a=a.originalEvent||a,b=a.clipboardData.items,f=0,g=b.length;g>f;f++)d=b[f],"file"===d.kind&&(e=d.getAsFile())&&h.push(new c(i,e));h.length&&(a.preventDefault(),a.stopPropagation(),this.trigger("paste",h))},destroy:function(){this.elem.off("paste",this.hander)}})}),b("runtime/html5/filepicker",["base","runtime/html5/runtime"],function(a,b){var c=a.$;return b.register("FilePicker",{init:function(){var a,b,d,e,f=this.getRuntime().getContainer(),g=this,h=g.owner,i=g.options,j=c(document.createElement("label")),k=c(document.createElement("input"));if(k.attr("type","file"),k.attr("name",i.name),k.addClass("webuploader-element-invisible"),j.on("click",function(){k.trigger("click")}),j.css({opacity:0,width:"100%",height:"100%",display:"block",cursor:"pointer",background:"#ffffff"}),i.multiple&&k.attr("multiple","multiple"),i.accept&&i.accept.length>0){for(a=[],b=0,d=i.accept.length;d>b;b++)a.push(i.accept[b].mimeTypes);k.attr("accept",a.join(","))}f.append(k),f.append(j),e=function(a){h.trigger(a.type)},k.on("change",function(a){var b,d=arguments.callee;g.files=a.target.files,b=this.cloneNode(!0),this.parentNode.replaceChild(b,this),k.off(),k=c(b).on("change",d).on("mouseenter mouseleave",e),h.trigger("change")}),j.on("mouseenter mouseleave",e)},getFiles:function(){return this.files},destroy:function(){}})}),b("runtime/html5/util",["base"],function(b){var c=a.createObjectURL&&a||a.URL&&URL.revokeObjectURL&&URL||a.webkitURL,d=b.noop,e=d;return c&&(d=function(){return c.createObjectURL.apply(c,arguments)},e=function(){return c.revokeObjectURL.apply(c,arguments)}),{createObjectURL:d,revokeObjectURL:e,dataURL2Blob:function(a){var b,c,d,e,f,g;for(g=a.split(","),b=~g[0].indexOf("base64")?atob(g[1]):decodeURIComponent(g[1]),d=new ArrayBuffer(b.length),c=new Uint8Array(d),e=0;e<b.length;e++)c[e]=b.charCodeAt(e);return f=g[0].split(":")[1].split(";")[0],this.arrayBufferToBlob(d,f)},dataURL2ArrayBuffer:function(a){var b,c,d,e;for(e=a.split(","),b=~e[0].indexOf("base64")?atob(e[1]):decodeURIComponent(e[1]),c=new Uint8Array(b.length),d=0;d<b.length;d++)c[d]=b.charCodeAt(d);return c.buffer},arrayBufferToBlob:function(b,c){var d,e=a.BlobBuilder||a.WebKitBlobBuilder;return e?(d=new e,d.append(b),d.getBlob(c)):new Blob([b],c?{type:c}:{})},canvasToDataUrl:function(a,b,c){return a.toDataURL(b,c/100)},parseMeta:function(a,b){b(!1,{})},updateImageHead:function(a){return a}}}),b("runtime/html5/imagemeta",["runtime/html5/util"],function(a){var b;return b={parsers:{65505:[]},maxMetaDataSize:262144,parse:function(a,b){var c=this,d=new FileReader;d.onload=function(){b(!1,c._parse(this.result)),d=d.onload=d.onerror=null},d.onerror=function(a){b(a.message),d=d.onload=d.onerror=null},a=a.slice(0,c.maxMetaDataSize),d.readAsArrayBuffer(a.getSource())},_parse:function(a,c){if(!(a.byteLength<6)){var d,e,f,g,h=new DataView(a),i=2,j=h.byteLength-4,k=i,l={};if(65496===h.getUint16(0)){for(;j>i&&(d=h.getUint16(i),d>=65504&&65519>=d||65534===d)&&(e=h.getUint16(i+2)+2,!(i+e>h.byteLength));){if(f=b.parsers[d],!c&&f)for(g=0;g<f.length;g+=1)f[g].call(b,h,i,e,l);i+=e,k=i}k>6&&(l.imageHead=a.slice?a.slice(2,k):new Uint8Array(a).subarray(2,k))}return l}},updateImageHead:function(a,b){var c,d,e,f=this._parse(a,!0);return e=2,f.imageHead&&(e=2+f.imageHead.byteLength),d=a.slice?a.slice(e):new Uint8Array(a).subarray(e),c=new Uint8Array(b.byteLength+2+d.byteLength),c[0]=255,c[1]=216,c.set(new Uint8Array(b),2),c.set(new Uint8Array(d),b.byteLength+2),c.buffer}},a.parseMeta=function(){return b.parse.apply(b,arguments)},a.updateImageHead=function(){return b.updateImageHead.apply(b,arguments)},b}),b("runtime/html5/imagemeta/exif",["base","runtime/html5/imagemeta"],function(a,b){var c={};return c.ExifMap=function(){return this},c.ExifMap.prototype.map={Orientation:274},c.ExifMap.prototype.get=function(a){return this[a]||this[this.map[a]]},c.exifTagTypes={1:{getValue:function(a,b){return a.getUint8(b)},size:1},2:{getValue:function(a,b){return String.fromCharCode(a.getUint8(b))},size:1,ascii:!0},3:{getValue:function(a,b,c){return a.getUint16(b,c)},size:2},4:{getValue:function(a,b,c){return a.getUint32(b,c)},size:4},5:{getValue:function(a,b,c){return a.getUint32(b,c)/a.getUint32(b+4,c)},size:8},9:{getValue:function(a,b,c){return a.getInt32(b,c)},size:4},10:{getValue:function(a,b,c){return a.getInt32(b,c)/a.getInt32(b+4,c)},size:8}},c.exifTagTypes[7]=c.exifTagTypes[1],c.getExifValue=function(b,d,e,f,g,h){var i,j,k,l,m,n,o=c.exifTagTypes[f];if(!o)return void a.log("Invalid Exif data: Invalid tag type.");if(i=o.size*g,j=i>4?d+b.getUint32(e+8,h):e+8,j+i>b.byteLength)return void a.log("Invalid Exif data: Invalid data offset.");if(1===g)return o.getValue(b,j,h);for(k=[],l=0;g>l;l+=1)k[l]=o.getValue(b,j+l*o.size,h);if(o.ascii){for(m="",l=0;l<k.length&&(n=k[l],"\x00"!==n);l+=1)m+=n;return m}return k},c.parseExifTag=function(a,b,d,e,f){var g=a.getUint16(d,e);f.exif[g]=c.getExifValue(a,b,d,a.getUint16(d+2,e),a.getUint32(d+4,e),e)},c.parseExifTags=function(b,c,d,e,f){var g,h,i;if(d+6>b.byteLength)return void a.log("Invalid Exif data: Invalid directory offset.");if(g=b.getUint16(d,e),h=d+2+12*g,h+4>b.byteLength)return void a.log("Invalid Exif data: Invalid directory size.");for(i=0;g>i;i+=1)this.parseExifTag(b,c,d+2+12*i,e,f);return b.getUint32(h,e)},c.parseExifData=function(b,d,e,f){var g,h,i=d+10;if(1165519206===b.getUint32(d+4)){if(i+8>b.byteLength)return void a.log("Invalid Exif data: Invalid segment size.");if(0!==b.getUint16(d+8))return void a.log("Invalid Exif data: Missing byte alignment offset.");switch(b.getUint16(i)){case 18761:g=!0;break;case 19789:g=!1;break;default:return void a.log("Invalid Exif data: Invalid byte alignment marker.")}if(42!==b.getUint16(i+2,g))return void a.log("Invalid Exif data: Missing TIFF marker.");h=b.getUint32(i+4,g),f.exif=new c.ExifMap,h=c.parseExifTags(b,i,i+h,g,f)}},b.parsers[65505].push(c.parseExifData),c}),b("runtime/html5/image",["base","runtime/html5/runtime","runtime/html5/util"],function(a,b,c){var d="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs%3D";return b.register("Image",{modified:!1,init:function(){var a=this,b=new Image;b.onload=function(){a._info={type:a.type,width:this.width,height:this.height},a._metas||"image/jpeg"!==a.type?a.owner.trigger("load"):c.parseMeta(a._blob,function(b,c){a._metas=c,a.owner.trigger("load")})},b.onerror=function(){a.owner.trigger("error")},a._img=b},loadFromBlob:function(a){var b=this,d=b._img;b._blob=a,b.type=a.type,d.src=c.createObjectURL(a.getSource()),b.owner.once("load",function(){c.revokeObjectURL(d.src)})},resize:function(a,b){var c=this._canvas||(this._canvas=document.createElement("canvas"));this._resize(this._img,c,a,b),this._blob=null,this.modified=!0,this.owner.trigger("complete")},getAsBlob:function(a){var b,d=this._blob,e=this.options;if(a=a||this.type,this.modified||this.type!==a){if(b=this._canvas,"image/jpeg"===a){if(d=c.canvasToDataUrl(b,"image/jpeg",e.quality),e.preserveHeaders&&this._metas&&this._metas.imageHead)return d=c.dataURL2ArrayBuffer(d),d=c.updateImageHead(d,this._metas.imageHead),d=c.arrayBufferToBlob(d,a)}else d=c.canvasToDataUrl(b,a);d=c.dataURL2Blob(d)}return d},getAsDataUrl:function(a){var b=this.options;return a=a||this.type,"image/jpeg"===a?c.canvasToDataUrl(this._canvas,a,b.quality):this._canvas.toDataURL(a)},getOrientation:function(){return this._metas&&this._metas.exif&&this._metas.exif.get("Orientation")||1},info:function(a){return a?(this._info=a,this):this._info},meta:function(a){return a?(this._meta=a,this):this._meta},destroy:function(){var a=this._canvas;this._img.onload=null,a&&(a.getContext("2d").clearRect(0,0,a.width,a.height),a.width=a.height=0,this._canvas=null),this._img.src=d,this._img=this._blob=null},_resize:function(a,b,c,d){var e,f,g,h,i,j=this.options,k=a.width,l=a.height,m=this.getOrientation();~[5,6,7,8].indexOf(m)&&(c^=d,d^=c,c^=d),e=Math[j.crop?"max":"min"](c/k,d/l),j.allowMagnify||(e=Math.min(1,e)),f=k*e,g=l*e,j.crop?(b.width=c,b.height=d):(b.width=f,b.height=g),h=(b.width-f)/2,i=(b.height-g)/2,j.preserveHeaders||this._rotate2Orientaion(b,m),this._renderImageToCanvas(b,a,h,i,f,g)},_rotate2Orientaion:function(a,b){var c=a.width,d=a.height,e=a.getContext("2d");switch(b){case 5:case 6:case 7:case 8:a.width=d,a.height=c}switch(b){case 2:e.translate(c,0),e.scale(-1,1);break;case 3:e.translate(c,d),e.rotate(Math.PI);break;case 4:e.translate(0,d),e.scale(1,-1);break;case 5:e.rotate(.5*Math.PI),e.scale(1,-1);break;case 6:e.rotate(.5*Math.PI),e.translate(0,-d);break;case 7:e.rotate(.5*Math.PI),e.translate(c,-d),e.scale(-1,1);break;case 8:e.rotate(-.5*Math.PI),e.translate(-c,0)}},_renderImageToCanvas:function(){function b(a,b,c){var d,e,f,g=document.createElement("canvas"),h=g.getContext("2d"),i=0,j=c,k=c;for(g.width=1,g.height=c,h.drawImage(a,0,0),d=h.getImageData(0,0,1,c).data;k>i;)e=d[4*(k-1)+3],0===e?j=k:i=k,k=j+i>>1;return f=k/c,0===f?1:f}function c(a){var b,c,d=a.naturalWidth,e=a.naturalHeight;return d*e>1048576?(b=document.createElement("canvas"),b.width=b.height=1,c=b.getContext("2d"),c.drawImage(a,-d+1,0),0===c.getImageData(0,0,1,1).data[3]):!1}return a.os.ios?a.os.ios>=7?function(a,c,d,e,f,g){var h=c.naturalWidth,i=c.naturalHeight,j=b(c,h,i);return a.getContext("2d").drawImage(c,0,0,h*j,i*j,d,e,f,g)}:function(a,d,e,f,g,h){var i,j,k,l,m,n,o,p=d.naturalWidth,q=d.naturalHeight,r=a.getContext("2d"),s=c(d),t="image/jpeg"===this.type,u=1024,v=0,w=0;for(s&&(p/=2,q/=2),r.save(),i=document.createElement("canvas"),i.width=i.height=u,j=i.getContext("2d"),k=t?b(d,p,q):1,l=Math.ceil(u*g/p),m=Math.ceil(u*h/q/k);q>v;){for(n=0,o=0;p>n;)j.clearRect(0,0,u,u),j.drawImage(d,-n,-v),r.drawImage(i,0,0,u,u,e+o,f+w,l,m),n+=u,o+=l;v+=u,w+=m}r.restore(),i=j=null}:function(a,b,c,d,e,f){a.getContext("2d").drawImage(b,c,d,e,f)}}()})}),b("runtime/html5/transport",["base","runtime/html5/runtime"],function(a,b){var c=a.noop,d=a.$;return b.register("Transport",{init:function(){this._status=0,this._response=null},send:function(){var b,c,e,f=this.owner,g=this.options,h=this._initAjax(),i=f._blob,j=g.server;g.sendAsBinary?(j+=(/\?/.test(j)?"&":"?")+d.param(f._formData),c=i.getSource()):(b=new FormData,d.each(f._formData,function(a,c){b.append(a,c)}),b.append(g.fileVal,i.getSource(),g.filename||f._formData.name||"")),g.withCredentials&&"withCredentials"in h?(h.open(g.method,j,!0),h.withCredentials=!0):h.open(g.method,j),this._setRequestHeader(h,g.headers),c?(h.overrideMimeType("application/octet-stream"),a.os.android?(e=new FileReader,e.onload=function(){h.send(this.result),e=e.onload=null},e.readAsArrayBuffer(c)):h.send(c)):h.send(b)},getResponse:function(){return this._response},getResponseAsJson:function(){return this._parseJson(this._response)},getStatus:function(){return this._status},abort:function(){var a=this._xhr;a&&(a.upload.onprogress=c,a.onreadystatechange=c,a.abort(),this._xhr=a=null)},destroy:function(){this.abort()},_initAjax:function(){var a=this,b=new XMLHttpRequest,d=this.options;return!d.withCredentials||"withCredentials"in b||"undefined"==typeof XDomainRequest||(b=new XDomainRequest),b.upload.onprogress=function(b){var c=0;return b.lengthComputable&&(c=b.loaded/b.total),a.trigger("progress",c)},b.onreadystatechange=function(){return 4===b.readyState?(b.upload.onprogress=c,b.onreadystatechange=c,a._xhr=null,a._status=b.status,b.status>=200&&b.status<300?(a._response=b.responseText,a.trigger("load")):b.status>=500&&b.status<600?(a._response=b.responseText,a.trigger("error","server")):a.trigger("error",a._status?"http":"abort")):void 0},a._xhr=b,b},_setRequestHeader:function(a,b){d.each(b,function(b,c){a.setRequestHeader(b,c)})},_parseJson:function(a){var b;try{b=JSON.parse(a)}catch(c){b={}}return b}})}),b("preset/html5only",["base","widgets/filednd","widgets/filepaste","widgets/filepicker","widgets/image","widgets/queue","widgets/runtime","widgets/upload","widgets/validator","runtime/html5/blob","runtime/html5/dnd","runtime/html5/filepaste","runtime/html5/filepicker","runtime/html5/imagemeta/exif","runtime/html5/image","runtime/html5/transport"],function(a){return a}),b("webuploader",["preset/html5only"],function(a){return a}),c("webuploader")});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiIiwic291cmNlcyI6WyJwbHVnaW5zL3VlZGl0b3IvdGhpcmQtcGFydHkvd2VidXBsb2FkZXIvd2VidXBsb2FkZXIuaHRtbDVvbmx5Lm1pbi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKiBXZWJVcGxvYWRlciAwLjEuMiAqLyFmdW5jdGlvbihhLGIpe3ZhciBjLGQ9e30sZT1mdW5jdGlvbihhLGIpe3ZhciBjLGQsZTtpZihcInN0cmluZ1wiPT10eXBlb2YgYSlyZXR1cm4gaChhKTtmb3IoYz1bXSxkPWEubGVuZ3RoLGU9MDtkPmU7ZSsrKWMucHVzaChoKGFbZV0pKTtyZXR1cm4gYi5hcHBseShudWxsLGMpfSxmPWZ1bmN0aW9uKGEsYixjKXsyPT09YXJndW1lbnRzLmxlbmd0aCYmKGM9YixiPW51bGwpLGUoYnx8W10sZnVuY3Rpb24oKXtnKGEsYyxhcmd1bWVudHMpfSl9LGc9ZnVuY3Rpb24oYSxiLGMpe3ZhciBmLGc9e2V4cG9ydHM6Yn07XCJmdW5jdGlvblwiPT10eXBlb2YgYiYmKGMubGVuZ3RofHwoYz1bZSxnLmV4cG9ydHMsZ10pLGY9Yi5hcHBseShudWxsLGMpLHZvaWQgMCE9PWYmJihnLmV4cG9ydHM9ZikpLGRbYV09Zy5leHBvcnRzfSxoPWZ1bmN0aW9uKGIpe3ZhciBjPWRbYl18fGFbYl07aWYoIWMpdGhyb3cgbmV3IEVycm9yKFwiYFwiK2IrXCJgIGlzIHVuZGVmaW5lZFwiKTtyZXR1cm4gY30saT1mdW5jdGlvbihhKXt2YXIgYixjLGUsZixnLGg7aD1mdW5jdGlvbihhKXtyZXR1cm4gYSYmYS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSthLnN1YnN0cigxKX07Zm9yKGIgaW4gZClpZihjPWEsZC5oYXNPd25Qcm9wZXJ0eShiKSl7Zm9yKGU9Yi5zcGxpdChcIi9cIiksZz1oKGUucG9wKCkpO2Y9aChlLnNoaWZ0KCkpOyljW2ZdPWNbZl18fHt9LGM9Y1tmXTtjW2ddPWRbYl19fSxqPWIoYSxmLGUpO2koaiksXCJvYmplY3RcIj09dHlwZW9mIG1vZHVsZSYmXCJvYmplY3RcIj09dHlwZW9mIG1vZHVsZS5leHBvcnRzP21vZHVsZS5leHBvcnRzPWo6XCJmdW5jdGlvblwiPT10eXBlb2YgZGVmaW5lJiZkZWZpbmUuYW1kP2RlZmluZShbXSxqKTooYz1hLldlYlVwbG9hZGVyLGEuV2ViVXBsb2FkZXI9aixhLldlYlVwbG9hZGVyLm5vQ29uZmxpY3Q9ZnVuY3Rpb24oKXthLldlYlVwbG9hZGVyPWN9KX0odGhpcyxmdW5jdGlvbihhLGIsYyl7cmV0dXJuIGIoXCJkb2xsYXItdGhpcmRcIixbXSxmdW5jdGlvbigpe3JldHVybiBhLmpRdWVyeXx8YS5aZXB0b30pLGIoXCJkb2xsYXJcIixbXCJkb2xsYXItdGhpcmRcIl0sZnVuY3Rpb24oYSl7cmV0dXJuIGF9KSxiKFwicHJvbWlzZS10aGlyZFwiLFtcImRvbGxhclwiXSxmdW5jdGlvbihhKXtyZXR1cm57RGVmZXJyZWQ6YS5EZWZlcnJlZCx3aGVuOmEud2hlbixpc1Byb21pc2U6ZnVuY3Rpb24oYSl7cmV0dXJuIGEmJlwiZnVuY3Rpb25cIj09dHlwZW9mIGEudGhlbn19fSksYihcInByb21pc2VcIixbXCJwcm9taXNlLXRoaXJkXCJdLGZ1bmN0aW9uKGEpe3JldHVybiBhfSksYihcImJhc2VcIixbXCJkb2xsYXJcIixcInByb21pc2VcIl0sZnVuY3Rpb24oYixjKXtmdW5jdGlvbiBkKGEpe3JldHVybiBmdW5jdGlvbigpe3JldHVybiBoLmFwcGx5KGEsYXJndW1lbnRzKX19ZnVuY3Rpb24gZShhLGIpe3JldHVybiBmdW5jdGlvbigpe3JldHVybiBhLmFwcGx5KGIsYXJndW1lbnRzKX19ZnVuY3Rpb24gZihhKXt2YXIgYjtyZXR1cm4gT2JqZWN0LmNyZWF0ZT9PYmplY3QuY3JlYXRlKGEpOihiPWZ1bmN0aW9uKCl7fSxiLnByb3RvdHlwZT1hLG5ldyBiKX12YXIgZz1mdW5jdGlvbigpe30saD1GdW5jdGlvbi5jYWxsO3JldHVybnt2ZXJzaW9uOlwiMC4xLjJcIiwkOmIsRGVmZXJyZWQ6Yy5EZWZlcnJlZCxpc1Byb21pc2U6Yy5pc1Byb21pc2Usd2hlbjpjLndoZW4sYnJvd3NlcjpmdW5jdGlvbihhKXt2YXIgYj17fSxjPWEubWF0Y2goL1dlYktpdFxcLyhbXFxkLl0rKS8pLGQ9YS5tYXRjaCgvQ2hyb21lXFwvKFtcXGQuXSspLyl8fGEubWF0Y2goL0NyaU9TXFwvKFtcXGQuXSspLyksZT1hLm1hdGNoKC9NU0lFXFxzKFtcXGRcXC5dKykvKXx8YS5tYXRjaCgvKD86dHJpZGVudCkoPzouKnJ2OihbXFx3Ll0rKSk/L2kpLGY9YS5tYXRjaCgvRmlyZWZveFxcLyhbXFxkLl0rKS8pLGc9YS5tYXRjaCgvU2FmYXJpXFwvKFtcXGQuXSspLyksaD1hLm1hdGNoKC9PUFJcXC8oW1xcZC5dKykvKTtyZXR1cm4gYyYmKGIud2Via2l0PXBhcnNlRmxvYXQoY1sxXSkpLGQmJihiLmNocm9tZT1wYXJzZUZsb2F0KGRbMV0pKSxlJiYoYi5pZT1wYXJzZUZsb2F0KGVbMV0pKSxmJiYoYi5maXJlZm94PXBhcnNlRmxvYXQoZlsxXSkpLGcmJihiLnNhZmFyaT1wYXJzZUZsb2F0KGdbMV0pKSxoJiYoYi5vcGVyYT1wYXJzZUZsb2F0KGhbMV0pKSxifShuYXZpZ2F0b3IudXNlckFnZW50KSxvczpmdW5jdGlvbihhKXt2YXIgYj17fSxjPWEubWF0Y2goLyg/OkFuZHJvaWQpOz9bXFxzXFwvXSsoW1xcZC5dKyk/LyksZD1hLm1hdGNoKC8oPzppUGFkfGlQb2R8aVBob25lKS4qT1NcXHMoW1xcZF9dKykvKTtyZXR1cm4gYyYmKGIuYW5kcm9pZD1wYXJzZUZsb2F0KGNbMV0pKSxkJiYoYi5pb3M9cGFyc2VGbG9hdChkWzFdLnJlcGxhY2UoL18vZyxcIi5cIikpKSxifShuYXZpZ2F0b3IudXNlckFnZW50KSxpbmhlcml0czpmdW5jdGlvbihhLGMsZCl7dmFyIGU7cmV0dXJuXCJmdW5jdGlvblwiPT10eXBlb2YgYz8oZT1jLGM9bnVsbCk6ZT1jJiZjLmhhc093blByb3BlcnR5KFwiY29uc3RydWN0b3JcIik/Yy5jb25zdHJ1Y3RvcjpmdW5jdGlvbigpe3JldHVybiBhLmFwcGx5KHRoaXMsYXJndW1lbnRzKX0sYi5leHRlbmQoITAsZSxhLGR8fHt9KSxlLl9fc3VwZXJfXz1hLnByb3RvdHlwZSxlLnByb3RvdHlwZT1mKGEucHJvdG90eXBlKSxjJiZiLmV4dGVuZCghMCxlLnByb3RvdHlwZSxjKSxlfSxub29wOmcsYmluZEZuOmUsbG9nOmZ1bmN0aW9uKCl7cmV0dXJuIGEuY29uc29sZT9lKGNvbnNvbGUubG9nLGNvbnNvbGUpOmd9KCksbmV4dFRpY2s6ZnVuY3Rpb24oKXtyZXR1cm4gZnVuY3Rpb24oYSl7c2V0VGltZW91dChhLDEpfX0oKSxzbGljZTpkKFtdLnNsaWNlKSxndWlkOmZ1bmN0aW9uKCl7dmFyIGE9MDtyZXR1cm4gZnVuY3Rpb24oYil7Zm9yKHZhciBjPSgrbmV3IERhdGUpLnRvU3RyaW5nKDMyKSxkPTA7NT5kO2QrKyljKz1NYXRoLmZsb29yKDY1NTM1Kk1hdGgucmFuZG9tKCkpLnRvU3RyaW5nKDMyKTtyZXR1cm4oYnx8XCJ3dV9cIikrYysoYSsrKS50b1N0cmluZygzMil9fSgpLGZvcm1hdFNpemU6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkO2ZvcihjPWN8fFtcIkJcIixcIktcIixcIk1cIixcIkdcIixcIlRCXCJdOyhkPWMuc2hpZnQoKSkmJmE+MTAyNDspYS89MTAyNDtyZXR1cm4oXCJCXCI9PT1kP2E6YS50b0ZpeGVkKGJ8fDIpKStkfX19KSxiKFwibWVkaWF0b3JcIixbXCJiYXNlXCJdLGZ1bmN0aW9uKGEpe2Z1bmN0aW9uIGIoYSxiLGMsZCl7cmV0dXJuIGYuZ3JlcChhLGZ1bmN0aW9uKGEpe3JldHVybiEoIWF8fGImJmEuZSE9PWJ8fGMmJmEuY2IhPT1jJiZhLmNiLl9jYiE9PWN8fGQmJmEuY3R4IT09ZCl9KX1mdW5jdGlvbiBjKGEsYixjKXtmLmVhY2goKGF8fFwiXCIpLnNwbGl0KGgpLGZ1bmN0aW9uKGEsZCl7YyhkLGIpfSl9ZnVuY3Rpb24gZChhLGIpe2Zvcih2YXIgYyxkPSExLGU9LTEsZj1hLmxlbmd0aDsrK2U8ZjspaWYoYz1hW2VdLGMuY2IuYXBwbHkoYy5jdHgyLGIpPT09ITEpe2Q9ITA7YnJlYWt9cmV0dXJuIWR9dmFyIGUsZj1hLiQsZz1bXS5zbGljZSxoPS9cXHMrLztyZXR1cm4gZT17b246ZnVuY3Rpb24oYSxiLGQpe3ZhciBlLGY9dGhpcztyZXR1cm4gYj8oZT10aGlzLl9ldmVudHN8fCh0aGlzLl9ldmVudHM9W10pLGMoYSxiLGZ1bmN0aW9uKGEsYil7dmFyIGM9e2U6YX07Yy5jYj1iLGMuY3R4PWQsYy5jdHgyPWR8fGYsYy5pZD1lLmxlbmd0aCxlLnB1c2goYyl9KSx0aGlzKTp0aGlzfSxvbmNlOmZ1bmN0aW9uKGEsYixkKXt2YXIgZT10aGlzO3JldHVybiBiPyhjKGEsYixmdW5jdGlvbihhLGIpe3ZhciBjPWZ1bmN0aW9uKCl7cmV0dXJuIGUub2ZmKGEsYyksYi5hcHBseShkfHxlLGFyZ3VtZW50cyl9O2MuX2NiPWIsZS5vbihhLGMsZCl9KSxlKTplfSxvZmY6ZnVuY3Rpb24oYSxkLGUpe3ZhciBnPXRoaXMuX2V2ZW50cztyZXR1cm4gZz9hfHxkfHxlPyhjKGEsZCxmdW5jdGlvbihhLGMpe2YuZWFjaChiKGcsYSxjLGUpLGZ1bmN0aW9uKCl7ZGVsZXRlIGdbdGhpcy5pZF19KX0pLHRoaXMpOih0aGlzLl9ldmVudHM9W10sdGhpcyk6dGhpc30sdHJpZ2dlcjpmdW5jdGlvbihhKXt2YXIgYyxlLGY7cmV0dXJuIHRoaXMuX2V2ZW50cyYmYT8oYz1nLmNhbGwoYXJndW1lbnRzLDEpLGU9Yih0aGlzLl9ldmVudHMsYSksZj1iKHRoaXMuX2V2ZW50cyxcImFsbFwiKSxkKGUsYykmJmQoZixhcmd1bWVudHMpKTp0aGlzfX0sZi5leHRlbmQoe2luc3RhbGxUbzpmdW5jdGlvbihhKXtyZXR1cm4gZi5leHRlbmQoYSxlKX19LGUpfSksYihcInVwbG9hZGVyXCIsW1wiYmFzZVwiLFwibWVkaWF0b3JcIl0sZnVuY3Rpb24oYSxiKXtmdW5jdGlvbiBjKGEpe3RoaXMub3B0aW9ucz1kLmV4dGVuZCghMCx7fSxjLm9wdGlvbnMsYSksdGhpcy5faW5pdCh0aGlzLm9wdGlvbnMpfXZhciBkPWEuJDtyZXR1cm4gYy5vcHRpb25zPXt9LGIuaW5zdGFsbFRvKGMucHJvdG90eXBlKSxkLmVhY2goe3VwbG9hZDpcInN0YXJ0LXVwbG9hZFwiLHN0b3A6XCJzdG9wLXVwbG9hZFwiLGdldEZpbGU6XCJnZXQtZmlsZVwiLGdldEZpbGVzOlwiZ2V0LWZpbGVzXCIsYWRkRmlsZTpcImFkZC1maWxlXCIsYWRkRmlsZXM6XCJhZGQtZmlsZVwiLHNvcnQ6XCJzb3J0LWZpbGVzXCIscmVtb3ZlRmlsZTpcInJlbW92ZS1maWxlXCIsc2tpcEZpbGU6XCJza2lwLWZpbGVcIixyZXRyeTpcInJldHJ5XCIsaXNJblByb2dyZXNzOlwiaXMtaW4tcHJvZ3Jlc3NcIixtYWtlVGh1bWI6XCJtYWtlLXRodW1iXCIsZ2V0RGltZW5zaW9uOlwiZ2V0LWRpbWVuc2lvblwiLGFkZEJ1dHRvbjpcImFkZC1idG5cIixnZXRSdW50aW1lVHlwZTpcImdldC1ydW50aW1lLXR5cGVcIixyZWZyZXNoOlwicmVmcmVzaFwiLGRpc2FibGU6XCJkaXNhYmxlXCIsZW5hYmxlOlwiZW5hYmxlXCIscmVzZXQ6XCJyZXNldFwifSxmdW5jdGlvbihhLGIpe2MucHJvdG90eXBlW2FdPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucmVxdWVzdChiLGFyZ3VtZW50cyl9fSksZC5leHRlbmQoYy5wcm90b3R5cGUse3N0YXRlOlwicGVuZGluZ1wiLF9pbml0OmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXM7Yi5yZXF1ZXN0KFwiaW5pdFwiLGEsZnVuY3Rpb24oKXtiLnN0YXRlPVwicmVhZHlcIixiLnRyaWdnZXIoXCJyZWFkeVwiKX0pfSxvcHRpb246ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLm9wdGlvbnM7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGg+MT92b2lkKGQuaXNQbGFpbk9iamVjdChiKSYmZC5pc1BsYWluT2JqZWN0KGNbYV0pP2QuZXh0ZW5kKGNbYV0sYik6Y1thXT1iKTphP2NbYV06Y30sZ2V0U3RhdHM6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLnJlcXVlc3QoXCJnZXQtc3RhdHNcIik7cmV0dXJue3N1Y2Nlc3NOdW06YS5udW1PZlN1Y2Nlc3MsY2FuY2VsTnVtOmEubnVtT2ZDYW5jZWwsaW52YWxpZE51bTphLm51bU9mSW52YWxpZCx1cGxvYWRGYWlsTnVtOmEubnVtT2ZVcGxvYWRGYWlsZWQscXVldWVOdW06YS5udW1PZlF1ZXVlfX0sdHJpZ2dlcjpmdW5jdGlvbihhKXt2YXIgYz1bXS5zbGljZS5jYWxsKGFyZ3VtZW50cywxKSxlPXRoaXMub3B0aW9ucyxmPVwib25cIithLnN1YnN0cmluZygwLDEpLnRvVXBwZXJDYXNlKCkrYS5zdWJzdHJpbmcoMSk7cmV0dXJuIGIudHJpZ2dlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk9PT0hMXx8ZC5pc0Z1bmN0aW9uKGVbZl0pJiZlW2ZdLmFwcGx5KHRoaXMsYyk9PT0hMXx8ZC5pc0Z1bmN0aW9uKHRoaXNbZl0pJiZ0aGlzW2ZdLmFwcGx5KHRoaXMsYyk9PT0hMXx8Yi50cmlnZ2VyLmFwcGx5KGIsW3RoaXMsYV0uY29uY2F0KGMpKT09PSExPyExOiEwfSxyZXF1ZXN0OmEubm9vcH0pLGEuY3JlYXRlPWMuY3JlYXRlPWZ1bmN0aW9uKGEpe3JldHVybiBuZXcgYyhhKX0sYS5VcGxvYWRlcj1jLGN9KSxiKFwicnVudGltZS9ydW50aW1lXCIsW1wiYmFzZVwiLFwibWVkaWF0b3JcIl0sZnVuY3Rpb24oYSxiKXtmdW5jdGlvbiBjKGIpe3RoaXMub3B0aW9ucz1kLmV4dGVuZCh7Y29udGFpbmVyOmRvY3VtZW50LmJvZHl9LGIpLHRoaXMudWlkPWEuZ3VpZChcInJ0X1wiKX12YXIgZD1hLiQsZT17fSxmPWZ1bmN0aW9uKGEpe2Zvcih2YXIgYiBpbiBhKWlmKGEuaGFzT3duUHJvcGVydHkoYikpcmV0dXJuIGI7cmV0dXJuIG51bGx9O3JldHVybiBkLmV4dGVuZChjLnByb3RvdHlwZSx7Z2V0Q29udGFpbmVyOmZ1bmN0aW9uKCl7dmFyIGEsYixjPXRoaXMub3B0aW9ucztyZXR1cm4gdGhpcy5fY29udGFpbmVyP3RoaXMuX2NvbnRhaW5lcjooYT1kKGMuY29udGFpbmVyfHxkb2N1bWVudC5ib2R5KSxiPWQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKSksYi5hdHRyKFwiaWRcIixcInJ0X1wiK3RoaXMudWlkKSxiLmNzcyh7cG9zaXRpb246XCJhYnNvbHV0ZVwiLHRvcDpcIjBweFwiLGxlZnQ6XCIwcHhcIix3aWR0aDpcIjFweFwiLGhlaWdodDpcIjFweFwiLG92ZXJmbG93OlwiaGlkZGVuXCJ9KSxhLmFwcGVuZChiKSxhLmFkZENsYXNzKFwid2VidXBsb2FkZXItY29udGFpbmVyXCIpLHRoaXMuX2NvbnRhaW5lcj1iLGIpfSxpbml0OmEubm9vcCxleGVjOmEubm9vcCxkZXN0cm95OmZ1bmN0aW9uKCl7dGhpcy5fY29udGFpbmVyJiZ0aGlzLl9jb250YWluZXIucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLl9fY29udGFpbmVyKSx0aGlzLm9mZigpfX0pLGMub3JkZXJzPVwiaHRtbDUsZmxhc2hcIixjLmFkZFJ1bnRpbWU9ZnVuY3Rpb24oYSxiKXtlW2FdPWJ9LGMuaGFzUnVudGltZT1mdW5jdGlvbihhKXtyZXR1cm4hIShhP2VbYV06ZihlKSl9LGMuY3JlYXRlPWZ1bmN0aW9uKGEsYil7dmFyIGcsaDtpZihiPWJ8fGMub3JkZXJzLGQuZWFjaChiLnNwbGl0KC9cXHMqLFxccyovZyksZnVuY3Rpb24oKXtyZXR1cm4gZVt0aGlzXT8oZz10aGlzLCExKTp2b2lkIDB9KSxnPWd8fGYoZSksIWcpdGhyb3cgbmV3IEVycm9yKFwiUnVudGltZSBFcnJvclwiKTtyZXR1cm4gaD1uZXcgZVtnXShhKX0sYi5pbnN0YWxsVG8oYy5wcm90b3R5cGUpLGN9KSxiKFwicnVudGltZS9jbGllbnRcIixbXCJiYXNlXCIsXCJtZWRpYXRvclwiLFwicnVudGltZS9ydW50aW1lXCJdLGZ1bmN0aW9uKGEsYixjKXtmdW5jdGlvbiBkKGIsZCl7dmFyIGYsZz1hLkRlZmVycmVkKCk7dGhpcy51aWQ9YS5ndWlkKFwiY2xpZW50X1wiKSx0aGlzLnJ1bnRpbWVSZWFkeT1mdW5jdGlvbihhKXtyZXR1cm4gZy5kb25lKGEpfSx0aGlzLmNvbm5lY3RSdW50aW1lPWZ1bmN0aW9uKGIsaCl7aWYoZil0aHJvdyBuZXcgRXJyb3IoXCJhbHJlYWR5IGNvbm5lY3RlZCFcIik7cmV0dXJuIGcuZG9uZShoKSxcInN0cmluZ1wiPT10eXBlb2YgYiYmZS5nZXQoYikmJihmPWUuZ2V0KGIpKSxmPWZ8fGUuZ2V0KG51bGwsZCksZj8oYS4kLmV4dGVuZChmLm9wdGlvbnMsYiksZi5fX3Byb21pc2UudGhlbihnLnJlc29sdmUpLGYuX19jbGllbnQrKyk6KGY9Yy5jcmVhdGUoYixiLnJ1bnRpbWVPcmRlciksZi5fX3Byb21pc2U9Zy5wcm9taXNlKCksZi5vbmNlKFwicmVhZHlcIixnLnJlc29sdmUpLGYuaW5pdCgpLGUuYWRkKGYpLGYuX19jbGllbnQ9MSksZCYmKGYuX19zdGFuZGFsb25lPWQpLGZ9LHRoaXMuZ2V0UnVudGltZT1mdW5jdGlvbigpe3JldHVybiBmfSx0aGlzLmRpc2Nvbm5lY3RSdW50aW1lPWZ1bmN0aW9uKCl7ZiYmKGYuX19jbGllbnQtLSxmLl9fY2xpZW50PD0wJiYoZS5yZW1vdmUoZiksZGVsZXRlIGYuX19wcm9taXNlLGYuZGVzdHJveSgpKSxmPW51bGwpfSx0aGlzLmV4ZWM9ZnVuY3Rpb24oKXtpZihmKXt2YXIgYz1hLnNsaWNlKGFyZ3VtZW50cyk7cmV0dXJuIGImJmMudW5zaGlmdChiKSxmLmV4ZWMuYXBwbHkodGhpcyxjKX19LHRoaXMuZ2V0UnVpZD1mdW5jdGlvbigpe3JldHVybiBmJiZmLnVpZH0sdGhpcy5kZXN0cm95PWZ1bmN0aW9uKGEpe3JldHVybiBmdW5jdGlvbigpe2EmJmEuYXBwbHkodGhpcyxhcmd1bWVudHMpLHRoaXMudHJpZ2dlcihcImRlc3Ryb3lcIiksdGhpcy5vZmYoKSx0aGlzLmV4ZWMoXCJkZXN0cm95XCIpLHRoaXMuZGlzY29ubmVjdFJ1bnRpbWUoKX19KHRoaXMuZGVzdHJveSl9dmFyIGU7cmV0dXJuIGU9ZnVuY3Rpb24oKXt2YXIgYT17fTtyZXR1cm57YWRkOmZ1bmN0aW9uKGIpe2FbYi51aWRdPWJ9LGdldDpmdW5jdGlvbihiLGMpe3ZhciBkO2lmKGIpcmV0dXJuIGFbYl07Zm9yKGQgaW4gYSlpZighY3x8IWFbZF0uX19zdGFuZGFsb25lKXJldHVybiBhW2RdO3JldHVybiBudWxsfSxyZW1vdmU6ZnVuY3Rpb24oYil7ZGVsZXRlIGFbYi51aWRdfX19KCksYi5pbnN0YWxsVG8oZC5wcm90b3R5cGUpLGR9KSxiKFwibGliL2RuZFwiLFtcImJhc2VcIixcIm1lZGlhdG9yXCIsXCJydW50aW1lL2NsaWVudFwiXSxmdW5jdGlvbihhLGIsYyl7ZnVuY3Rpb24gZChhKXthPXRoaXMub3B0aW9ucz1lLmV4dGVuZCh7fSxkLm9wdGlvbnMsYSksYS5jb250YWluZXI9ZShhLmNvbnRhaW5lciksYS5jb250YWluZXIubGVuZ3RoJiZjLmNhbGwodGhpcyxcIkRyYWdBbmREcm9wXCIpfXZhciBlPWEuJDtyZXR1cm4gZC5vcHRpb25zPXthY2NlcHQ6bnVsbCxkaXNhYmxlR2xvYmFsRG5kOiExfSxhLmluaGVyaXRzKGMse2NvbnN0cnVjdG9yOmQsaW5pdDpmdW5jdGlvbigpe3ZhciBhPXRoaXM7YS5jb25uZWN0UnVudGltZShhLm9wdGlvbnMsZnVuY3Rpb24oKXthLmV4ZWMoXCJpbml0XCIpLGEudHJpZ2dlcihcInJlYWR5XCIpfSl9LGRlc3Ryb3k6ZnVuY3Rpb24oKXt0aGlzLmRpc2Nvbm5lY3RSdW50aW1lKCl9fSksYi5pbnN0YWxsVG8oZC5wcm90b3R5cGUpLGR9KSxiKFwid2lkZ2V0cy93aWRnZXRcIixbXCJiYXNlXCIsXCJ1cGxvYWRlclwiXSxmdW5jdGlvbihhLGIpe2Z1bmN0aW9uIGMoYSl7aWYoIWEpcmV0dXJuITE7dmFyIGI9YS5sZW5ndGgsYz1lLnR5cGUoYSk7cmV0dXJuIDE9PT1hLm5vZGVUeXBlJiZiPyEwOlwiYXJyYXlcIj09PWN8fFwiZnVuY3Rpb25cIiE9PWMmJlwic3RyaW5nXCIhPT1jJiYoMD09PWJ8fFwibnVtYmVyXCI9PXR5cGVvZiBiJiZiPjAmJmItMSBpbiBhKX1mdW5jdGlvbiBkKGEpe3RoaXMub3duZXI9YSx0aGlzLm9wdGlvbnM9YS5vcHRpb25zfXZhciBlPWEuJCxmPWIucHJvdG90eXBlLl9pbml0LGc9e30saD1bXTtyZXR1cm4gZS5leHRlbmQoZC5wcm90b3R5cGUse2luaXQ6YS5ub29wLGludm9rZTpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMucmVzcG9uc2VNYXA7cmV0dXJuIGMmJmEgaW4gYyYmY1thXWluIHRoaXMmJmUuaXNGdW5jdGlvbih0aGlzW2NbYV1dKT90aGlzW2NbYV1dLmFwcGx5KHRoaXMsYik6Z30scmVxdWVzdDpmdW5jdGlvbigpe3JldHVybiB0aGlzLm93bmVyLnJlcXVlc3QuYXBwbHkodGhpcy5vd25lcixhcmd1bWVudHMpfX0pLGUuZXh0ZW5kKGIucHJvdG90eXBlLHtfaW5pdDpmdW5jdGlvbigpe3ZhciBhPXRoaXMsYj1hLl93aWRnZXRzPVtdO3JldHVybiBlLmVhY2goaCxmdW5jdGlvbihjLGQpe2IucHVzaChuZXcgZChhKSl9KSxmLmFwcGx5KGEsYXJndW1lbnRzKX0scmVxdWVzdDpmdW5jdGlvbihiLGQsZSl7dmFyIGYsaCxpLGosaz0wLGw9dGhpcy5fd2lkZ2V0cyxtPWwubGVuZ3RoLG49W10sbz1bXTtmb3IoZD1jKGQpP2Q6W2RdO20+aztrKyspZj1sW2tdLGg9Zi5pbnZva2UoYixkKSxoIT09ZyYmKGEuaXNQcm9taXNlKGgpP28ucHVzaChoKTpuLnB1c2goaCkpO3JldHVybiBlfHxvLmxlbmd0aD8oaT1hLndoZW4uYXBwbHkoYSxvKSxqPWkucGlwZT9cInBpcGVcIjpcInRoZW5cIixpW2pdKGZ1bmN0aW9uKCl7dmFyIGI9YS5EZWZlcnJlZCgpLGM9YXJndW1lbnRzO3JldHVybiBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7Yi5yZXNvbHZlLmFwcGx5KGIsYyl9LDEpLGIucHJvbWlzZSgpfSlbal0oZXx8YS5ub29wKSk6blswXX19KSxiLnJlZ2lzdGVyPWQucmVnaXN0ZXI9ZnVuY3Rpb24oYixjKXt2YXIgZixnPXtpbml0OlwiaW5pdFwifTtyZXR1cm4gMT09PWFyZ3VtZW50cy5sZW5ndGg/KGM9YixjLnJlc3BvbnNlTWFwPWcpOmMucmVzcG9uc2VNYXA9ZS5leHRlbmQoZyxiKSxmPWEuaW5oZXJpdHMoZCxjKSxoLnB1c2goZiksZn0sZH0pLGIoXCJ3aWRnZXRzL2ZpbGVkbmRcIixbXCJiYXNlXCIsXCJ1cGxvYWRlclwiLFwibGliL2RuZFwiLFwid2lkZ2V0cy93aWRnZXRcIl0sZnVuY3Rpb24oYSxiLGMpe3ZhciBkPWEuJDtyZXR1cm4gYi5vcHRpb25zLmRuZD1cIlwiLGIucmVnaXN0ZXIoe2luaXQ6ZnVuY3Rpb24oYil7aWYoYi5kbmQmJlwiaHRtbDVcIj09PXRoaXMucmVxdWVzdChcInByZWRpY3QtcnVudGltZS10eXBlXCIpKXt2YXIgZSxmPXRoaXMsZz1hLkRlZmVycmVkKCksaD1kLmV4dGVuZCh7fSx7ZGlzYWJsZUdsb2JhbERuZDpiLmRpc2FibGVHbG9iYWxEbmQsY29udGFpbmVyOmIuZG5kLGFjY2VwdDpiLmFjY2VwdH0pO3JldHVybiBlPW5ldyBjKGgpLGUub25jZShcInJlYWR5XCIsZy5yZXNvbHZlKSxlLm9uKFwiZHJvcFwiLGZ1bmN0aW9uKGEpe2YucmVxdWVzdChcImFkZC1maWxlXCIsW2FdKX0pLGUub24oXCJhY2NlcHRcIixmdW5jdGlvbihhKXtyZXR1cm4gZi5vd25lci50cmlnZ2VyKFwiZG5kQWNjZXB0XCIsYSl9KSxlLmluaXQoKSxnLnByb21pc2UoKX19fSl9KSxiKFwibGliL2ZpbGVwYXN0ZVwiLFtcImJhc2VcIixcIm1lZGlhdG9yXCIsXCJydW50aW1lL2NsaWVudFwiXSxmdW5jdGlvbihhLGIsYyl7ZnVuY3Rpb24gZChhKXthPXRoaXMub3B0aW9ucz1lLmV4dGVuZCh7fSxhKSxhLmNvbnRhaW5lcj1lKGEuY29udGFpbmVyfHxkb2N1bWVudC5ib2R5KSxjLmNhbGwodGhpcyxcIkZpbGVQYXN0ZVwiKX12YXIgZT1hLiQ7cmV0dXJuIGEuaW5oZXJpdHMoYyx7Y29uc3RydWN0b3I6ZCxpbml0OmZ1bmN0aW9uKCl7dmFyIGE9dGhpczthLmNvbm5lY3RSdW50aW1lKGEub3B0aW9ucyxmdW5jdGlvbigpe2EuZXhlYyhcImluaXRcIiksYS50cmlnZ2VyKFwicmVhZHlcIil9KX0sZGVzdHJveTpmdW5jdGlvbigpe3RoaXMuZXhlYyhcImRlc3Ryb3lcIiksdGhpcy5kaXNjb25uZWN0UnVudGltZSgpLHRoaXMub2ZmKCl9fSksYi5pbnN0YWxsVG8oZC5wcm90b3R5cGUpLGR9KSxiKFwid2lkZ2V0cy9maWxlcGFzdGVcIixbXCJiYXNlXCIsXCJ1cGxvYWRlclwiLFwibGliL2ZpbGVwYXN0ZVwiLFwid2lkZ2V0cy93aWRnZXRcIl0sZnVuY3Rpb24oYSxiLGMpe3ZhciBkPWEuJDtyZXR1cm4gYi5yZWdpc3Rlcih7aW5pdDpmdW5jdGlvbihiKXtpZihiLnBhc3RlJiZcImh0bWw1XCI9PT10aGlzLnJlcXVlc3QoXCJwcmVkaWN0LXJ1bnRpbWUtdHlwZVwiKSl7dmFyIGUsZj10aGlzLGc9YS5EZWZlcnJlZCgpLGg9ZC5leHRlbmQoe30se2NvbnRhaW5lcjpiLnBhc3RlLGFjY2VwdDpiLmFjY2VwdH0pO3JldHVybiBlPW5ldyBjKGgpLGUub25jZShcInJlYWR5XCIsZy5yZXNvbHZlKSxlLm9uKFwicGFzdGVcIixmdW5jdGlvbihhKXtmLm93bmVyLnJlcXVlc3QoXCJhZGQtZmlsZVwiLFthXSl9KSxlLmluaXQoKSxnLnByb21pc2UoKX19fSl9KSxiKFwibGliL2Jsb2JcIixbXCJiYXNlXCIsXCJydW50aW1lL2NsaWVudFwiXSxmdW5jdGlvbihhLGIpe2Z1bmN0aW9uIGMoYSxjKXt2YXIgZD10aGlzO2Quc291cmNlPWMsZC5ydWlkPWEsYi5jYWxsKGQsXCJCbG9iXCIpLHRoaXMudWlkPWMudWlkfHx0aGlzLnVpZCx0aGlzLnR5cGU9Yy50eXBlfHxcIlwiLHRoaXMuc2l6ZT1jLnNpemV8fDAsYSYmZC5jb25uZWN0UnVudGltZShhKX1yZXR1cm4gYS5pbmhlcml0cyhiLHtjb25zdHJ1Y3RvcjpjLHNsaWNlOmZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMuZXhlYyhcInNsaWNlXCIsYSxiKX0sZ2V0U291cmNlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc291cmNlfX0pLGN9KSxiKFwibGliL2ZpbGVcIixbXCJiYXNlXCIsXCJsaWIvYmxvYlwiXSxmdW5jdGlvbihhLGIpe2Z1bmN0aW9uIGMoYSxjKXt2YXIgZjtiLmFwcGx5KHRoaXMsYXJndW1lbnRzKSx0aGlzLm5hbWU9Yy5uYW1lfHxcInVudGl0bGVkXCIrZCsrLGY9ZS5leGVjKGMubmFtZSk/UmVnRXhwLiQxLnRvTG93ZXJDYXNlKCk6XCJcIiwhZiYmdGhpcy50eXBlJiYoZj0vXFwvKGpwZ3xqcGVnfHBuZ3xnaWZ8Ym1wKSQvaS5leGVjKHRoaXMudHlwZSk/UmVnRXhwLiQxLnRvTG93ZXJDYXNlKCk6XCJcIix0aGlzLm5hbWUrPVwiLlwiK2YpLCF0aGlzLnR5cGUmJn5cImpwZyxqcGVnLHBuZyxnaWYsYm1wXCIuaW5kZXhPZihmKSYmKHRoaXMudHlwZT1cImltYWdlL1wiKyhcImpwZ1wiPT09Zj9cImpwZWdcIjpmKSksdGhpcy5leHQ9Zix0aGlzLmxhc3RNb2RpZmllZERhdGU9Yy5sYXN0TW9kaWZpZWREYXRlfHwobmV3IERhdGUpLnRvTG9jYWxlU3RyaW5nKCl9dmFyIGQ9MSxlPS9cXC4oW14uXSspJC87cmV0dXJuIGEuaW5oZXJpdHMoYixjKX0pLGIoXCJsaWIvZmlsZXBpY2tlclwiLFtcImJhc2VcIixcInJ1bnRpbWUvY2xpZW50XCIsXCJsaWIvZmlsZVwiXSxmdW5jdGlvbihiLGMsZCl7ZnVuY3Rpb24gZShhKXtpZihhPXRoaXMub3B0aW9ucz1mLmV4dGVuZCh7fSxlLm9wdGlvbnMsYSksYS5jb250YWluZXI9ZihhLmlkKSwhYS5jb250YWluZXIubGVuZ3RoKXRocm93IG5ldyBFcnJvcihcIuaMiemSruaMh+WumumUmeivr1wiKTthLmlubmVySFRNTD1hLmlubmVySFRNTHx8YS5sYWJlbHx8YS5jb250YWluZXIuaHRtbCgpfHxcIlwiLGEuYnV0dG9uPWYoYS5idXR0b258fGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIikpLGEuYnV0dG9uLmh0bWwoYS5pbm5lckhUTUwpLGEuY29udGFpbmVyLmh0bWwoYS5idXR0b24pLGMuY2FsbCh0aGlzLFwiRmlsZVBpY2tlclwiLCEwKX12YXIgZj1iLiQ7cmV0dXJuIGUub3B0aW9ucz17YnV0dG9uOm51bGwsY29udGFpbmVyOm51bGwsbGFiZWw6bnVsbCxpbm5lckhUTUw6bnVsbCxtdWx0aXBsZTohMCxhY2NlcHQ6bnVsbCxuYW1lOlwiZmlsZVwifSxiLmluaGVyaXRzKGMse2NvbnN0cnVjdG9yOmUsaW5pdDpmdW5jdGlvbigpe3ZhciBiPXRoaXMsYz1iLm9wdGlvbnMsZT1jLmJ1dHRvbjtlLmFkZENsYXNzKFwid2VidXBsb2FkZXItcGlja1wiKSxiLm9uKFwiYWxsXCIsZnVuY3Rpb24oYSl7dmFyIGc7c3dpdGNoKGEpe2Nhc2VcIm1vdXNlZW50ZXJcIjplLmFkZENsYXNzKFwid2VidXBsb2FkZXItcGljay1ob3ZlclwiKTticmVhaztjYXNlXCJtb3VzZWxlYXZlXCI6ZS5yZW1vdmVDbGFzcyhcIndlYnVwbG9hZGVyLXBpY2staG92ZXJcIik7YnJlYWs7Y2FzZVwiY2hhbmdlXCI6Zz1iLmV4ZWMoXCJnZXRGaWxlc1wiKSxiLnRyaWdnZXIoXCJzZWxlY3RcIixmLm1hcChnLGZ1bmN0aW9uKGEpe3JldHVybiBhPW5ldyBkKGIuZ2V0UnVpZCgpLGEpLGEuX3JlZmVyPWMuY29udGFpbmVyLGF9KSxjLmNvbnRhaW5lcil9fSksYi5jb25uZWN0UnVudGltZShjLGZ1bmN0aW9uKCl7Yi5yZWZyZXNoKCksYi5leGVjKFwiaW5pdFwiLGMpLGIudHJpZ2dlcihcInJlYWR5XCIpfSksZihhKS5vbihcInJlc2l6ZVwiLGZ1bmN0aW9uKCl7Yi5yZWZyZXNoKCl9KX0scmVmcmVzaDpmdW5jdGlvbigpe3ZhciBhPXRoaXMuZ2V0UnVudGltZSgpLmdldENvbnRhaW5lcigpLGI9dGhpcy5vcHRpb25zLmJ1dHRvbixjPWIub3V0ZXJXaWR0aD9iLm91dGVyV2lkdGgoKTpiLndpZHRoKCksZD1iLm91dGVySGVpZ2h0P2Iub3V0ZXJIZWlnaHQoKTpiLmhlaWdodCgpLGU9Yi5vZmZzZXQoKTtjJiZkJiZhLmNzcyh7Ym90dG9tOlwiYXV0b1wiLHJpZ2h0OlwiYXV0b1wiLHdpZHRoOmMrXCJweFwiLGhlaWdodDpkK1wicHhcIn0pLm9mZnNldChlKX0sZW5hYmxlOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5vcHRpb25zLmJ1dHRvbjthLnJlbW92ZUNsYXNzKFwid2VidXBsb2FkZXItcGljay1kaXNhYmxlXCIpLHRoaXMucmVmcmVzaCgpfSxkaXNhYmxlOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5vcHRpb25zLmJ1dHRvbjt0aGlzLmdldFJ1bnRpbWUoKS5nZXRDb250YWluZXIoKS5jc3Moe3RvcDpcIi05OTk5OXB4XCJ9KSxhLmFkZENsYXNzKFwid2VidXBsb2FkZXItcGljay1kaXNhYmxlXCIpfSxkZXN0cm95OmZ1bmN0aW9uKCl7dGhpcy5ydW50aW1lJiYodGhpcy5leGVjKFwiZGVzdHJveVwiKSx0aGlzLmRpc2Nvbm5lY3RSdW50aW1lKCkpfX0pLGV9KSxiKFwid2lkZ2V0cy9maWxlcGlja2VyXCIsW1wiYmFzZVwiLFwidXBsb2FkZXJcIixcImxpYi9maWxlcGlja2VyXCIsXCJ3aWRnZXRzL3dpZGdldFwiXSxmdW5jdGlvbihhLGIsYyl7dmFyIGQ9YS4kO3JldHVybiBkLmV4dGVuZChiLm9wdGlvbnMse3BpY2s6bnVsbCxhY2NlcHQ6bnVsbH0pLGIucmVnaXN0ZXIoe1wiYWRkLWJ0blwiOlwiYWRkQnV0dG9uXCIscmVmcmVzaDpcInJlZnJlc2hcIixkaXNhYmxlOlwiZGlzYWJsZVwiLGVuYWJsZTpcImVuYWJsZVwifSx7aW5pdDpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5waWNrZXJzPVtdLGEucGljayYmdGhpcy5hZGRCdXR0b24oYS5waWNrKX0scmVmcmVzaDpmdW5jdGlvbigpe2QuZWFjaCh0aGlzLnBpY2tlcnMsZnVuY3Rpb24oKXt0aGlzLnJlZnJlc2goKX0pfSxhZGRCdXR0b246ZnVuY3Rpb24oYil7dmFyIGUsZixnLGg9dGhpcyxpPWgub3B0aW9ucyxqPWkuYWNjZXB0O2lmKGIpcmV0dXJuIGc9YS5EZWZlcnJlZCgpLGQuaXNQbGFpbk9iamVjdChiKXx8KGI9e2lkOmJ9KSxlPWQuZXh0ZW5kKHt9LGIse2FjY2VwdDpkLmlzUGxhaW5PYmplY3Qoaik/W2pdOmosc3dmOmkuc3dmLHJ1bnRpbWVPcmRlcjppLnJ1bnRpbWVPcmRlcn0pLGY9bmV3IGMoZSksZi5vbmNlKFwicmVhZHlcIixnLnJlc29sdmUpLGYub24oXCJzZWxlY3RcIixmdW5jdGlvbihhKXtoLm93bmVyLnJlcXVlc3QoXCJhZGQtZmlsZVwiLFthXSl9KSxmLmluaXQoKSx0aGlzLnBpY2tlcnMucHVzaChmKSxnLnByb21pc2UoKX0sZGlzYWJsZTpmdW5jdGlvbigpe2QuZWFjaCh0aGlzLnBpY2tlcnMsZnVuY3Rpb24oKXt0aGlzLmRpc2FibGUoKX0pfSxlbmFibGU6ZnVuY3Rpb24oKXtkLmVhY2godGhpcy5waWNrZXJzLGZ1bmN0aW9uKCl7dGhpcy5lbmFibGUoKX0pfX0pfSksYihcImxpYi9pbWFnZVwiLFtcImJhc2VcIixcInJ1bnRpbWUvY2xpZW50XCIsXCJsaWIvYmxvYlwiXSxmdW5jdGlvbihhLGIsYyl7ZnVuY3Rpb24gZChhKXt0aGlzLm9wdGlvbnM9ZS5leHRlbmQoe30sZC5vcHRpb25zLGEpLGIuY2FsbCh0aGlzLFwiSW1hZ2VcIiksdGhpcy5vbihcImxvYWRcIixmdW5jdGlvbigpe3RoaXMuX2luZm89dGhpcy5leGVjKFwiaW5mb1wiKSx0aGlzLl9tZXRhPXRoaXMuZXhlYyhcIm1ldGFcIil9KX12YXIgZT1hLiQ7cmV0dXJuIGQub3B0aW9ucz17cXVhbGl0eTo5MCxjcm9wOiExLHByZXNlcnZlSGVhZGVyczohMCxhbGxvd01hZ25pZnk6ITB9LGEuaW5oZXJpdHMoYix7Y29uc3RydWN0b3I6ZCxpbmZvOmZ1bmN0aW9uKGEpe3JldHVybiBhPyh0aGlzLl9pbmZvPWEsdGhpcyk6dGhpcy5faW5mb30sbWV0YTpmdW5jdGlvbihhKXtyZXR1cm4gYT8odGhpcy5fbWV0YT1hLHRoaXMpOnRoaXMuX21ldGF9LGxvYWRGcm9tQmxvYjpmdW5jdGlvbihhKXt2YXIgYj10aGlzLGM9YS5nZXRSdWlkKCk7dGhpcy5jb25uZWN0UnVudGltZShjLGZ1bmN0aW9uKCl7Yi5leGVjKFwiaW5pdFwiLGIub3B0aW9ucyksYi5leGVjKFwibG9hZEZyb21CbG9iXCIsYSl9KX0scmVzaXplOmZ1bmN0aW9uKCl7dmFyIGI9YS5zbGljZShhcmd1bWVudHMpO3JldHVybiB0aGlzLmV4ZWMuYXBwbHkodGhpcyxbXCJyZXNpemVcIl0uY29uY2F0KGIpKX0sZ2V0QXNEYXRhVXJsOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmV4ZWMoXCJnZXRBc0RhdGFVcmxcIixhKX0sZ2V0QXNCbG9iOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuZXhlYyhcImdldEFzQmxvYlwiLGEpO3JldHVybiBuZXcgYyh0aGlzLmdldFJ1aWQoKSxiKX19KSxkfSksYihcIndpZGdldHMvaW1hZ2VcIixbXCJiYXNlXCIsXCJ1cGxvYWRlclwiLFwibGliL2ltYWdlXCIsXCJ3aWRnZXRzL3dpZGdldFwiXSxmdW5jdGlvbihhLGIsYyl7dmFyIGQsZT1hLiQ7cmV0dXJuIGQ9ZnVuY3Rpb24oYSl7dmFyIGI9MCxjPVtdLGQ9ZnVuY3Rpb24oKXtmb3IodmFyIGQ7Yy5sZW5ndGgmJmE+YjspZD1jLnNoaWZ0KCksYis9ZFswXSxkWzFdKCl9O3JldHVybiBmdW5jdGlvbihhLGUsZil7Yy5wdXNoKFtlLGZdKSxhLm9uY2UoXCJkZXN0cm95XCIsZnVuY3Rpb24oKXtiLT1lLHNldFRpbWVvdXQoZCwxKX0pLHNldFRpbWVvdXQoZCwxKX19KDUyNDI4ODApLGUuZXh0ZW5kKGIub3B0aW9ucyx7dGh1bWI6e3dpZHRoOjExMCxoZWlnaHQ6MTEwLHF1YWxpdHk6NzAsYWxsb3dNYWduaWZ5OiEwLGNyb3A6ITAscHJlc2VydmVIZWFkZXJzOiExLHR5cGU6XCJpbWFnZS9qcGVnXCJ9LGNvbXByZXNzOnt3aWR0aDoxNjAwLGhlaWdodDoxNjAwLHF1YWxpdHk6OTAsYWxsb3dNYWduaWZ5OiExLGNyb3A6ITEscHJlc2VydmVIZWFkZXJzOiEwfX0pLGIucmVnaXN0ZXIoe1wibWFrZS10aHVtYlwiOlwibWFrZVRodW1iXCIsXCJiZWZvcmUtc2VuZC1maWxlXCI6XCJjb21wcmVzc0ltYWdlXCJ9LHttYWtlVGh1bWI6ZnVuY3Rpb24oYSxiLGYsZyl7dmFyIGgsaTtyZXR1cm4gYT10aGlzLnJlcXVlc3QoXCJnZXQtZmlsZVwiLGEpLGEudHlwZS5tYXRjaCgvXmltYWdlLyk/KGg9ZS5leHRlbmQoe30sdGhpcy5vcHRpb25zLnRodW1iKSxlLmlzUGxhaW5PYmplY3QoZikmJihoPWUuZXh0ZW5kKGgsZiksZj1udWxsKSxmPWZ8fGgud2lkdGgsZz1nfHxoLmhlaWdodCxpPW5ldyBjKGgpLGkub25jZShcImxvYWRcIixmdW5jdGlvbigpe2EuX2luZm89YS5faW5mb3x8aS5pbmZvKCksYS5fbWV0YT1hLl9tZXRhfHxpLm1ldGEoKSxpLnJlc2l6ZShmLGcpfSksaS5vbmNlKFwiY29tcGxldGVcIixmdW5jdGlvbigpe2IoITEsaS5nZXRBc0RhdGFVcmwoaC50eXBlKSksaS5kZXN0cm95KCl9KSxpLm9uY2UoXCJlcnJvclwiLGZ1bmN0aW9uKCl7YighMCksaS5kZXN0cm95KCl9KSx2b2lkIGQoaSxhLnNvdXJjZS5zaXplLGZ1bmN0aW9uKCl7YS5faW5mbyYmaS5pbmZvKGEuX2luZm8pLGEuX21ldGEmJmkubWV0YShhLl9tZXRhKSxpLmxvYWRGcm9tQmxvYihhLnNvdXJjZSl9KSk6dm9pZCBiKCEwKX0sY29tcHJlc3NJbWFnZTpmdW5jdGlvbihiKXt2YXIgZCxmLGc9dGhpcy5vcHRpb25zLmNvbXByZXNzfHx0aGlzLm9wdGlvbnMucmVzaXplLGg9ZyYmZy5jb21wcmVzc1NpemV8fDMwNzIwMDtyZXR1cm4gYj10aGlzLnJlcXVlc3QoXCJnZXQtZmlsZVwiLGIpLCFnfHwhflwiaW1hZ2UvanBlZyxpbWFnZS9qcGdcIi5pbmRleE9mKGIudHlwZSl8fGIuc2l6ZTxofHxiLl9jb21wcmVzc2VkP3ZvaWQgMDooZz1lLmV4dGVuZCh7fSxnKSxmPWEuRGVmZXJyZWQoKSxkPW5ldyBjKGcpLGYuYWx3YXlzKGZ1bmN0aW9uKCl7ZC5kZXN0cm95KCksZD1udWxsfSksZC5vbmNlKFwiZXJyb3JcIixmLnJlamVjdCksZC5vbmNlKFwibG9hZFwiLGZ1bmN0aW9uKCl7Yi5faW5mbz1iLl9pbmZvfHxkLmluZm8oKSxiLl9tZXRhPWIuX21ldGF8fGQubWV0YSgpLGQucmVzaXplKGcud2lkdGgsZy5oZWlnaHQpfSksZC5vbmNlKFwiY29tcGxldGVcIixmdW5jdGlvbigpe3ZhciBhLGM7dHJ5e2E9ZC5nZXRBc0Jsb2IoZy50eXBlKSxjPWIuc2l6ZSxhLnNpemU8YyYmKGIuc291cmNlPWEsYi5zaXplPWEuc2l6ZSxiLnRyaWdnZXIoXCJyZXNpemVcIixhLnNpemUsYykpLGIuX2NvbXByZXNzZWQ9ITAsZi5yZXNvbHZlKCl9Y2F0Y2goZSl7Zi5yZXNvbHZlKCl9fSksYi5faW5mbyYmZC5pbmZvKGIuX2luZm8pLGIuX21ldGEmJmQubWV0YShiLl9tZXRhKSxkLmxvYWRGcm9tQmxvYihiLnNvdXJjZSksZi5wcm9taXNlKCkpfX0pfSksYihcImZpbGVcIixbXCJiYXNlXCIsXCJtZWRpYXRvclwiXSxmdW5jdGlvbihhLGIpe2Z1bmN0aW9uIGMoKXtyZXR1cm4gZitnKyt9ZnVuY3Rpb24gZChhKXt0aGlzLm5hbWU9YS5uYW1lfHxcIlVudGl0bGVkXCIsdGhpcy5zaXplPWEuc2l6ZXx8MCx0aGlzLnR5cGU9YS50eXBlfHxcImFwcGxpY2F0aW9uXCIsdGhpcy5sYXN0TW9kaWZpZWREYXRlPWEubGFzdE1vZGlmaWVkRGF0ZXx8MSpuZXcgRGF0ZSx0aGlzLmlkPWMoKSx0aGlzLmV4dD1oLmV4ZWModGhpcy5uYW1lKT9SZWdFeHAuJDE6XCJcIix0aGlzLnN0YXR1c1RleHQ9XCJcIixpW3RoaXMuaWRdPWQuU3RhdHVzLklOSVRFRCx0aGlzLnNvdXJjZT1hLHRoaXMubG9hZGVkPTAsdGhpcy5vbihcImVycm9yXCIsZnVuY3Rpb24oYSl7dGhpcy5zZXRTdGF0dXMoZC5TdGF0dXMuRVJST1IsYSl9KX12YXIgZT1hLiQsZj1cIldVX0ZJTEVfXCIsZz0wLGg9L1xcLihbXi5dKykkLyxpPXt9O3JldHVybiBlLmV4dGVuZChkLnByb3RvdHlwZSx7c2V0U3RhdHVzOmZ1bmN0aW9uKGEsYil7dmFyIGM9aVt0aGlzLmlkXTtcInVuZGVmaW5lZFwiIT10eXBlb2YgYiYmKHRoaXMuc3RhdHVzVGV4dD1iKSxhIT09YyYmKGlbdGhpcy5pZF09YSx0aGlzLnRyaWdnZXIoXCJzdGF0dXNjaGFuZ2VcIixhLGMpKX0sZ2V0U3RhdHVzOmZ1bmN0aW9uKCl7cmV0dXJuIGlbdGhpcy5pZF19LGdldFNvdXJjZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLnNvdXJjZX0sZGVzdG9yeTpmdW5jdGlvbigpe2RlbGV0ZSBpW3RoaXMuaWRdfX0pLGIuaW5zdGFsbFRvKGQucHJvdG90eXBlKSxkLlN0YXR1cz17SU5JVEVEOlwiaW5pdGVkXCIsUVVFVUVEOlwicXVldWVkXCIsUFJPR1JFU1M6XCJwcm9ncmVzc1wiLEVSUk9SOlwiZXJyb3JcIixDT01QTEVURTpcImNvbXBsZXRlXCIsQ0FOQ0VMTEVEOlwiY2FuY2VsbGVkXCIsSU5URVJSVVBUOlwiaW50ZXJydXB0XCIsSU5WQUxJRDpcImludmFsaWRcIn0sZH0pLGIoXCJxdWV1ZVwiLFtcImJhc2VcIixcIm1lZGlhdG9yXCIsXCJmaWxlXCJdLGZ1bmN0aW9uKGEsYixjKXtmdW5jdGlvbiBkKCl7dGhpcy5zdGF0cz17bnVtT2ZRdWV1ZTowLG51bU9mU3VjY2VzczowLG51bU9mQ2FuY2VsOjAsbnVtT2ZQcm9ncmVzczowLG51bU9mVXBsb2FkRmFpbGVkOjAsbnVtT2ZJbnZhbGlkOjB9LHRoaXMuX3F1ZXVlPVtdLHRoaXMuX21hcD17fX12YXIgZT1hLiQsZj1jLlN0YXR1cztyZXR1cm4gZS5leHRlbmQoZC5wcm90b3R5cGUse2FwcGVuZDpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5fcXVldWUucHVzaChhKSx0aGlzLl9maWxlQWRkZWQoYSksdGhpc30scHJlcGVuZDpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5fcXVldWUudW5zaGlmdChhKSx0aGlzLl9maWxlQWRkZWQoYSksdGhpc30sZ2V0RmlsZTpmdW5jdGlvbihhKXtyZXR1cm5cInN0cmluZ1wiIT10eXBlb2YgYT9hOnRoaXMuX21hcFthXX0sZmV0Y2g6ZnVuY3Rpb24oYSl7dmFyIGIsYyxkPXRoaXMuX3F1ZXVlLmxlbmd0aDtmb3IoYT1hfHxmLlFVRVVFRCxiPTA7ZD5iO2IrKylpZihjPXRoaXMuX3F1ZXVlW2JdLGE9PT1jLmdldFN0YXR1cygpKXJldHVybiBjO3JldHVybiBudWxsfSxzb3J0OmZ1bmN0aW9uKGEpe1wiZnVuY3Rpb25cIj09dHlwZW9mIGEmJnRoaXMuX3F1ZXVlLnNvcnQoYSl9LGdldEZpbGVzOmZ1bmN0aW9uKCl7Zm9yKHZhciBhLGI9W10uc2xpY2UuY2FsbChhcmd1bWVudHMsMCksYz1bXSxkPTAsZj10aGlzLl9xdWV1ZS5sZW5ndGg7Zj5kO2QrKylhPXRoaXMuX3F1ZXVlW2RdLCghYi5sZW5ndGh8fH5lLmluQXJyYXkoYS5nZXRTdGF0dXMoKSxiKSkmJmMucHVzaChhKTtyZXR1cm4gY30sX2ZpbGVBZGRlZDpmdW5jdGlvbihhKXt2YXIgYj10aGlzLGM9dGhpcy5fbWFwW2EuaWRdO2N8fCh0aGlzLl9tYXBbYS5pZF09YSxhLm9uKFwic3RhdHVzY2hhbmdlXCIsZnVuY3Rpb24oYSxjKXtiLl9vbkZpbGVTdGF0dXNDaGFuZ2UoYSxjKX0pKSxhLnNldFN0YXR1cyhmLlFVRVVFRCl9LF9vbkZpbGVTdGF0dXNDaGFuZ2U6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLnN0YXRzO3N3aXRjaChiKXtjYXNlIGYuUFJPR1JFU1M6Yy5udW1PZlByb2dyZXNzLS07YnJlYWs7Y2FzZSBmLlFVRVVFRDpjLm51bU9mUXVldWUtLTticmVhaztjYXNlIGYuRVJST1I6Yy5udW1PZlVwbG9hZEZhaWxlZC0tO2JyZWFrO2Nhc2UgZi5JTlZBTElEOmMubnVtT2ZJbnZhbGlkLS19c3dpdGNoKGEpe2Nhc2UgZi5RVUVVRUQ6Yy5udW1PZlF1ZXVlKys7YnJlYWs7Y2FzZSBmLlBST0dSRVNTOmMubnVtT2ZQcm9ncmVzcysrO2JyZWFrO2Nhc2UgZi5FUlJPUjpjLm51bU9mVXBsb2FkRmFpbGVkKys7YnJlYWs7Y2FzZSBmLkNPTVBMRVRFOmMubnVtT2ZTdWNjZXNzKys7YnJlYWs7Y2FzZSBmLkNBTkNFTExFRDpjLm51bU9mQ2FuY2VsKys7YnJlYWs7Y2FzZSBmLklOVkFMSUQ6Yy5udW1PZkludmFsaWQrK319fSksYi5pbnN0YWxsVG8oZC5wcm90b3R5cGUpLGR9KSxiKFwid2lkZ2V0cy9xdWV1ZVwiLFtcImJhc2VcIixcInVwbG9hZGVyXCIsXCJxdWV1ZVwiLFwiZmlsZVwiLFwibGliL2ZpbGVcIixcInJ1bnRpbWUvY2xpZW50XCIsXCJ3aWRnZXRzL3dpZGdldFwiXSxmdW5jdGlvbihhLGIsYyxkLGUsZil7dmFyIGc9YS4kLGg9L1xcLlxcdyskLyxpPWQuU3RhdHVzO3JldHVybiBiLnJlZ2lzdGVyKHtcInNvcnQtZmlsZXNcIjpcInNvcnRGaWxlc1wiLFwiYWRkLWZpbGVcIjpcImFkZEZpbGVzXCIsXCJnZXQtZmlsZVwiOlwiZ2V0RmlsZVwiLFwiZmV0Y2gtZmlsZVwiOlwiZmV0Y2hGaWxlXCIsXCJnZXQtc3RhdHNcIjpcImdldFN0YXRzXCIsXCJnZXQtZmlsZXNcIjpcImdldEZpbGVzXCIsXCJyZW1vdmUtZmlsZVwiOlwicmVtb3ZlRmlsZVwiLHJldHJ5OlwicmV0cnlcIixyZXNldDpcInJlc2V0XCIsXCJhY2NlcHQtZmlsZVwiOlwiYWNjZXB0RmlsZVwifSx7aW5pdDpmdW5jdGlvbihiKXt2YXIgZCxlLGgsaSxqLGssbCxtPXRoaXM7aWYoZy5pc1BsYWluT2JqZWN0KGIuYWNjZXB0KSYmKGIuYWNjZXB0PVtiLmFjY2VwdF0pLGIuYWNjZXB0KXtmb3Ioaj1bXSxoPTAsZT1iLmFjY2VwdC5sZW5ndGg7ZT5oO2grKylpPWIuYWNjZXB0W2hdLmV4dGVuc2lvbnMsaSYmai5wdXNoKGkpO2oubGVuZ3RoJiYoaz1cIlxcXFwuXCIrai5qb2luKFwiLFwiKS5yZXBsYWNlKC8sL2csXCIkfFxcXFwuXCIpLnJlcGxhY2UoL1xcKi9nLFwiLipcIikrXCIkXCIpLG0uYWNjZXB0PW5ldyBSZWdFeHAoayxcImlcIil9cmV0dXJuIG0ucXVldWU9bmV3IGMsbS5zdGF0cz1tLnF1ZXVlLnN0YXRzLFwiaHRtbDVcIj09PXRoaXMucmVxdWVzdChcInByZWRpY3QtcnVudGltZS10eXBlXCIpPyhkPWEuRGVmZXJyZWQoKSxsPW5ldyBmKFwiUGxhY2Vob2xkZXJcIiksbC5jb25uZWN0UnVudGltZSh7cnVudGltZU9yZGVyOlwiaHRtbDVcIn0sZnVuY3Rpb24oKXttLl9ydWlkPWwuZ2V0UnVpZCgpLGQucmVzb2x2ZSgpfSksZC5wcm9taXNlKCkpOnZvaWQgMH0sX3dyYXBGaWxlOmZ1bmN0aW9uKGEpe2lmKCEoYSBpbnN0YW5jZW9mIGQpKXtpZighKGEgaW5zdGFuY2VvZiBlKSl7aWYoIXRoaXMuX3J1aWQpdGhyb3cgbmV3IEVycm9yKFwiQ2FuJ3QgYWRkIGV4dGVybmFsIGZpbGVzLlwiKTthPW5ldyBlKHRoaXMuX3J1aWQsYSl9YT1uZXcgZChhKX1yZXR1cm4gYX0sYWNjZXB0RmlsZTpmdW5jdGlvbihhKXt2YXIgYj0hYXx8YS5zaXplPDZ8fHRoaXMuYWNjZXB0JiZoLmV4ZWMoYS5uYW1lKSYmIXRoaXMuYWNjZXB0LnRlc3QoYS5uYW1lKTtyZXR1cm4hYn0sX2FkZEZpbGU6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcztyZXR1cm4gYT1iLl93cmFwRmlsZShhKSxiLm93bmVyLnRyaWdnZXIoXCJiZWZvcmVGaWxlUXVldWVkXCIsYSk/Yi5hY2NlcHRGaWxlKGEpPyhiLnF1ZXVlLmFwcGVuZChhKSxiLm93bmVyLnRyaWdnZXIoXCJmaWxlUXVldWVkXCIsYSksYSk6dm9pZCBiLm93bmVyLnRyaWdnZXIoXCJlcnJvclwiLFwiUV9UWVBFX0RFTklFRFwiLGEpOnZvaWQgMH0sZ2V0RmlsZTpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5xdWV1ZS5nZXRGaWxlKGEpfSxhZGRGaWxlczpmdW5jdGlvbihhKXt2YXIgYj10aGlzO2EubGVuZ3RofHwoYT1bYV0pLGE9Zy5tYXAoYSxmdW5jdGlvbihhKXtyZXR1cm4gYi5fYWRkRmlsZShhKX0pLGIub3duZXIudHJpZ2dlcihcImZpbGVzUXVldWVkXCIsYSksYi5vcHRpb25zLmF1dG8mJmIucmVxdWVzdChcInN0YXJ0LXVwbG9hZFwiKX0sZ2V0U3RhdHM6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zdGF0c30scmVtb3ZlRmlsZTpmdW5jdGlvbihhKXt2YXIgYj10aGlzO2E9YS5pZD9hOmIucXVldWUuZ2V0RmlsZShhKSxhLnNldFN0YXR1cyhpLkNBTkNFTExFRCksYi5vd25lci50cmlnZ2VyKFwiZmlsZURlcXVldWVkXCIsYSl9LGdldEZpbGVzOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucXVldWUuZ2V0RmlsZXMuYXBwbHkodGhpcy5xdWV1ZSxhcmd1bWVudHMpfSxmZXRjaEZpbGU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5xdWV1ZS5mZXRjaC5hcHBseSh0aGlzLnF1ZXVlLGFyZ3VtZW50cyl9LHJldHJ5OmZ1bmN0aW9uKGEsYil7dmFyIGMsZCxlLGY9dGhpcztpZihhKXJldHVybiBhPWEuaWQ/YTpmLnF1ZXVlLmdldEZpbGUoYSksYS5zZXRTdGF0dXMoaS5RVUVVRUQpLHZvaWQoYnx8Zi5yZXF1ZXN0KFwic3RhcnQtdXBsb2FkXCIpKTtmb3IoYz1mLnF1ZXVlLmdldEZpbGVzKGkuRVJST1IpLGQ9MCxlPWMubGVuZ3RoO2U+ZDtkKyspYT1jW2RdLGEuc2V0U3RhdHVzKGkuUVVFVUVEKTtmLnJlcXVlc3QoXCJzdGFydC11cGxvYWRcIil9LHNvcnRGaWxlczpmdW5jdGlvbigpe3JldHVybiB0aGlzLnF1ZXVlLnNvcnQuYXBwbHkodGhpcy5xdWV1ZSxhcmd1bWVudHMpfSxyZXNldDpmdW5jdGlvbigpe3RoaXMucXVldWU9bmV3IGMsdGhpcy5zdGF0cz10aGlzLnF1ZXVlLnN0YXRzfX0pfSksYihcIndpZGdldHMvcnVudGltZVwiLFtcInVwbG9hZGVyXCIsXCJydW50aW1lL3J1bnRpbWVcIixcIndpZGdldHMvd2lkZ2V0XCJdLGZ1bmN0aW9uKGEsYil7cmV0dXJuIGEuc3VwcG9ydD1mdW5jdGlvbigpe3JldHVybiBiLmhhc1J1bnRpbWUuYXBwbHkoYixhcmd1bWVudHMpfSxhLnJlZ2lzdGVyKHtcInByZWRpY3QtcnVudGltZS10eXBlXCI6XCJwcmVkaWN0UnVudG1lVHlwZVwifSx7aW5pdDpmdW5jdGlvbigpe2lmKCF0aGlzLnByZWRpY3RSdW50bWVUeXBlKCkpdGhyb3cgRXJyb3IoXCJSdW50aW1lIEVycm9yXCIpfSxwcmVkaWN0UnVudG1lVHlwZTpmdW5jdGlvbigpe3ZhciBhLGMsZD10aGlzLm9wdGlvbnMucnVudGltZU9yZGVyfHxiLm9yZGVycyxlPXRoaXMudHlwZTtpZighZSlmb3IoZD1kLnNwbGl0KC9cXHMqLFxccyovZyksYT0wLGM9ZC5sZW5ndGg7Yz5hO2ErKylpZihiLmhhc1J1bnRpbWUoZFthXSkpe3RoaXMudHlwZT1lPWRbYV07YnJlYWt9cmV0dXJuIGV9fSl9KSxiKFwibGliL3RyYW5zcG9ydFwiLFtcImJhc2VcIixcInJ1bnRpbWUvY2xpZW50XCIsXCJtZWRpYXRvclwiXSxmdW5jdGlvbihhLGIsYyl7ZnVuY3Rpb24gZChhKXt2YXIgYz10aGlzO2E9Yy5vcHRpb25zPWUuZXh0ZW5kKCEwLHt9LGQub3B0aW9ucyxhfHx7fSksYi5jYWxsKHRoaXMsXCJUcmFuc3BvcnRcIiksdGhpcy5fYmxvYj1udWxsLHRoaXMuX2Zvcm1EYXRhPWEuZm9ybURhdGF8fHt9LHRoaXMuX2hlYWRlcnM9YS5oZWFkZXJzfHx7fSx0aGlzLm9uKFwicHJvZ3Jlc3NcIix0aGlzLl90aW1lb3V0KSx0aGlzLm9uKFwibG9hZCBlcnJvclwiLGZ1bmN0aW9uKCl7Yy50cmlnZ2VyKFwicHJvZ3Jlc3NcIiwxKSxjbGVhclRpbWVvdXQoYy5fdGltZXIpfSl9dmFyIGU9YS4kO3JldHVybiBkLm9wdGlvbnM9e3NlcnZlcjpcIlwiLG1ldGhvZDpcIlBPU1RcIix3aXRoQ3JlZGVudGlhbHM6ITEsZmlsZVZhbDpcImZpbGVcIix0aW1lb3V0OjEyZTQsZm9ybURhdGE6e30saGVhZGVyczp7fSxzZW5kQXNCaW5hcnk6ITF9LGUuZXh0ZW5kKGQucHJvdG90eXBlLHthcHBlbmRCbG9iOmZ1bmN0aW9uKGEsYixjKXt2YXIgZD10aGlzLGU9ZC5vcHRpb25zO2QuZ2V0UnVpZCgpJiZkLmRpc2Nvbm5lY3RSdW50aW1lKCksZC5jb25uZWN0UnVudGltZShiLnJ1aWQsZnVuY3Rpb24oKXtkLmV4ZWMoXCJpbml0XCIpfSksZC5fYmxvYj1iLGUuZmlsZVZhbD1hfHxlLmZpbGVWYWwsZS5maWxlbmFtZT1jfHxlLmZpbGVuYW1lfSxhcHBlbmQ6ZnVuY3Rpb24oYSxiKXtcIm9iamVjdFwiPT10eXBlb2YgYT9lLmV4dGVuZCh0aGlzLl9mb3JtRGF0YSxhKTp0aGlzLl9mb3JtRGF0YVthXT1ifSxzZXRSZXF1ZXN0SGVhZGVyOmZ1bmN0aW9uKGEsYil7XCJvYmplY3RcIj09dHlwZW9mIGE/ZS5leHRlbmQodGhpcy5faGVhZGVycyxhKTp0aGlzLl9oZWFkZXJzW2FdPWJ9LHNlbmQ6ZnVuY3Rpb24oYSl7dGhpcy5leGVjKFwic2VuZFwiLGEpLHRoaXMuX3RpbWVvdXQoKX0sYWJvcnQ6ZnVuY3Rpb24oKXtyZXR1cm4gY2xlYXJUaW1lb3V0KHRoaXMuX3RpbWVyKSx0aGlzLmV4ZWMoXCJhYm9ydFwiKX0sZGVzdHJveTpmdW5jdGlvbigpe3RoaXMudHJpZ2dlcihcImRlc3Ryb3lcIiksdGhpcy5vZmYoKSx0aGlzLmV4ZWMoXCJkZXN0cm95XCIpLHRoaXMuZGlzY29ubmVjdFJ1bnRpbWUoKX0sZ2V0UmVzcG9uc2U6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5leGVjKFwiZ2V0UmVzcG9uc2VcIil9LGdldFJlc3BvbnNlQXNKc29uOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZXhlYyhcImdldFJlc3BvbnNlQXNKc29uXCIpfSxnZXRTdGF0dXM6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5leGVjKFwiZ2V0U3RhdHVzXCIpfSxfdGltZW91dDpmdW5jdGlvbigpe3ZhciBhPXRoaXMsYj1hLm9wdGlvbnMudGltZW91dDtiJiYoY2xlYXJUaW1lb3V0KGEuX3RpbWVyKSxhLl90aW1lcj1zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7YS5hYm9ydCgpLGEudHJpZ2dlcihcImVycm9yXCIsXCJ0aW1lb3V0XCIpfSxiKSl9fSksYy5pbnN0YWxsVG8oZC5wcm90b3R5cGUpLGR9KSxiKFwid2lkZ2V0cy91cGxvYWRcIixbXCJiYXNlXCIsXCJ1cGxvYWRlclwiLFwiZmlsZVwiLFwibGliL3RyYW5zcG9ydFwiLFwid2lkZ2V0cy93aWRnZXRcIl0sZnVuY3Rpb24oYSxiLGMsZCl7ZnVuY3Rpb24gZShhLGIpe2Zvcih2YXIgYyxkPVtdLGU9YS5zb3VyY2UsZj1lLnNpemUsZz1iP01hdGguY2VpbChmL2IpOjEsaD0wLGk9MDtnPmk7KWM9TWF0aC5taW4oYixmLWgpLGQucHVzaCh7ZmlsZTphLHN0YXJ0OmgsZW5kOmI/aCtjOmYsdG90YWw6ZixjaHVua3M6ZyxjaHVuazppKyt9KSxoKz1jO3JldHVybiBhLmJsb2Nrcz1kLmNvbmNhdCgpLGEucmVtYW5pbmc9ZC5sZW5ndGgse2ZpbGU6YSxoYXM6ZnVuY3Rpb24oKXtyZXR1cm4hIWQubGVuZ3RofSxmZXRjaDpmdW5jdGlvbigpe3JldHVybiBkLnNoaWZ0KCl9fX12YXIgZj1hLiQsZz1hLmlzUHJvbWlzZSxoPWMuU3RhdHVzO2YuZXh0ZW5kKGIub3B0aW9ucyx7cHJlcGFyZU5leHRGaWxlOiExLGNodW5rZWQ6ITEsY2h1bmtTaXplOjUyNDI4ODAsY2h1bmtSZXRyeToyLHRocmVhZHM6Myxmb3JtRGF0YTpudWxsfSksYi5yZWdpc3Rlcih7XCJzdGFydC11cGxvYWRcIjpcInN0YXJ0XCIsXCJzdG9wLXVwbG9hZFwiOlwic3RvcFwiLFwic2tpcC1maWxlXCI6XCJza2lwRmlsZVwiLFwiaXMtaW4tcHJvZ3Jlc3NcIjpcImlzSW5Qcm9ncmVzc1wifSx7aW5pdDpmdW5jdGlvbigpe3ZhciBiPXRoaXMub3duZXI7dGhpcy5ydW5pbmc9ITEsdGhpcy5wb29sPVtdLHRoaXMucGVuZGluZz1bXSx0aGlzLnJlbWFuaW5nPTAsdGhpcy5fX3RpY2s9YS5iaW5kRm4odGhpcy5fdGljayx0aGlzKSxiLm9uKFwidXBsb2FkQ29tcGxldGVcIixmdW5jdGlvbihhKXthLmJsb2NrcyYmZi5lYWNoKGEuYmxvY2tzLGZ1bmN0aW9uKGEsYil7Yi50cmFuc3BvcnQmJihiLnRyYW5zcG9ydC5hYm9ydCgpLGIudHJhbnNwb3J0LmRlc3Ryb3koKSksZGVsZXRlIGIudHJhbnNwb3J0fSksZGVsZXRlIGEuYmxvY2tzLGRlbGV0ZSBhLnJlbWFuaW5nfSl9LHN0YXJ0OmZ1bmN0aW9uKCl7dmFyIGI9dGhpcztmLmVhY2goYi5yZXF1ZXN0KFwiZ2V0LWZpbGVzXCIsaC5JTlZBTElEKSxmdW5jdGlvbigpe2IucmVxdWVzdChcInJlbW92ZS1maWxlXCIsdGhpcyl9KSxiLnJ1bmluZ3x8KGIucnVuaW5nPSEwLGYuZWFjaChiLnBvb2wsZnVuY3Rpb24oYSxjKXt2YXIgZD1jLmZpbGU7ZC5nZXRTdGF0dXMoKT09PWguSU5URVJSVVBUJiYoZC5zZXRTdGF0dXMoaC5QUk9HUkVTUyksYi5fdHJpZ2dlZD0hMSxjLnRyYW5zcG9ydCYmYy50cmFuc3BvcnQuc2VuZCgpKX0pLGIuX3RyaWdnZWQ9ITEsYi5vd25lci50cmlnZ2VyKFwic3RhcnRVcGxvYWRcIiksYS5uZXh0VGljayhiLl9fdGljaykpfSxzdG9wOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXM7Yi5ydW5pbmchPT0hMSYmKGIucnVuaW5nPSExLGEmJmYuZWFjaChiLnBvb2wsZnVuY3Rpb24oYSxiKXtiLnRyYW5zcG9ydCYmYi50cmFuc3BvcnQuYWJvcnQoKSxiLmZpbGUuc2V0U3RhdHVzKGguSU5URVJSVVBUKX0pLGIub3duZXIudHJpZ2dlcihcInN0b3BVcGxvYWRcIikpfSxpc0luUHJvZ3Jlc3M6ZnVuY3Rpb24oKXtyZXR1cm4hIXRoaXMucnVuaW5nfSxnZXRTdGF0czpmdW5jdGlvbigpe3JldHVybiB0aGlzLnJlcXVlc3QoXCJnZXQtc3RhdHNcIil9LHNraXBGaWxlOmZ1bmN0aW9uKGEsYil7YT10aGlzLnJlcXVlc3QoXCJnZXQtZmlsZVwiLGEpLGEuc2V0U3RhdHVzKGJ8fGguQ09NUExFVEUpLGEuc2tpcHBlZD0hMCxhLmJsb2NrcyYmZi5lYWNoKGEuYmxvY2tzLGZ1bmN0aW9uKGEsYil7dmFyIGM9Yi50cmFuc3BvcnQ7YyYmKGMuYWJvcnQoKSxjLmRlc3Ryb3koKSxkZWxldGUgYi50cmFuc3BvcnQpfSksdGhpcy5vd25lci50cmlnZ2VyKFwidXBsb2FkU2tpcFwiLGEpfSxfdGljazpmdW5jdGlvbigpe3ZhciBiLGMsZD10aGlzLGU9ZC5vcHRpb25zO3JldHVybiBkLl9wcm9taXNlP2QuX3Byb21pc2UuYWx3YXlzKGQuX190aWNrKTp2b2lkKGQucG9vbC5sZW5ndGg8ZS50aHJlYWRzJiYoYz1kLl9uZXh0QmxvY2soKSk/KGQuX3RyaWdnZWQ9ITEsYj1mdW5jdGlvbihiKXtkLl9wcm9taXNlPW51bGwsYiYmYi5maWxlJiZkLl9zdGFydFNlbmQoYiksYS5uZXh0VGljayhkLl9fdGljayl9LGQuX3Byb21pc2U9ZyhjKT9jLmFsd2F5cyhiKTpiKGMpKTpkLnJlbWFuaW5nfHxkLmdldFN0YXRzKCkubnVtT2ZRdWV1ZXx8KGQucnVuaW5nPSExLGQuX3RyaWdnZWR8fGEubmV4dFRpY2soZnVuY3Rpb24oKXtkLm93bmVyLnRyaWdnZXIoXCJ1cGxvYWRGaW5pc2hlZFwiKX0pLGQuX3RyaWdnZWQ9ITApKX0sX25leHRCbG9jazpmdW5jdGlvbigpe3ZhciBhLGIsYz10aGlzLGQ9Yy5fYWN0LGY9Yy5vcHRpb25zO3JldHVybiBkJiZkLmhhcygpJiZkLmZpbGUuZ2V0U3RhdHVzKCk9PT1oLlBST0dSRVNTPyhmLnByZXBhcmVOZXh0RmlsZSYmIWMucGVuZGluZy5sZW5ndGgmJmMuX3ByZXBhcmVOZXh0RmlsZSgpLGQuZmV0Y2goKSk6Yy5ydW5pbmc/KCFjLnBlbmRpbmcubGVuZ3RoJiZjLmdldFN0YXRzKCkubnVtT2ZRdWV1ZSYmYy5fcHJlcGFyZU5leHRGaWxlKCksYT1jLnBlbmRpbmcuc2hpZnQoKSxiPWZ1bmN0aW9uKGEpe3JldHVybiBhPyhkPWUoYSxmLmNodW5rZWQ/Zi5jaHVua1NpemU6MCksYy5fYWN0PWQsZC5mZXRjaCgpKTpudWxsfSxnKGEpP2FbYS5waXBlP1wicGlwZVwiOlwidGhlblwiXShiKTpiKGEpKTp2b2lkIDB9LF9wcmVwYXJlTmV4dEZpbGU6ZnVuY3Rpb24oKXt2YXIgYSxiPXRoaXMsYz1iLnJlcXVlc3QoXCJmZXRjaC1maWxlXCIpLGQ9Yi5wZW5kaW5nO2MmJihhPWIucmVxdWVzdChcImJlZm9yZS1zZW5kLWZpbGVcIixjLGZ1bmN0aW9uKCl7cmV0dXJuIGMuZ2V0U3RhdHVzKCk9PT1oLlFVRVVFRD8oYi5vd25lci50cmlnZ2VyKFwidXBsb2FkU3RhcnRcIixjKSxjLnNldFN0YXR1cyhoLlBST0dSRVNTKSxjKTpiLl9maW5pc2hGaWxlKGMpfSksYS5kb25lKGZ1bmN0aW9uKCl7dmFyIGI9Zi5pbkFycmF5KGEsZCk7fmImJmQuc3BsaWNlKGIsMSxjKX0pLGEuZmFpbChmdW5jdGlvbihhKXtjLnNldFN0YXR1cyhoLkVSUk9SLGEpLGIub3duZXIudHJpZ2dlcihcInVwbG9hZEVycm9yXCIsYyxhKSxiLm93bmVyLnRyaWdnZXIoXCJ1cGxvYWRDb21wbGV0ZVwiLGMpfSksZC5wdXNoKGEpKX0sX3BvcEJsb2NrOmZ1bmN0aW9uKGEpe3ZhciBiPWYuaW5BcnJheShhLHRoaXMucG9vbCk7dGhpcy5wb29sLnNwbGljZShiLDEpLGEuZmlsZS5yZW1hbmluZy0tLHRoaXMucmVtYW5pbmctLX0sX3N0YXJ0U2VuZDpmdW5jdGlvbihiKXt2YXIgYyxkPXRoaXMsZT1iLmZpbGU7ZC5wb29sLnB1c2goYiksZC5yZW1hbmluZysrLGIuYmxvYj0xPT09Yi5jaHVua3M/ZS5zb3VyY2U6ZS5zb3VyY2Uuc2xpY2UoYi5zdGFydCxiLmVuZCksYz1kLnJlcXVlc3QoXCJiZWZvcmUtc2VuZFwiLGIsZnVuY3Rpb24oKXtlLmdldFN0YXR1cygpPT09aC5QUk9HUkVTUz9kLl9kb1NlbmQoYik6KGQuX3BvcEJsb2NrKGIpLGEubmV4dFRpY2soZC5fX3RpY2spKX0pLGMuZmFpbChmdW5jdGlvbigpezE9PT1lLnJlbWFuaW5nP2QuX2ZpbmlzaEZpbGUoZSkuYWx3YXlzKGZ1bmN0aW9uKCl7Yi5wZXJjZW50YWdlPTEsZC5fcG9wQmxvY2soYiksZC5vd25lci50cmlnZ2VyKFwidXBsb2FkQ29tcGxldGVcIixlKSxhLm5leHRUaWNrKGQuX190aWNrKX0pOihiLnBlcmNlbnRhZ2U9MSxkLl9wb3BCbG9jayhiKSxhLm5leHRUaWNrKGQuX190aWNrKSl9KX0sX2RvU2VuZDpmdW5jdGlvbihiKXt2YXIgYyxlLGc9dGhpcyxpPWcub3duZXIsaj1nLm9wdGlvbnMsaz1iLmZpbGUsbD1uZXcgZChqKSxtPWYuZXh0ZW5kKHt9LGouZm9ybURhdGEpLG49Zi5leHRlbmQoe30sai5oZWFkZXJzKTtiLnRyYW5zcG9ydD1sLGwub24oXCJkZXN0cm95XCIsZnVuY3Rpb24oKXtkZWxldGUgYi50cmFuc3BvcnQsZy5fcG9wQmxvY2soYiksYS5uZXh0VGljayhnLl9fdGljayl9KSxsLm9uKFwicHJvZ3Jlc3NcIixmdW5jdGlvbihhKXt2YXIgYz0wLGQ9MDtjPWIucGVyY2VudGFnZT1hLGIuY2h1bmtzPjEmJihmLmVhY2goay5ibG9ja3MsZnVuY3Rpb24oYSxiKXtkKz0oYi5wZXJjZW50YWdlfHwwKSooYi5lbmQtYi5zdGFydCl9KSxjPWQvay5zaXplKSxpLnRyaWdnZXIoXCJ1cGxvYWRQcm9ncmVzc1wiLGssY3x8MCl9KSxjPWZ1bmN0aW9uKGEpe3ZhciBjO3JldHVybiBlPWwuZ2V0UmVzcG9uc2VBc0pzb24oKXx8e30sZS5fcmF3PWwuZ2V0UmVzcG9uc2UoKSxjPWZ1bmN0aW9uKGIpe2E9Yn0saS50cmlnZ2VyKFwidXBsb2FkQWNjZXB0XCIsYixlLGMpfHwoYT1hfHxcInNlcnZlclwiKSxhfSxsLm9uKFwiZXJyb3JcIixmdW5jdGlvbihhLGQpe2IucmV0cmllZD1iLnJldHJpZWR8fDAsYi5jaHVua3M+MSYmflwiaHR0cCxhYm9ydFwiLmluZGV4T2YoYSkmJmIucmV0cmllZDxqLmNodW5rUmV0cnk/KGIucmV0cmllZCsrLGwuc2VuZCgpKTooZHx8XCJzZXJ2ZXJcIiE9PWF8fChhPWMoYSkpLGsuc2V0U3RhdHVzKGguRVJST1IsYSksaS50cmlnZ2VyKFwidXBsb2FkRXJyb3JcIixrLGEpLGkudHJpZ2dlcihcInVwbG9hZENvbXBsZXRlXCIsaykpfSksbC5vbihcImxvYWRcIixmdW5jdGlvbigpe3ZhciBhO3JldHVybihhPWMoKSk/dm9pZCBsLnRyaWdnZXIoXCJlcnJvclwiLGEsITApOnZvaWQoMT09PWsucmVtYW5pbmc/Zy5fZmluaXNoRmlsZShrLGUpOmwuZGVzdHJveSgpKX0pLG09Zi5leHRlbmQobSx7aWQ6ay5pZCxuYW1lOmsubmFtZSx0eXBlOmsudHlwZSxsYXN0TW9kaWZpZWREYXRlOmsubGFzdE1vZGlmaWVkRGF0ZSxzaXplOmsuc2l6ZX0pLGIuY2h1bmtzPjEmJmYuZXh0ZW5kKG0se2NodW5rczpiLmNodW5rcyxjaHVuazpiLmNodW5rfSksaS50cmlnZ2VyKFwidXBsb2FkQmVmb3JlU2VuZFwiLGIsbSxuKSxsLmFwcGVuZEJsb2Ioai5maWxlVmFsLGIuYmxvYixrLm5hbWUpLGwuYXBwZW5kKG0pLGwuc2V0UmVxdWVzdEhlYWRlcihuKSxsLnNlbmQoKX0sX2ZpbmlzaEZpbGU6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPXRoaXMub3duZXI7cmV0dXJuIGQucmVxdWVzdChcImFmdGVyLXNlbmQtZmlsZVwiLGFyZ3VtZW50cyxmdW5jdGlvbigpe2Euc2V0U3RhdHVzKGguQ09NUExFVEUpLGQudHJpZ2dlcihcInVwbG9hZFN1Y2Nlc3NcIixhLGIsYyl9KS5mYWlsKGZ1bmN0aW9uKGIpe2EuZ2V0U3RhdHVzKCk9PT1oLlBST0dSRVNTJiZhLnNldFN0YXR1cyhoLkVSUk9SLGIpLGQudHJpZ2dlcihcInVwbG9hZEVycm9yXCIsYSxiKX0pLmFsd2F5cyhmdW5jdGlvbigpe2QudHJpZ2dlcihcInVwbG9hZENvbXBsZXRlXCIsYSl9KX19KX0pLGIoXCJ3aWRnZXRzL3ZhbGlkYXRvclwiLFtcImJhc2VcIixcInVwbG9hZGVyXCIsXCJmaWxlXCIsXCJ3aWRnZXRzL3dpZGdldFwiXSxmdW5jdGlvbihhLGIsYyl7dmFyIGQsZT1hLiQsZj17fTtyZXR1cm4gZD17YWRkVmFsaWRhdG9yOmZ1bmN0aW9uKGEsYil7ZlthXT1ifSxyZW1vdmVWYWxpZGF0b3I6ZnVuY3Rpb24oYSl7ZGVsZXRlIGZbYV19fSxiLnJlZ2lzdGVyKHtpbml0OmZ1bmN0aW9uKCl7dmFyIGE9dGhpcztlLmVhY2goZixmdW5jdGlvbigpe3RoaXMuY2FsbChhLm93bmVyKX0pfX0pLGQuYWRkVmFsaWRhdG9yKFwiZmlsZU51bUxpbWl0XCIsZnVuY3Rpb24oKXt2YXIgYT10aGlzLGI9YS5vcHRpb25zLGM9MCxkPWIuZmlsZU51bUxpbWl0Pj4wLGU9ITA7ZCYmKGEub24oXCJiZWZvcmVGaWxlUXVldWVkXCIsZnVuY3Rpb24oYSl7cmV0dXJuIGM+PWQmJmUmJihlPSExLHRoaXMudHJpZ2dlcihcImVycm9yXCIsXCJRX0VYQ0VFRF9OVU1fTElNSVRcIixkLGEpLHNldFRpbWVvdXQoZnVuY3Rpb24oKXtlPSEwfSwxKSksYz49ZD8hMTohMH0pLGEub24oXCJmaWxlUXVldWVkXCIsZnVuY3Rpb24oKXtjKyt9KSxhLm9uKFwiZmlsZURlcXVldWVkXCIsZnVuY3Rpb24oKXtjLS19KSxhLm9uKFwidXBsb2FkRmluaXNoZWRcIixmdW5jdGlvbigpe2M9MH0pKX0pLGQuYWRkVmFsaWRhdG9yKFwiZmlsZVNpemVMaW1pdFwiLGZ1bmN0aW9uKCl7dmFyIGE9dGhpcyxiPWEub3B0aW9ucyxjPTAsZD1iLmZpbGVTaXplTGltaXQ+PjAsZT0hMDtkJiYoYS5vbihcImJlZm9yZUZpbGVRdWV1ZWRcIixmdW5jdGlvbihhKXt2YXIgYj1jK2Euc2l6ZT5kO3JldHVybiBiJiZlJiYoZT0hMSx0aGlzLnRyaWdnZXIoXCJlcnJvclwiLFwiUV9FWENFRURfU0laRV9MSU1JVFwiLGQsYSksc2V0VGltZW91dChmdW5jdGlvbigpe2U9ITB9LDEpKSxiPyExOiEwfSksYS5vbihcImZpbGVRdWV1ZWRcIixmdW5jdGlvbihhKXtjKz1hLnNpemV9KSxhLm9uKFwiZmlsZURlcXVldWVkXCIsZnVuY3Rpb24oYSl7Yy09YS5zaXplfSksYS5vbihcInVwbG9hZEZpbmlzaGVkXCIsZnVuY3Rpb24oKXtjPTB9KSl9KSxkLmFkZFZhbGlkYXRvcihcImZpbGVTaW5nbGVTaXplTGltaXRcIixmdW5jdGlvbigpe3ZhciBhPXRoaXMsYj1hLm9wdGlvbnMsZD1iLmZpbGVTaW5nbGVTaXplTGltaXQ7ZCYmYS5vbihcImJlZm9yZUZpbGVRdWV1ZWRcIixmdW5jdGlvbihhKXtyZXR1cm4gYS5zaXplPmQ/KGEuc2V0U3RhdHVzKGMuU3RhdHVzLklOVkFMSUQsXCJleGNlZWRfc2l6ZVwiKSx0aGlzLnRyaWdnZXIoXCJlcnJvclwiLFwiRl9FWENFRURfU0laRVwiLGEpLCExKTp2b2lkIDB9KX0pLGQuYWRkVmFsaWRhdG9yKFwiZHVwbGljYXRlXCIsZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEpe2Zvcih2YXIgYixjPTAsZD0wLGU9YS5sZW5ndGg7ZT5kO2QrKyliPWEuY2hhckNvZGVBdChkKSxjPWIrKGM8PDYpKyhjPDwxNiktYztyZXR1cm4gY312YXIgYj10aGlzLGM9Yi5vcHRpb25zLGQ9e307Yy5kdXBsaWNhdGV8fChiLm9uKFwiYmVmb3JlRmlsZVF1ZXVlZFwiLGZ1bmN0aW9uKGIpe3ZhciBjPWIuX19oYXNofHwoYi5fX2hhc2g9YShiLm5hbWUrYi5zaXplK2IubGFzdE1vZGlmaWVkRGF0ZSkpO3JldHVybiBkW2NdPyh0aGlzLnRyaWdnZXIoXCJlcnJvclwiLFwiRl9EVVBMSUNBVEVcIixiKSwhMSk6dm9pZCAwfSksYi5vbihcImZpbGVRdWV1ZWRcIixmdW5jdGlvbihhKXt2YXIgYj1hLl9faGFzaDtiJiYoZFtiXT0hMCl9KSxiLm9uKFwiZmlsZURlcXVldWVkXCIsZnVuY3Rpb24oYSl7dmFyIGI9YS5fX2hhc2g7YiYmZGVsZXRlIGRbYl19KSl9KSxkfSksYihcInJ1bnRpbWUvY29tcGJhc2VcIixbXSxmdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiKXt0aGlzLm93bmVyPWEsdGhpcy5vcHRpb25zPWEub3B0aW9ucyx0aGlzLmdldFJ1bnRpbWU9ZnVuY3Rpb24oKXtyZXR1cm4gYn0sdGhpcy5nZXRSdWlkPWZ1bmN0aW9uKCl7cmV0dXJuIGIudWlkfSx0aGlzLnRyaWdnZXI9ZnVuY3Rpb24oKXtyZXR1cm4gYS50cmlnZ2VyLmFwcGx5KGEsYXJndW1lbnRzKX19cmV0dXJuIGF9KSxiKFwicnVudGltZS9odG1sNS9ydW50aW1lXCIsW1wiYmFzZVwiLFwicnVudGltZS9ydW50aW1lXCIsXCJydW50aW1lL2NvbXBiYXNlXCJdLGZ1bmN0aW9uKGIsYyxkKXtmdW5jdGlvbiBlKCl7dmFyIGE9e30sZD10aGlzLGU9dGhpcy5kZXN0b3J5O2MuYXBwbHkoZCxhcmd1bWVudHMpLGQudHlwZT1mLGQuZXhlYz1mdW5jdGlvbihjLGUpe3ZhciBmLGg9dGhpcyxpPWgudWlkLGo9Yi5zbGljZShhcmd1bWVudHMsMik7cmV0dXJuIGdbY10mJihmPWFbaV09YVtpXXx8bmV3IGdbY10oaCxkKSxmW2VdKT9mW2VdLmFwcGx5KGYsaik6dm9pZCAwfSxkLmRlc3Rvcnk9ZnVuY3Rpb24oKXtyZXR1cm4gZSYmZS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9fXZhciBmPVwiaHRtbDVcIixnPXt9O3JldHVybiBiLmluaGVyaXRzKGMse2NvbnN0cnVjdG9yOmUsaW5pdDpmdW5jdGlvbigpe3ZhciBhPXRoaXM7c2V0VGltZW91dChmdW5jdGlvbigpe2EudHJpZ2dlcihcInJlYWR5XCIpfSwxKX19KSxlLnJlZ2lzdGVyPWZ1bmN0aW9uKGEsYyl7dmFyIGU9Z1thXT1iLmluaGVyaXRzKGQsYyk7cmV0dXJuIGV9LGEuQmxvYiYmYS5GaWxlUmVhZGVyJiZhLkRhdGFWaWV3JiZjLmFkZFJ1bnRpbWUoZixlKSxlfSksYihcInJ1bnRpbWUvaHRtbDUvYmxvYlwiLFtcInJ1bnRpbWUvaHRtbDUvcnVudGltZVwiLFwibGliL2Jsb2JcIl0sZnVuY3Rpb24oYSxiKXtyZXR1cm4gYS5yZWdpc3RlcihcIkJsb2JcIix7c2xpY2U6ZnVuY3Rpb24oYSxjKXt2YXIgZD10aGlzLm93bmVyLnNvdXJjZSxlPWQuc2xpY2V8fGQud2Via2l0U2xpY2V8fGQubW96U2xpY2U7cmV0dXJuIGQ9ZS5jYWxsKGQsYSxjKSxuZXcgYih0aGlzLmdldFJ1aWQoKSxkKX19KX0pLGIoXCJydW50aW1lL2h0bWw1L2RuZFwiLFtcImJhc2VcIixcInJ1bnRpbWUvaHRtbDUvcnVudGltZVwiLFwibGliL2ZpbGVcIl0sZnVuY3Rpb24oYSxiLGMpe3ZhciBkPWEuJCxlPVwid2VidXBsb2FkZXItZG5kLVwiO3JldHVybiBiLnJlZ2lzdGVyKFwiRHJhZ0FuZERyb3BcIix7aW5pdDpmdW5jdGlvbigpe3ZhciBiPXRoaXMuZWxlbT10aGlzLm9wdGlvbnMuY29udGFpbmVyO3RoaXMuZHJhZ0VudGVySGFuZGxlcj1hLmJpbmRGbih0aGlzLl9kcmFnRW50ZXJIYW5kbGVyLHRoaXMpLHRoaXMuZHJhZ092ZXJIYW5kbGVyPWEuYmluZEZuKHRoaXMuX2RyYWdPdmVySGFuZGxlcix0aGlzKSx0aGlzLmRyYWdMZWF2ZUhhbmRsZXI9YS5iaW5kRm4odGhpcy5fZHJhZ0xlYXZlSGFuZGxlcix0aGlzKSx0aGlzLmRyb3BIYW5kbGVyPWEuYmluZEZuKHRoaXMuX2Ryb3BIYW5kbGVyLHRoaXMpLHRoaXMuZG5kT3Zlcj0hMSxiLm9uKFwiZHJhZ2VudGVyXCIsdGhpcy5kcmFnRW50ZXJIYW5kbGVyKSxiLm9uKFwiZHJhZ292ZXJcIix0aGlzLmRyYWdPdmVySGFuZGxlciksYi5vbihcImRyYWdsZWF2ZVwiLHRoaXMuZHJhZ0xlYXZlSGFuZGxlciksYi5vbihcImRyb3BcIix0aGlzLmRyb3BIYW5kbGVyKSx0aGlzLm9wdGlvbnMuZGlzYWJsZUdsb2JhbERuZCYmKGQoZG9jdW1lbnQpLm9uKFwiZHJhZ292ZXJcIix0aGlzLmRyYWdPdmVySGFuZGxlciksZChkb2N1bWVudCkub24oXCJkcm9wXCIsdGhpcy5kcm9wSGFuZGxlcikpXG59LF9kcmFnRW50ZXJIYW5kbGVyOmZ1bmN0aW9uKGEpe3ZhciBiLGM9dGhpcyxkPWMuX2RlbmllZHx8ITE7cmV0dXJuIGE9YS5vcmlnaW5hbEV2ZW50fHxhLGMuZG5kT3Zlcnx8KGMuZG5kT3Zlcj0hMCxiPWEuZGF0YVRyYW5zZmVyLml0ZW1zLGImJmIubGVuZ3RoJiYoYy5fZGVuaWVkPWQ9IWMudHJpZ2dlcihcImFjY2VwdFwiLGIpKSxjLmVsZW0uYWRkQ2xhc3MoZStcIm92ZXJcIiksYy5lbGVtW2Q/XCJhZGRDbGFzc1wiOlwicmVtb3ZlQ2xhc3NcIl0oZStcImRlbmllZFwiKSksYS5kYXRhVHJhbnNmZXIuZHJvcEVmZmVjdD1kP1wibm9uZVwiOlwiY29weVwiLCExfSxfZHJhZ092ZXJIYW5kbGVyOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuZWxlbS5wYXJlbnQoKS5nZXQoMCk7cmV0dXJuIGImJiFkLmNvbnRhaW5zKGIsYS5jdXJyZW50VGFyZ2V0KT8hMTooY2xlYXJUaW1lb3V0KHRoaXMuX2xlYXZlVGltZXIpLHRoaXMuX2RyYWdFbnRlckhhbmRsZXIuY2FsbCh0aGlzLGEpLCExKX0sX2RyYWdMZWF2ZUhhbmRsZXI6ZnVuY3Rpb24oKXt2YXIgYSxiPXRoaXM7cmV0dXJuIGE9ZnVuY3Rpb24oKXtiLmRuZE92ZXI9ITEsYi5lbGVtLnJlbW92ZUNsYXNzKGUrXCJvdmVyIFwiK2UrXCJkZW5pZWRcIil9LGNsZWFyVGltZW91dChiLl9sZWF2ZVRpbWVyKSxiLl9sZWF2ZVRpbWVyPXNldFRpbWVvdXQoYSwxMDApLCExfSxfZHJvcEhhbmRsZXI6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcyxmPWIuZ2V0UnVpZCgpLGc9Yi5lbGVtLnBhcmVudCgpLmdldCgwKTtyZXR1cm4gZyYmIWQuY29udGFpbnMoZyxhLmN1cnJlbnRUYXJnZXQpPyExOihiLl9nZXRUYW5zZmVyRmlsZXMoYSxmdW5jdGlvbihhKXtiLnRyaWdnZXIoXCJkcm9wXCIsZC5tYXAoYSxmdW5jdGlvbihhKXtyZXR1cm4gbmV3IGMoZixhKX0pKX0pLGIuZG5kT3Zlcj0hMSxiLmVsZW0ucmVtb3ZlQ2xhc3MoZStcIm92ZXJcIiksITEpfSxfZ2V0VGFuc2ZlckZpbGVzOmZ1bmN0aW9uKGIsYyl7dmFyIGQsZSxmLGcsaCxpLGosayxsPVtdLG09W107Zm9yKGI9Yi5vcmlnaW5hbEV2ZW50fHxiLGY9Yi5kYXRhVHJhbnNmZXIsZD1mLml0ZW1zLGU9Zi5maWxlcyxrPSEoIWR8fCFkWzBdLndlYmtpdEdldEFzRW50cnkpLGk9MCxqPWUubGVuZ3RoO2o+aTtpKyspZz1lW2ldLGg9ZCYmZFtpXSxrJiZoLndlYmtpdEdldEFzRW50cnkoKS5pc0RpcmVjdG9yeT9tLnB1c2godGhpcy5fdHJhdmVyc2VEaXJlY3RvcnlUcmVlKGgud2Via2l0R2V0QXNFbnRyeSgpLGwpKTpsLnB1c2goZyk7YS53aGVuLmFwcGx5KGEsbSkuZG9uZShmdW5jdGlvbigpe2wubGVuZ3RoJiZjKGwpfSl9LF90cmF2ZXJzZURpcmVjdG9yeVRyZWU6ZnVuY3Rpb24oYixjKXt2YXIgZD1hLkRlZmVycmVkKCksZT10aGlzO3JldHVybiBiLmlzRmlsZT9iLmZpbGUoZnVuY3Rpb24oYSl7Yy5wdXNoKGEpLGQucmVzb2x2ZSgpfSk6Yi5pc0RpcmVjdG9yeSYmYi5jcmVhdGVSZWFkZXIoKS5yZWFkRW50cmllcyhmdW5jdGlvbihiKXt2YXIgZixnPWIubGVuZ3RoLGg9W10saT1bXTtmb3IoZj0wO2c+ZjtmKyspaC5wdXNoKGUuX3RyYXZlcnNlRGlyZWN0b3J5VHJlZShiW2ZdLGkpKTthLndoZW4uYXBwbHkoYSxoKS50aGVuKGZ1bmN0aW9uKCl7Yy5wdXNoLmFwcGx5KGMsaSksZC5yZXNvbHZlKCl9LGQucmVqZWN0KX0pLGQucHJvbWlzZSgpfSxkZXN0cm95OmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5lbGVtO2Eub2ZmKFwiZHJhZ2VudGVyXCIsdGhpcy5kcmFnRW50ZXJIYW5kbGVyKSxhLm9mZihcImRyYWdvdmVyXCIsdGhpcy5kcmFnRW50ZXJIYW5kbGVyKSxhLm9mZihcImRyYWdsZWF2ZVwiLHRoaXMuZHJhZ0xlYXZlSGFuZGxlciksYS5vZmYoXCJkcm9wXCIsdGhpcy5kcm9wSGFuZGxlciksdGhpcy5vcHRpb25zLmRpc2FibGVHbG9iYWxEbmQmJihkKGRvY3VtZW50KS5vZmYoXCJkcmFnb3ZlclwiLHRoaXMuZHJhZ092ZXJIYW5kbGVyKSxkKGRvY3VtZW50KS5vZmYoXCJkcm9wXCIsdGhpcy5kcm9wSGFuZGxlcikpfX0pfSksYihcInJ1bnRpbWUvaHRtbDUvZmlsZXBhc3RlXCIsW1wiYmFzZVwiLFwicnVudGltZS9odG1sNS9ydW50aW1lXCIsXCJsaWIvZmlsZVwiXSxmdW5jdGlvbihhLGIsYyl7cmV0dXJuIGIucmVnaXN0ZXIoXCJGaWxlUGFzdGVcIix7aW5pdDpmdW5jdGlvbigpe3ZhciBiLGMsZCxlLGY9dGhpcy5vcHRpb25zLGc9dGhpcy5lbGVtPWYuY29udGFpbmVyLGg9XCIuKlwiO2lmKGYuYWNjZXB0KXtmb3IoYj1bXSxjPTAsZD1mLmFjY2VwdC5sZW5ndGg7ZD5jO2MrKyllPWYuYWNjZXB0W2NdLm1pbWVUeXBlcyxlJiZiLnB1c2goZSk7Yi5sZW5ndGgmJihoPWIuam9pbihcIixcIiksaD1oLnJlcGxhY2UoLywvZyxcInxcIikucmVwbGFjZSgvXFwqL2csXCIuKlwiKSl9dGhpcy5hY2NlcHQ9aD1uZXcgUmVnRXhwKGgsXCJpXCIpLHRoaXMuaGFuZGVyPWEuYmluZEZuKHRoaXMuX3Bhc3RlSGFuZGVyLHRoaXMpLGcub24oXCJwYXN0ZVwiLHRoaXMuaGFuZGVyKX0sX3Bhc3RlSGFuZGVyOmZ1bmN0aW9uKGEpe3ZhciBiLGQsZSxmLGcsaD1bXSxpPXRoaXMuZ2V0UnVpZCgpO2ZvcihhPWEub3JpZ2luYWxFdmVudHx8YSxiPWEuY2xpcGJvYXJkRGF0YS5pdGVtcyxmPTAsZz1iLmxlbmd0aDtnPmY7ZisrKWQ9YltmXSxcImZpbGVcIj09PWQua2luZCYmKGU9ZC5nZXRBc0ZpbGUoKSkmJmgucHVzaChuZXcgYyhpLGUpKTtoLmxlbmd0aCYmKGEucHJldmVudERlZmF1bHQoKSxhLnN0b3BQcm9wYWdhdGlvbigpLHRoaXMudHJpZ2dlcihcInBhc3RlXCIsaCkpfSxkZXN0cm95OmZ1bmN0aW9uKCl7dGhpcy5lbGVtLm9mZihcInBhc3RlXCIsdGhpcy5oYW5kZXIpfX0pfSksYihcInJ1bnRpbWUvaHRtbDUvZmlsZXBpY2tlclwiLFtcImJhc2VcIixcInJ1bnRpbWUvaHRtbDUvcnVudGltZVwiXSxmdW5jdGlvbihhLGIpe3ZhciBjPWEuJDtyZXR1cm4gYi5yZWdpc3RlcihcIkZpbGVQaWNrZXJcIix7aW5pdDpmdW5jdGlvbigpe3ZhciBhLGIsZCxlLGY9dGhpcy5nZXRSdW50aW1lKCkuZ2V0Q29udGFpbmVyKCksZz10aGlzLGg9Zy5vd25lcixpPWcub3B0aW9ucyxqPWMoZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImxhYmVsXCIpKSxrPWMoZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImlucHV0XCIpKTtpZihrLmF0dHIoXCJ0eXBlXCIsXCJmaWxlXCIpLGsuYXR0cihcIm5hbWVcIixpLm5hbWUpLGsuYWRkQ2xhc3MoXCJ3ZWJ1cGxvYWRlci1lbGVtZW50LWludmlzaWJsZVwiKSxqLm9uKFwiY2xpY2tcIixmdW5jdGlvbigpe2sudHJpZ2dlcihcImNsaWNrXCIpfSksai5jc3Moe29wYWNpdHk6MCx3aWR0aDpcIjEwMCVcIixoZWlnaHQ6XCIxMDAlXCIsZGlzcGxheTpcImJsb2NrXCIsY3Vyc29yOlwicG9pbnRlclwiLGJhY2tncm91bmQ6XCIjZmZmZmZmXCJ9KSxpLm11bHRpcGxlJiZrLmF0dHIoXCJtdWx0aXBsZVwiLFwibXVsdGlwbGVcIiksaS5hY2NlcHQmJmkuYWNjZXB0Lmxlbmd0aD4wKXtmb3IoYT1bXSxiPTAsZD1pLmFjY2VwdC5sZW5ndGg7ZD5iO2IrKylhLnB1c2goaS5hY2NlcHRbYl0ubWltZVR5cGVzKTtrLmF0dHIoXCJhY2NlcHRcIixhLmpvaW4oXCIsXCIpKX1mLmFwcGVuZChrKSxmLmFwcGVuZChqKSxlPWZ1bmN0aW9uKGEpe2gudHJpZ2dlcihhLnR5cGUpfSxrLm9uKFwiY2hhbmdlXCIsZnVuY3Rpb24oYSl7dmFyIGIsZD1hcmd1bWVudHMuY2FsbGVlO2cuZmlsZXM9YS50YXJnZXQuZmlsZXMsYj10aGlzLmNsb25lTm9kZSghMCksdGhpcy5wYXJlbnROb2RlLnJlcGxhY2VDaGlsZChiLHRoaXMpLGsub2ZmKCksaz1jKGIpLm9uKFwiY2hhbmdlXCIsZCkub24oXCJtb3VzZWVudGVyIG1vdXNlbGVhdmVcIixlKSxoLnRyaWdnZXIoXCJjaGFuZ2VcIil9KSxqLm9uKFwibW91c2VlbnRlciBtb3VzZWxlYXZlXCIsZSl9LGdldEZpbGVzOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZmlsZXN9LGRlc3Ryb3k6ZnVuY3Rpb24oKXt9fSl9KSxiKFwicnVudGltZS9odG1sNS91dGlsXCIsW1wiYmFzZVwiXSxmdW5jdGlvbihiKXt2YXIgYz1hLmNyZWF0ZU9iamVjdFVSTCYmYXx8YS5VUkwmJlVSTC5yZXZva2VPYmplY3RVUkwmJlVSTHx8YS53ZWJraXRVUkwsZD1iLm5vb3AsZT1kO3JldHVybiBjJiYoZD1mdW5jdGlvbigpe3JldHVybiBjLmNyZWF0ZU9iamVjdFVSTC5hcHBseShjLGFyZ3VtZW50cyl9LGU9ZnVuY3Rpb24oKXtyZXR1cm4gYy5yZXZva2VPYmplY3RVUkwuYXBwbHkoYyxhcmd1bWVudHMpfSkse2NyZWF0ZU9iamVjdFVSTDpkLHJldm9rZU9iamVjdFVSTDplLGRhdGFVUkwyQmxvYjpmdW5jdGlvbihhKXt2YXIgYixjLGQsZSxmLGc7Zm9yKGc9YS5zcGxpdChcIixcIiksYj1+Z1swXS5pbmRleE9mKFwiYmFzZTY0XCIpP2F0b2IoZ1sxXSk6ZGVjb2RlVVJJQ29tcG9uZW50KGdbMV0pLGQ9bmV3IEFycmF5QnVmZmVyKGIubGVuZ3RoKSxjPW5ldyBVaW50OEFycmF5KGQpLGU9MDtlPGIubGVuZ3RoO2UrKyljW2VdPWIuY2hhckNvZGVBdChlKTtyZXR1cm4gZj1nWzBdLnNwbGl0KFwiOlwiKVsxXS5zcGxpdChcIjtcIilbMF0sdGhpcy5hcnJheUJ1ZmZlclRvQmxvYihkLGYpfSxkYXRhVVJMMkFycmF5QnVmZmVyOmZ1bmN0aW9uKGEpe3ZhciBiLGMsZCxlO2ZvcihlPWEuc3BsaXQoXCIsXCIpLGI9fmVbMF0uaW5kZXhPZihcImJhc2U2NFwiKT9hdG9iKGVbMV0pOmRlY29kZVVSSUNvbXBvbmVudChlWzFdKSxjPW5ldyBVaW50OEFycmF5KGIubGVuZ3RoKSxkPTA7ZDxiLmxlbmd0aDtkKyspY1tkXT1iLmNoYXJDb2RlQXQoZCk7cmV0dXJuIGMuYnVmZmVyfSxhcnJheUJ1ZmZlclRvQmxvYjpmdW5jdGlvbihiLGMpe3ZhciBkLGU9YS5CbG9iQnVpbGRlcnx8YS5XZWJLaXRCbG9iQnVpbGRlcjtyZXR1cm4gZT8oZD1uZXcgZSxkLmFwcGVuZChiKSxkLmdldEJsb2IoYykpOm5ldyBCbG9iKFtiXSxjP3t0eXBlOmN9Ont9KX0sY2FudmFzVG9EYXRhVXJsOmZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gYS50b0RhdGFVUkwoYixjLzEwMCl9LHBhcnNlTWV0YTpmdW5jdGlvbihhLGIpe2IoITEse30pfSx1cGRhdGVJbWFnZUhlYWQ6ZnVuY3Rpb24oYSl7cmV0dXJuIGF9fX0pLGIoXCJydW50aW1lL2h0bWw1L2ltYWdlbWV0YVwiLFtcInJ1bnRpbWUvaHRtbDUvdXRpbFwiXSxmdW5jdGlvbihhKXt2YXIgYjtyZXR1cm4gYj17cGFyc2Vyczp7NjU1MDU6W119LG1heE1ldGFEYXRhU2l6ZToyNjIxNDQscGFyc2U6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLGQ9bmV3IEZpbGVSZWFkZXI7ZC5vbmxvYWQ9ZnVuY3Rpb24oKXtiKCExLGMuX3BhcnNlKHRoaXMucmVzdWx0KSksZD1kLm9ubG9hZD1kLm9uZXJyb3I9bnVsbH0sZC5vbmVycm9yPWZ1bmN0aW9uKGEpe2IoYS5tZXNzYWdlKSxkPWQub25sb2FkPWQub25lcnJvcj1udWxsfSxhPWEuc2xpY2UoMCxjLm1heE1ldGFEYXRhU2l6ZSksZC5yZWFkQXNBcnJheUJ1ZmZlcihhLmdldFNvdXJjZSgpKX0sX3BhcnNlOmZ1bmN0aW9uKGEsYyl7aWYoIShhLmJ5dGVMZW5ndGg8Nikpe3ZhciBkLGUsZixnLGg9bmV3IERhdGFWaWV3KGEpLGk9MixqPWguYnl0ZUxlbmd0aC00LGs9aSxsPXt9O2lmKDY1NDk2PT09aC5nZXRVaW50MTYoMCkpe2Zvcig7aj5pJiYoZD1oLmdldFVpbnQxNihpKSxkPj02NTUwNCYmNjU1MTk+PWR8fDY1NTM0PT09ZCkmJihlPWguZ2V0VWludDE2KGkrMikrMiwhKGkrZT5oLmJ5dGVMZW5ndGgpKTspe2lmKGY9Yi5wYXJzZXJzW2RdLCFjJiZmKWZvcihnPTA7ZzxmLmxlbmd0aDtnKz0xKWZbZ10uY2FsbChiLGgsaSxlLGwpO2krPWUsaz1pfWs+NiYmKGwuaW1hZ2VIZWFkPWEuc2xpY2U/YS5zbGljZSgyLGspOm5ldyBVaW50OEFycmF5KGEpLnN1YmFycmF5KDIsaykpfXJldHVybiBsfX0sdXBkYXRlSW1hZ2VIZWFkOmZ1bmN0aW9uKGEsYil7dmFyIGMsZCxlLGY9dGhpcy5fcGFyc2UoYSwhMCk7cmV0dXJuIGU9MixmLmltYWdlSGVhZCYmKGU9MitmLmltYWdlSGVhZC5ieXRlTGVuZ3RoKSxkPWEuc2xpY2U/YS5zbGljZShlKTpuZXcgVWludDhBcnJheShhKS5zdWJhcnJheShlKSxjPW5ldyBVaW50OEFycmF5KGIuYnl0ZUxlbmd0aCsyK2QuYnl0ZUxlbmd0aCksY1swXT0yNTUsY1sxXT0yMTYsYy5zZXQobmV3IFVpbnQ4QXJyYXkoYiksMiksYy5zZXQobmV3IFVpbnQ4QXJyYXkoZCksYi5ieXRlTGVuZ3RoKzIpLGMuYnVmZmVyfX0sYS5wYXJzZU1ldGE9ZnVuY3Rpb24oKXtyZXR1cm4gYi5wYXJzZS5hcHBseShiLGFyZ3VtZW50cyl9LGEudXBkYXRlSW1hZ2VIZWFkPWZ1bmN0aW9uKCl7cmV0dXJuIGIudXBkYXRlSW1hZ2VIZWFkLmFwcGx5KGIsYXJndW1lbnRzKX0sYn0pLGIoXCJydW50aW1lL2h0bWw1L2ltYWdlbWV0YS9leGlmXCIsW1wiYmFzZVwiLFwicnVudGltZS9odG1sNS9pbWFnZW1ldGFcIl0sZnVuY3Rpb24oYSxiKXt2YXIgYz17fTtyZXR1cm4gYy5FeGlmTWFwPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9LGMuRXhpZk1hcC5wcm90b3R5cGUubWFwPXtPcmllbnRhdGlvbjoyNzR9LGMuRXhpZk1hcC5wcm90b3R5cGUuZ2V0PWZ1bmN0aW9uKGEpe3JldHVybiB0aGlzW2FdfHx0aGlzW3RoaXMubWFwW2FdXX0sYy5leGlmVGFnVHlwZXM9ezE6e2dldFZhbHVlOmZ1bmN0aW9uKGEsYil7cmV0dXJuIGEuZ2V0VWludDgoYil9LHNpemU6MX0sMjp7Z2V0VmFsdWU6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gU3RyaW5nLmZyb21DaGFyQ29kZShhLmdldFVpbnQ4KGIpKX0sc2l6ZToxLGFzY2lpOiEwfSwzOntnZXRWYWx1ZTpmdW5jdGlvbihhLGIsYyl7cmV0dXJuIGEuZ2V0VWludDE2KGIsYyl9LHNpemU6Mn0sNDp7Z2V0VmFsdWU6ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBhLmdldFVpbnQzMihiLGMpfSxzaXplOjR9LDU6e2dldFZhbHVlOmZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gYS5nZXRVaW50MzIoYixjKS9hLmdldFVpbnQzMihiKzQsYyl9LHNpemU6OH0sOTp7Z2V0VmFsdWU6ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBhLmdldEludDMyKGIsYyl9LHNpemU6NH0sMTA6e2dldFZhbHVlOmZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gYS5nZXRJbnQzMihiLGMpL2EuZ2V0SW50MzIoYis0LGMpfSxzaXplOjh9fSxjLmV4aWZUYWdUeXBlc1s3XT1jLmV4aWZUYWdUeXBlc1sxXSxjLmdldEV4aWZWYWx1ZT1mdW5jdGlvbihiLGQsZSxmLGcsaCl7dmFyIGksaixrLGwsbSxuLG89Yy5leGlmVGFnVHlwZXNbZl07aWYoIW8pcmV0dXJuIHZvaWQgYS5sb2coXCJJbnZhbGlkIEV4aWYgZGF0YTogSW52YWxpZCB0YWcgdHlwZS5cIik7aWYoaT1vLnNpemUqZyxqPWk+ND9kK2IuZ2V0VWludDMyKGUrOCxoKTplKzgsaitpPmIuYnl0ZUxlbmd0aClyZXR1cm4gdm9pZCBhLmxvZyhcIkludmFsaWQgRXhpZiBkYXRhOiBJbnZhbGlkIGRhdGEgb2Zmc2V0LlwiKTtpZigxPT09ZylyZXR1cm4gby5nZXRWYWx1ZShiLGosaCk7Zm9yKGs9W10sbD0wO2c+bDtsKz0xKWtbbF09by5nZXRWYWx1ZShiLGorbCpvLnNpemUsaCk7aWYoby5hc2NpaSl7Zm9yKG09XCJcIixsPTA7bDxrLmxlbmd0aCYmKG49a1tsXSxcIlxceDAwXCIhPT1uKTtsKz0xKW0rPW47cmV0dXJuIG19cmV0dXJuIGt9LGMucGFyc2VFeGlmVGFnPWZ1bmN0aW9uKGEsYixkLGUsZil7dmFyIGc9YS5nZXRVaW50MTYoZCxlKTtmLmV4aWZbZ109Yy5nZXRFeGlmVmFsdWUoYSxiLGQsYS5nZXRVaW50MTYoZCsyLGUpLGEuZ2V0VWludDMyKGQrNCxlKSxlKX0sYy5wYXJzZUV4aWZUYWdzPWZ1bmN0aW9uKGIsYyxkLGUsZil7dmFyIGcsaCxpO2lmKGQrNj5iLmJ5dGVMZW5ndGgpcmV0dXJuIHZvaWQgYS5sb2coXCJJbnZhbGlkIEV4aWYgZGF0YTogSW52YWxpZCBkaXJlY3Rvcnkgb2Zmc2V0LlwiKTtpZihnPWIuZ2V0VWludDE2KGQsZSksaD1kKzIrMTIqZyxoKzQ+Yi5ieXRlTGVuZ3RoKXJldHVybiB2b2lkIGEubG9nKFwiSW52YWxpZCBFeGlmIGRhdGE6IEludmFsaWQgZGlyZWN0b3J5IHNpemUuXCIpO2ZvcihpPTA7Zz5pO2krPTEpdGhpcy5wYXJzZUV4aWZUYWcoYixjLGQrMisxMippLGUsZik7cmV0dXJuIGIuZ2V0VWludDMyKGgsZSl9LGMucGFyc2VFeGlmRGF0YT1mdW5jdGlvbihiLGQsZSxmKXt2YXIgZyxoLGk9ZCsxMDtpZigxMTY1NTE5MjA2PT09Yi5nZXRVaW50MzIoZCs0KSl7aWYoaSs4PmIuYnl0ZUxlbmd0aClyZXR1cm4gdm9pZCBhLmxvZyhcIkludmFsaWQgRXhpZiBkYXRhOiBJbnZhbGlkIHNlZ21lbnQgc2l6ZS5cIik7aWYoMCE9PWIuZ2V0VWludDE2KGQrOCkpcmV0dXJuIHZvaWQgYS5sb2coXCJJbnZhbGlkIEV4aWYgZGF0YTogTWlzc2luZyBieXRlIGFsaWdubWVudCBvZmZzZXQuXCIpO3N3aXRjaChiLmdldFVpbnQxNihpKSl7Y2FzZSAxODc2MTpnPSEwO2JyZWFrO2Nhc2UgMTk3ODk6Zz0hMTticmVhaztkZWZhdWx0OnJldHVybiB2b2lkIGEubG9nKFwiSW52YWxpZCBFeGlmIGRhdGE6IEludmFsaWQgYnl0ZSBhbGlnbm1lbnQgbWFya2VyLlwiKX1pZig0MiE9PWIuZ2V0VWludDE2KGkrMixnKSlyZXR1cm4gdm9pZCBhLmxvZyhcIkludmFsaWQgRXhpZiBkYXRhOiBNaXNzaW5nIFRJRkYgbWFya2VyLlwiKTtoPWIuZ2V0VWludDMyKGkrNCxnKSxmLmV4aWY9bmV3IGMuRXhpZk1hcCxoPWMucGFyc2VFeGlmVGFncyhiLGksaStoLGcsZil9fSxiLnBhcnNlcnNbNjU1MDVdLnB1c2goYy5wYXJzZUV4aWZEYXRhKSxjfSksYihcInJ1bnRpbWUvaHRtbDUvaW1hZ2VcIixbXCJiYXNlXCIsXCJydW50aW1lL2h0bWw1L3J1bnRpbWVcIixcInJ1bnRpbWUvaHRtbDUvdXRpbFwiXSxmdW5jdGlvbihhLGIsYyl7dmFyIGQ9XCJkYXRhOmltYWdlL2dpZjtiYXNlNjQsUjBsR09EbGhBUUFCQUFEL0FDd0FBQUFBQVFBQkFBQUNBRHMlM0RcIjtyZXR1cm4gYi5yZWdpc3RlcihcIkltYWdlXCIse21vZGlmaWVkOiExLGluaXQ6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLGI9bmV3IEltYWdlO2Iub25sb2FkPWZ1bmN0aW9uKCl7YS5faW5mbz17dHlwZTphLnR5cGUsd2lkdGg6dGhpcy53aWR0aCxoZWlnaHQ6dGhpcy5oZWlnaHR9LGEuX21ldGFzfHxcImltYWdlL2pwZWdcIiE9PWEudHlwZT9hLm93bmVyLnRyaWdnZXIoXCJsb2FkXCIpOmMucGFyc2VNZXRhKGEuX2Jsb2IsZnVuY3Rpb24oYixjKXthLl9tZXRhcz1jLGEub3duZXIudHJpZ2dlcihcImxvYWRcIil9KX0sYi5vbmVycm9yPWZ1bmN0aW9uKCl7YS5vd25lci50cmlnZ2VyKFwiZXJyb3JcIil9LGEuX2ltZz1ifSxsb2FkRnJvbUJsb2I6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcyxkPWIuX2ltZztiLl9ibG9iPWEsYi50eXBlPWEudHlwZSxkLnNyYz1jLmNyZWF0ZU9iamVjdFVSTChhLmdldFNvdXJjZSgpKSxiLm93bmVyLm9uY2UoXCJsb2FkXCIsZnVuY3Rpb24oKXtjLnJldm9rZU9iamVjdFVSTChkLnNyYyl9KX0scmVzaXplOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5fY2FudmFzfHwodGhpcy5fY2FudmFzPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJjYW52YXNcIikpO3RoaXMuX3Jlc2l6ZSh0aGlzLl9pbWcsYyxhLGIpLHRoaXMuX2Jsb2I9bnVsbCx0aGlzLm1vZGlmaWVkPSEwLHRoaXMub3duZXIudHJpZ2dlcihcImNvbXBsZXRlXCIpfSxnZXRBc0Jsb2I6ZnVuY3Rpb24oYSl7dmFyIGIsZD10aGlzLl9ibG9iLGU9dGhpcy5vcHRpb25zO2lmKGE9YXx8dGhpcy50eXBlLHRoaXMubW9kaWZpZWR8fHRoaXMudHlwZSE9PWEpe2lmKGI9dGhpcy5fY2FudmFzLFwiaW1hZ2UvanBlZ1wiPT09YSl7aWYoZD1jLmNhbnZhc1RvRGF0YVVybChiLFwiaW1hZ2UvanBlZ1wiLGUucXVhbGl0eSksZS5wcmVzZXJ2ZUhlYWRlcnMmJnRoaXMuX21ldGFzJiZ0aGlzLl9tZXRhcy5pbWFnZUhlYWQpcmV0dXJuIGQ9Yy5kYXRhVVJMMkFycmF5QnVmZmVyKGQpLGQ9Yy51cGRhdGVJbWFnZUhlYWQoZCx0aGlzLl9tZXRhcy5pbWFnZUhlYWQpLGQ9Yy5hcnJheUJ1ZmZlclRvQmxvYihkLGEpfWVsc2UgZD1jLmNhbnZhc1RvRGF0YVVybChiLGEpO2Q9Yy5kYXRhVVJMMkJsb2IoZCl9cmV0dXJuIGR9LGdldEFzRGF0YVVybDpmdW5jdGlvbihhKXt2YXIgYj10aGlzLm9wdGlvbnM7cmV0dXJuIGE9YXx8dGhpcy50eXBlLFwiaW1hZ2UvanBlZ1wiPT09YT9jLmNhbnZhc1RvRGF0YVVybCh0aGlzLl9jYW52YXMsYSxiLnF1YWxpdHkpOnRoaXMuX2NhbnZhcy50b0RhdGFVUkwoYSl9LGdldE9yaWVudGF0aW9uOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX21ldGFzJiZ0aGlzLl9tZXRhcy5leGlmJiZ0aGlzLl9tZXRhcy5leGlmLmdldChcIk9yaWVudGF0aW9uXCIpfHwxfSxpbmZvOmZ1bmN0aW9uKGEpe3JldHVybiBhPyh0aGlzLl9pbmZvPWEsdGhpcyk6dGhpcy5faW5mb30sbWV0YTpmdW5jdGlvbihhKXtyZXR1cm4gYT8odGhpcy5fbWV0YT1hLHRoaXMpOnRoaXMuX21ldGF9LGRlc3Ryb3k6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLl9jYW52YXM7dGhpcy5faW1nLm9ubG9hZD1udWxsLGEmJihhLmdldENvbnRleHQoXCIyZFwiKS5jbGVhclJlY3QoMCwwLGEud2lkdGgsYS5oZWlnaHQpLGEud2lkdGg9YS5oZWlnaHQ9MCx0aGlzLl9jYW52YXM9bnVsbCksdGhpcy5faW1nLnNyYz1kLHRoaXMuX2ltZz10aGlzLl9ibG9iPW51bGx9LF9yZXNpemU6ZnVuY3Rpb24oYSxiLGMsZCl7dmFyIGUsZixnLGgsaSxqPXRoaXMub3B0aW9ucyxrPWEud2lkdGgsbD1hLmhlaWdodCxtPXRoaXMuZ2V0T3JpZW50YXRpb24oKTt+WzUsNiw3LDhdLmluZGV4T2YobSkmJihjXj1kLGRePWMsY149ZCksZT1NYXRoW2ouY3JvcD9cIm1heFwiOlwibWluXCJdKGMvayxkL2wpLGouYWxsb3dNYWduaWZ5fHwoZT1NYXRoLm1pbigxLGUpKSxmPWsqZSxnPWwqZSxqLmNyb3A/KGIud2lkdGg9YyxiLmhlaWdodD1kKTooYi53aWR0aD1mLGIuaGVpZ2h0PWcpLGg9KGIud2lkdGgtZikvMixpPShiLmhlaWdodC1nKS8yLGoucHJlc2VydmVIZWFkZXJzfHx0aGlzLl9yb3RhdGUyT3JpZW50YWlvbihiLG0pLHRoaXMuX3JlbmRlckltYWdlVG9DYW52YXMoYixhLGgsaSxmLGcpfSxfcm90YXRlMk9yaWVudGFpb246ZnVuY3Rpb24oYSxiKXt2YXIgYz1hLndpZHRoLGQ9YS5oZWlnaHQsZT1hLmdldENvbnRleHQoXCIyZFwiKTtzd2l0Y2goYil7Y2FzZSA1OmNhc2UgNjpjYXNlIDc6Y2FzZSA4OmEud2lkdGg9ZCxhLmhlaWdodD1jfXN3aXRjaChiKXtjYXNlIDI6ZS50cmFuc2xhdGUoYywwKSxlLnNjYWxlKC0xLDEpO2JyZWFrO2Nhc2UgMzplLnRyYW5zbGF0ZShjLGQpLGUucm90YXRlKE1hdGguUEkpO2JyZWFrO2Nhc2UgNDplLnRyYW5zbGF0ZSgwLGQpLGUuc2NhbGUoMSwtMSk7YnJlYWs7Y2FzZSA1OmUucm90YXRlKC41Kk1hdGguUEkpLGUuc2NhbGUoMSwtMSk7YnJlYWs7Y2FzZSA2OmUucm90YXRlKC41Kk1hdGguUEkpLGUudHJhbnNsYXRlKDAsLWQpO2JyZWFrO2Nhc2UgNzplLnJvdGF0ZSguNSpNYXRoLlBJKSxlLnRyYW5zbGF0ZShjLC1kKSxlLnNjYWxlKC0xLDEpO2JyZWFrO2Nhc2UgODplLnJvdGF0ZSgtLjUqTWF0aC5QSSksZS50cmFuc2xhdGUoLWMsMCl9fSxfcmVuZGVySW1hZ2VUb0NhbnZhczpmdW5jdGlvbigpe2Z1bmN0aW9uIGIoYSxiLGMpe3ZhciBkLGUsZixnPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJjYW52YXNcIiksaD1nLmdldENvbnRleHQoXCIyZFwiKSxpPTAsaj1jLGs9Yztmb3IoZy53aWR0aD0xLGcuaGVpZ2h0PWMsaC5kcmF3SW1hZ2UoYSwwLDApLGQ9aC5nZXRJbWFnZURhdGEoMCwwLDEsYykuZGF0YTtrPmk7KWU9ZFs0KihrLTEpKzNdLDA9PT1lP2o9azppPWssaz1qK2k+PjE7cmV0dXJuIGY9ay9jLDA9PT1mPzE6Zn1mdW5jdGlvbiBjKGEpe3ZhciBiLGMsZD1hLm5hdHVyYWxXaWR0aCxlPWEubmF0dXJhbEhlaWdodDtyZXR1cm4gZCplPjEwNDg1NzY/KGI9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImNhbnZhc1wiKSxiLndpZHRoPWIuaGVpZ2h0PTEsYz1iLmdldENvbnRleHQoXCIyZFwiKSxjLmRyYXdJbWFnZShhLC1kKzEsMCksMD09PWMuZ2V0SW1hZ2VEYXRhKDAsMCwxLDEpLmRhdGFbM10pOiExfXJldHVybiBhLm9zLmlvcz9hLm9zLmlvcz49Nz9mdW5jdGlvbihhLGMsZCxlLGYsZyl7dmFyIGg9Yy5uYXR1cmFsV2lkdGgsaT1jLm5hdHVyYWxIZWlnaHQsaj1iKGMsaCxpKTtyZXR1cm4gYS5nZXRDb250ZXh0KFwiMmRcIikuZHJhd0ltYWdlKGMsMCwwLGgqaixpKmosZCxlLGYsZyl9OmZ1bmN0aW9uKGEsZCxlLGYsZyxoKXt2YXIgaSxqLGssbCxtLG4sbyxwPWQubmF0dXJhbFdpZHRoLHE9ZC5uYXR1cmFsSGVpZ2h0LHI9YS5nZXRDb250ZXh0KFwiMmRcIikscz1jKGQpLHQ9XCJpbWFnZS9qcGVnXCI9PT10aGlzLnR5cGUsdT0xMDI0LHY9MCx3PTA7Zm9yKHMmJihwLz0yLHEvPTIpLHIuc2F2ZSgpLGk9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImNhbnZhc1wiKSxpLndpZHRoPWkuaGVpZ2h0PXUsaj1pLmdldENvbnRleHQoXCIyZFwiKSxrPXQ/YihkLHAscSk6MSxsPU1hdGguY2VpbCh1KmcvcCksbT1NYXRoLmNlaWwodSpoL3Evayk7cT52Oyl7Zm9yKG49MCxvPTA7cD5uOylqLmNsZWFyUmVjdCgwLDAsdSx1KSxqLmRyYXdJbWFnZShkLC1uLC12KSxyLmRyYXdJbWFnZShpLDAsMCx1LHUsZStvLGYrdyxsLG0pLG4rPXUsbys9bDt2Kz11LHcrPW19ci5yZXN0b3JlKCksaT1qPW51bGx9OmZ1bmN0aW9uKGEsYixjLGQsZSxmKXthLmdldENvbnRleHQoXCIyZFwiKS5kcmF3SW1hZ2UoYixjLGQsZSxmKX19KCl9KX0pLGIoXCJydW50aW1lL2h0bWw1L3RyYW5zcG9ydFwiLFtcImJhc2VcIixcInJ1bnRpbWUvaHRtbDUvcnVudGltZVwiXSxmdW5jdGlvbihhLGIpe3ZhciBjPWEubm9vcCxkPWEuJDtyZXR1cm4gYi5yZWdpc3RlcihcIlRyYW5zcG9ydFwiLHtpbml0OmZ1bmN0aW9uKCl7dGhpcy5fc3RhdHVzPTAsdGhpcy5fcmVzcG9uc2U9bnVsbH0sc2VuZDpmdW5jdGlvbigpe3ZhciBiLGMsZSxmPXRoaXMub3duZXIsZz10aGlzLm9wdGlvbnMsaD10aGlzLl9pbml0QWpheCgpLGk9Zi5fYmxvYixqPWcuc2VydmVyO2cuc2VuZEFzQmluYXJ5PyhqKz0oL1xcPy8udGVzdChqKT9cIiZcIjpcIj9cIikrZC5wYXJhbShmLl9mb3JtRGF0YSksYz1pLmdldFNvdXJjZSgpKTooYj1uZXcgRm9ybURhdGEsZC5lYWNoKGYuX2Zvcm1EYXRhLGZ1bmN0aW9uKGEsYyl7Yi5hcHBlbmQoYSxjKX0pLGIuYXBwZW5kKGcuZmlsZVZhbCxpLmdldFNvdXJjZSgpLGcuZmlsZW5hbWV8fGYuX2Zvcm1EYXRhLm5hbWV8fFwiXCIpKSxnLndpdGhDcmVkZW50aWFscyYmXCJ3aXRoQ3JlZGVudGlhbHNcImluIGg/KGgub3BlbihnLm1ldGhvZCxqLCEwKSxoLndpdGhDcmVkZW50aWFscz0hMCk6aC5vcGVuKGcubWV0aG9kLGopLHRoaXMuX3NldFJlcXVlc3RIZWFkZXIoaCxnLmhlYWRlcnMpLGM/KGgub3ZlcnJpZGVNaW1lVHlwZShcImFwcGxpY2F0aW9uL29jdGV0LXN0cmVhbVwiKSxhLm9zLmFuZHJvaWQ/KGU9bmV3IEZpbGVSZWFkZXIsZS5vbmxvYWQ9ZnVuY3Rpb24oKXtoLnNlbmQodGhpcy5yZXN1bHQpLGU9ZS5vbmxvYWQ9bnVsbH0sZS5yZWFkQXNBcnJheUJ1ZmZlcihjKSk6aC5zZW5kKGMpKTpoLnNlbmQoYil9LGdldFJlc3BvbnNlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3Jlc3BvbnNlfSxnZXRSZXNwb25zZUFzSnNvbjpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9wYXJzZUpzb24odGhpcy5fcmVzcG9uc2UpfSxnZXRTdGF0dXM6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fc3RhdHVzfSxhYm9ydDpmdW5jdGlvbigpe3ZhciBhPXRoaXMuX3hocjthJiYoYS51cGxvYWQub25wcm9ncmVzcz1jLGEub25yZWFkeXN0YXRlY2hhbmdlPWMsYS5hYm9ydCgpLHRoaXMuX3hocj1hPW51bGwpfSxkZXN0cm95OmZ1bmN0aW9uKCl7dGhpcy5hYm9ydCgpfSxfaW5pdEFqYXg6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLGI9bmV3IFhNTEh0dHBSZXF1ZXN0LGQ9dGhpcy5vcHRpb25zO3JldHVybiFkLndpdGhDcmVkZW50aWFsc3x8XCJ3aXRoQ3JlZGVudGlhbHNcImluIGJ8fFwidW5kZWZpbmVkXCI9PXR5cGVvZiBYRG9tYWluUmVxdWVzdHx8KGI9bmV3IFhEb21haW5SZXF1ZXN0KSxiLnVwbG9hZC5vbnByb2dyZXNzPWZ1bmN0aW9uKGIpe3ZhciBjPTA7cmV0dXJuIGIubGVuZ3RoQ29tcHV0YWJsZSYmKGM9Yi5sb2FkZWQvYi50b3RhbCksYS50cmlnZ2VyKFwicHJvZ3Jlc3NcIixjKX0sYi5vbnJlYWR5c3RhdGVjaGFuZ2U9ZnVuY3Rpb24oKXtyZXR1cm4gND09PWIucmVhZHlTdGF0ZT8oYi51cGxvYWQub25wcm9ncmVzcz1jLGIub25yZWFkeXN0YXRlY2hhbmdlPWMsYS5feGhyPW51bGwsYS5fc3RhdHVzPWIuc3RhdHVzLGIuc3RhdHVzPj0yMDAmJmIuc3RhdHVzPDMwMD8oYS5fcmVzcG9uc2U9Yi5yZXNwb25zZVRleHQsYS50cmlnZ2VyKFwibG9hZFwiKSk6Yi5zdGF0dXM+PTUwMCYmYi5zdGF0dXM8NjAwPyhhLl9yZXNwb25zZT1iLnJlc3BvbnNlVGV4dCxhLnRyaWdnZXIoXCJlcnJvclwiLFwic2VydmVyXCIpKTphLnRyaWdnZXIoXCJlcnJvclwiLGEuX3N0YXR1cz9cImh0dHBcIjpcImFib3J0XCIpKTp2b2lkIDB9LGEuX3hocj1iLGJ9LF9zZXRSZXF1ZXN0SGVhZGVyOmZ1bmN0aW9uKGEsYil7ZC5lYWNoKGIsZnVuY3Rpb24oYixjKXthLnNldFJlcXVlc3RIZWFkZXIoYixjKX0pfSxfcGFyc2VKc29uOmZ1bmN0aW9uKGEpe3ZhciBiO3RyeXtiPUpTT04ucGFyc2UoYSl9Y2F0Y2goYyl7Yj17fX1yZXR1cm4gYn19KX0pLGIoXCJwcmVzZXQvaHRtbDVvbmx5XCIsW1wiYmFzZVwiLFwid2lkZ2V0cy9maWxlZG5kXCIsXCJ3aWRnZXRzL2ZpbGVwYXN0ZVwiLFwid2lkZ2V0cy9maWxlcGlja2VyXCIsXCJ3aWRnZXRzL2ltYWdlXCIsXCJ3aWRnZXRzL3F1ZXVlXCIsXCJ3aWRnZXRzL3J1bnRpbWVcIixcIndpZGdldHMvdXBsb2FkXCIsXCJ3aWRnZXRzL3ZhbGlkYXRvclwiLFwicnVudGltZS9odG1sNS9ibG9iXCIsXCJydW50aW1lL2h0bWw1L2RuZFwiLFwicnVudGltZS9odG1sNS9maWxlcGFzdGVcIixcInJ1bnRpbWUvaHRtbDUvZmlsZXBpY2tlclwiLFwicnVudGltZS9odG1sNS9pbWFnZW1ldGEvZXhpZlwiLFwicnVudGltZS9odG1sNS9pbWFnZVwiLFwicnVudGltZS9odG1sNS90cmFuc3BvcnRcIl0sZnVuY3Rpb24oYSl7cmV0dXJuIGF9KSxiKFwid2VidXBsb2FkZXJcIixbXCJwcmVzZXQvaHRtbDVvbmx5XCJdLGZ1bmN0aW9uKGEpe3JldHVybiBhfSksYyhcIndlYnVwbG9hZGVyXCIpfSk7Il0sImZpbGUiOiJwbHVnaW5zL3VlZGl0b3IvdGhpcmQtcGFydHkvd2VidXBsb2FkZXIvd2VidXBsb2FkZXIuaHRtbDVvbmx5Lm1pbi5qcyJ9
